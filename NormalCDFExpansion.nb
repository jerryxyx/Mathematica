(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     30353,        819]
NotebookOptionsPosition[     29091,        770]
NotebookOutlinePosition[     29436,        785]
CellTagsIndexPosition[     29393,        782]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Singularities and Laurent Series of Error Function", "Section",
 CellChangeTimes->{{3.718403189124028*^9, 3.7184032298142824`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Erf", "[", 
    RowBox[{"z", "+", 
     RowBox[{"1", "/", "z"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "1", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7183048328759623`*^9, 3.7183048996319036`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"Erf", "[", "2", "]"}], "+", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "2"]}], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "3"]}], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "4"]}], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "+", 
   FractionBox[
    RowBox[{"6", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "5"]}], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "6"]}], 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "4"], " ", 
       SqrtBox["\[Pi]"]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"20", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "8"]}], 
    RowBox[{"3", " ", 
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    RowBox[{"34", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "9"]}], 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "4"], " ", 
       SqrtBox["\[Pi]"]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"179", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "10"]}], 
    RowBox[{"15", " ", 
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      RowBox[{"z", "-", "1"}], "]"}], "11"],
    SeriesData[$CellContext`z, 1, {}, 0, 11, 1],
    Editable->False]}],
  SeriesData[$CellContext`z, 1, {
    Erf[2], 0, 2 E^(-4) Pi^Rational[-1, 2], (-2) E^(-4) 
    Pi^Rational[-1, 2], (-2) E^(-4) Pi^Rational[-1, 2], 6 E^(-4) 
    Pi^Rational[-1, 2], Rational[-16, 3] E^(-4) Pi^Rational[-1, 2], 0, 
    Rational[20, 3] E^(-4) Pi^Rational[-1, 2], Rational[-34, 3] E^(-4) 
    Pi^Rational[-1, 2], Rational[179, 15] E^(-4) Pi^Rational[-1, 2]}, 0, 11, 
   1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.718304870150279*^9, 3.718304900149414*^9}, 
   3.71840652683171*^9, 3.7184068225604477`*^9, 3.718410923360364*^9, 
   3.718742577198724*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Erf", "[", 
    FractionBox["1", "z"], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.71830485920623*^9, 3.7183048599840145`*^9}, 
   3.7184028244772577`*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], 
   RowBox[{"Floor", "[", 
    FractionBox[
     RowBox[{"\[Pi]", "+", 
      RowBox[{"2", " ", 
       RowBox[{"Arg", "[", "z", "]"}]}]}], 
     RowBox[{"2", " ", "\[Pi]"}]], "]"}]], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox["1", 
      SuperscriptBox["z", "2"]]}]], " ", 
   RowBox[{"(", 
    InterpretationBox[
     RowBox[{
      RowBox[{"-", 
       FractionBox["z", 
        SqrtBox["\[Pi]"]]}], "+", 
      FractionBox[
       SuperscriptBox["z", "3"], 
       RowBox[{"2", " ", 
        SqrtBox["\[Pi]"]}]], "-", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox["z", "5"]}], 
       RowBox[{"4", " ", 
        SqrtBox["\[Pi]"]}]], "+", 
      FractionBox[
       RowBox[{"15", " ", 
        SuperscriptBox["z", "7"]}], 
       RowBox[{"8", " ", 
        SqrtBox["\[Pi]"]}]], "-", 
      FractionBox[
       RowBox[{"105", " ", 
        SuperscriptBox["z", "9"]}], 
       RowBox[{"16", " ", 
        SqrtBox["\[Pi]"]}]], "+", 
      InterpretationBox[
       SuperscriptBox[
        RowBox[{"O", "[", "z", "]"}], "11"],
       SeriesData[$CellContext`z, 0, {}, 1, 11, 1],
       Editable->False]}],
     SeriesData[$CellContext`z, 
      0, {-Pi^Rational[-1, 2], 0, Rational[1, 2] Pi^Rational[-1, 2], 0, 
       Rational[-3, 4] Pi^Rational[-1, 2], 0, Rational[15, 8] 
       Pi^Rational[-1, 2], 0, Rational[-105, 16] Pi^Rational[-1, 2]}, 1, 11, 
      1],
     Editable->False], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7183048603549023`*^9, 3.718402843782461*^9, 
  3.718406526974309*^9, 3.7184068226783266`*^9, 3.71841092373804*^9, 
  3.718742577364993*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"Erf", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "n"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.718404713029087*^9, 3.718404751597726*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["Erf", 
   TagBox[
    RowBox[{"(", "n", ")"}],
    Derivative],
   MultilineFunction->None], "[", "x", "]"}]], "Output",
 CellChangeTimes->{{3.71840473472009*^9, 3.7184047519883194`*^9}, 
   3.71840652699846*^9, 3.718406822704379*^9, 3.7184109237570887`*^9, 
   3.7187425774276676`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Black Scholes Pricing Formula", "Section",
 CellChangeTimes->{{3.718402922661405*^9, 3.718402935171898*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"normalCDF", "[", "d_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Erf", "[", 
       FractionBox["d", 
        SqrtBox["2"]], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logForward", "[", 
    RowBox[{"S_", ",", "K_", ",", "T_", ",", "r_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Log", "[", 
     FractionBox["S", "K"], "]"}], "+", 
    RowBox[{"r", "*", "T"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{"\[Sigma]_", ",", "T_"}], "]"}], ":=", " ", 
   RowBox[{"\[Sigma]", " ", 
    SqrtBox["T"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d1", "[", 
    RowBox[{"lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["lo", "Z"], "+", 
    FractionBox["Z", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d2", "[", 
    RowBox[{"lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["lo", "Z"], "-", 
    FractionBox["Z", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSCall", "[", 
    RowBox[{"S_", ",", "lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{"S", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"normalCDF", "[", 
       RowBox[{"d1", "[", 
        RowBox[{"lo", ",", "Z"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", "lo"}], "]"}], 
       RowBox[{"normalCDF", "[", 
        RowBox[{"d2", "[", 
         RowBox[{"lo", ",", "Z"}], "]"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSCallHandy", "[", 
    RowBox[{"S_", ",", "K_", ",", "T_", ",", "r_", ",", "\[Sigma]_"}], "]"}], 
   ":=", 
   RowBox[{"BSCall", "[", 
    RowBox[{"S", ",", 
     RowBox[{"logForward", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}], ",", 
     RowBox[{"Z", "[", 
      RowBox[{"\[Sigma]", ",", "T"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSPut", "[", 
    RowBox[{"S_", ",", "lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{"S", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"normalCDF", "[", 
        RowBox[{"-", 
         RowBox[{"d1", "[", 
          RowBox[{"lo", ",", "Z"}], "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", "lo"}], "]"}], 
       RowBox[{"normalCDF", "[", 
        RowBox[{"-", 
         RowBox[{"d2", "[", 
          RowBox[{"lo", ",", "Z"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSPutHandy", "[", 
    RowBox[{"S_", ",", "K_", ",", "T_", ",", "r_", ",", "\[Sigma]_"}], "]"}], 
   ":=", 
   RowBox[{"BSPut", "[", 
    RowBox[{"S", ",", 
     RowBox[{"logForward", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}], ",", 
     RowBox[{"Z", "[", 
      RowBox[{"\[Sigma]", ",", "T"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.718407162500527*^9, 3.718407164132204*^9}, {
  3.718407194374468*^9, 3.7184072009009*^9}, {3.71840766393312*^9, 
  3.7184077076621876`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expansion of Black Scholes Formula", "Section",
 CellChangeTimes->{{3.7184033560035305`*^9, 3.718403374548543*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BSCallTaylorExpansion", "[", 
   RowBox[{
   "S_", ",", "K_", ",", "T_", ",", "r_", ",", "\[Sigma]_", ",", "a_", ",", 
    "nOrder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mu", ",", "std", ",", "IVSeries"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"std", " ", "=", " ", 
      RowBox[{"Z", "[", 
       RowBox[{"\[Sigma]", ",", "T"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mu", " ", "=", " ", 
      RowBox[{"logForward", "[", 
       RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IVSeries", "=", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"BSCall", "[", 
         RowBox[{"S", ",", "mu", ",", "Z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "a", ",", "nOrder"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"callPrice", " ", "=", " ", 
      RowBox[{
       RowBox[{"Normal", "[", "IVSeries", "]"}], "/.", 
       RowBox[{"Z", "\[Rule]", "std"}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.718408609499116*^9, 3.718408811095866*^9}, {
  3.718408848550049*^9, 3.718408894418955*^9}, {3.7184096598268847`*^9, 
  3.718409677380666*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"BSCallTaylorExpansion", "[", 
  RowBox[{
  "100", ",", "100", ",", "1", ",", "0.05", ",", "0.3", ",", "1", ",", "20"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BSCallHandy", "[", 
   RowBox[{"100", ",", "100", ",", "1", ",", "0.05", ",", "0.3"}], "]"}], "//",
   "N"}]}], "Input",
 CellChangeTimes->{{3.7184088283552585`*^9, 3.718408843035983*^9}, {
  3.71840889838206*^9, 3.7184088991699815`*^9}, {3.7184089495687685`*^9, 
  3.718408949869565*^9}, {3.7184096841514835`*^9, 3.718409684343588*^9}}],

Cell[BoxData["14.231170021098274`"], "Output",
 CellChangeTimes->{
  3.7184088434710054`*^9, {3.718408899578873*^9, 3.7184089030574436`*^9}, 
   3.7184089511691775`*^9, 3.7184096849714413`*^9, 3.718410923858363*^9, 
   3.718742577502927*^9}],

Cell[BoxData["14.23125478598582`"], "Output",
 CellChangeTimes->{
  3.7184088434710054`*^9, {3.718408899578873*^9, 3.7184089030574436`*^9}, 
   3.7184089511691775`*^9, 3.7184096849714413`*^9, 3.718410923858363*^9, 
   3.7187425775058928`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseCallIV", "[", 
   RowBox[{
   "CallPrice_", ",", "S_", ",", "K_", ",", "T_", ",", "r_", ",", "a_", ",", 
    "nOrder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mu", ",", "std", ",", "IVSeries", ",", "inversedIVSeries", ",", 
      "impliedVol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mu", " ", "=", " ", 
      RowBox[{"logForward", "[", 
       RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IVSeries", "=", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"BSCall", "[", 
         RowBox[{"S", ",", "mu", ",", "Z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "a", ",", "nOrder"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inversedIVSeries", " ", "=", " ", 
      RowBox[{"InverseSeries", "[", "IVSeries", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"std", " ", "=", " ", 
      RowBox[{
       RowBox[{"Normal", "[", "inversedIVSeries", "]"}], "/.", 
       RowBox[{"Z", "\[Rule]", "CallPrice"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"impliedVol", " ", "=", " ", 
      FractionBox["std", 
       SqrtBox["T"]]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7184091105870247`*^9, 3.718409311343723*^9}, {
  3.718409510545992*^9, 3.7184095777784986`*^9}, {3.718409690872712*^9, 
  3.718409695266431*^9}, {3.7184099744590883`*^9, 3.7184099751357155`*^9}, {
  3.7184103612142906`*^9, 3.7184104326866245`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InverseCallIV", "[", 
  RowBox[{
  "14.2281", ",", "100", ",", "100", ",", "1", ",", "0.05", ",", "1", ",", 
   "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.7184095904827757`*^9, 3.718409633858567*^9}, {
   3.7184097000809965`*^9, 3.7184097003946886`*^9}, {3.7184099786725273`*^9, 
   3.718409987392254*^9}, 3.7184104364099417`*^9}],

Cell[BoxData["0.2999935900284324`"], "Output",
 CellChangeTimes->{
  3.7184096344403324`*^9, 3.7184097007525973`*^9, {3.7184099798634553`*^9, 
   3.7184099881599116`*^9}, 3.718410436972763*^9, 3.718410923902484*^9, 
   3.7187425775389814`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"targetCallPrice", "=", 
        RowBox[{"BSCallHandy", "[", 
         RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], 
         "]"}]}], ",", 
       RowBox[{"estimatedCallPrice", "=", 
        RowBox[{"BSCallTaylorExpansion", "[", 
         RowBox[{
         "S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]", ",", "a", ",", 
          "order"}], "]"}]}], ",", "estimatedIV"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"estimatedIV", "=", 
       RowBox[{"InverseCallIV", "[", 
        RowBox[{
        "targetCallPrice", ",", "S", ",", "K", ",", "T", ",", "r", ",", "a", 
         ",", "order"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"targetCallPrice", ",", "estimatedCallPrice"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]", ",", "estimatedIV"}], "}"}]}], "}"}]}]}], "]"}], 
   ",", "\[IndentingNewLine]", 
   "\"\<underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)\>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "100.", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "150", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<strike, K\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"K", ",", "100", ",", "\"\<\>\""}], "}"}], ",", "0", ",", "150",
      ",", "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<volatility, \[Sigma]\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", "0.3", ",", "\"\<\>\""}], "}"}], ",", "0.01", 
     ",", "1", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<risk-free rate, r\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "0.05", ",", "\"\<\>\""}], "}"}], ",", "0.0", ",", 
     "0.25", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<years to maturity, T\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "0.1", ",", "3", 
     ",", "0.25", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<truncated order, order\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "10", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "64", ",", "8", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<fixed point, a\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "0", ",", "5", 
     ",", "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7184085421068325`*^9, 3.718408542680831*^9}, 
   3.7184085728521786`*^9, {3.7184089996538534`*^9, 3.718409033145206*^9}, {
   3.718409730168476*^9, 3.7184099645308905`*^9}, {3.7184099964972754`*^9, 
   3.7184101705597315`*^9}, {3.7184102006259146`*^9, 
   3.7184102013979692`*^9}, {3.7184102451104774`*^9, 
   3.7184102623953953`*^9}, {3.718410298574753*^9, 3.718410329419793*^9}, 
   3.7184104694645886`*^9, {3.7184105544690866`*^9, 3.718410826199757*^9}, {
   3.7184111076266127`*^9, 3.7184111357230916`*^9}, {3.7187426971628942`*^9, 
   3.7187426974103913`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 1, K$$ = 100, $CellContext`order$$ = 
    10, $CellContext`r$$ = 0.05, $CellContext`S$$ = 100., $CellContext`T$$ = 
    1, $CellContext`\[Sigma]$$ = 0.3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold["underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)"], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`S$$], 100., ""}, 0, 150, 1}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["strike, K"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[K$$], 100, ""}, 0, 150, 0.5}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["volatility, \[Sigma]"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Sigma]$$], 0.3, ""}, 0.01, 1, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["risk-free rate, r"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`r$$], 0.05, ""}, 0., 0.25, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["years to maturity, T"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`T$$], 1, ""}, 0.1, 3, 0.25}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["truncated order, order"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`order$$], 10, ""}, 0, 64, 8}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["fixed point, a"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`a$$], 1, ""}, 0, 5, 0.5}}, Typeset`size$$ = {
    256., {3., 9.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`S$1833$$ = 0, K$1834$$ = 
    0, $CellContext`\[Sigma]$1835$$ = 0, $CellContext`r$1836$$ = 
    0, $CellContext`T$1837$$ = 0, $CellContext`order$1838$$ = 
    0, $CellContext`a$1839$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 1, K$$ = 100, $CellContext`order$$ = 
        10, $CellContext`r$$ = 0.05, $CellContext`S$$ = 
        100., $CellContext`T$$ = 1, $CellContext`\[Sigma]$$ = 0.3}, 
      "ControllerVariables" :> {
        Hold[$CellContext`S$$, $CellContext`S$1833$$, 0], 
        Hold[K$$, K$1834$$, 0], 
        Hold[$CellContext`\[Sigma]$$, $CellContext`\[Sigma]$1835$$, 0], 
        Hold[$CellContext`r$$, $CellContext`r$1836$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$1837$$, 0], 
        Hold[$CellContext`order$$, $CellContext`order$1838$$, 0], 
        Hold[$CellContext`a$$, $CellContext`a$1839$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`targetCallPrice$ = \
$CellContext`BSCallHandy[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$], \
$CellContext`estimatedCallPrice$ = \
$CellContext`BSCallTaylorExpansion[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$, \
$CellContext`a$$, $CellContext`order$$], $CellContext`estimatedIV$}, \
$CellContext`estimatedIV$ = \
$CellContext`InverseCallIV[$CellContext`targetCallPrice$, $CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`a$$, \
$CellContext`order$$]; {{$CellContext`targetCallPrice$, \
$CellContext`estimatedCallPrice$}, {$CellContext`\[Sigma]$$, \
$CellContext`estimatedIV$}}], 
      "Specifications" :> {
       "underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)", {{$CellContext`S$$, 
          100., ""}, 0, 150, 1, Appearance -> "Labeled", ImageSize -> Tiny}, 
        "", 
        "strike, K", {{K$$, 100, ""}, 0, 150, 0.5, Appearance -> "Labeled", 
         ImageSize -> Tiny}, "", 
        "volatility, \[Sigma]", {{$CellContext`\[Sigma]$$, 0.3, ""}, 0.01, 1, 
         0.01, Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "risk-free rate, r", {{$CellContext`r$$, 0.05, ""}, 0., 0.25, 0.01, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "years to maturity, T", {{$CellContext`T$$, 1, ""}, 0.1, 3, 0.25, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "truncated order, order", {{$CellContext`order$$, 10, ""}, 0, 64, 8, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "fixed point, a", {{$CellContext`a$$, 1, ""}, 0, 5, 0.5, Appearance -> 
         "Labeled", ImageSize -> Tiny}}, 
      "Options" :> {ControlPlacement -> Left}, "DefaultOptions" :> {}],
     ImageSizeCache->{446., {170., 176.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`BSCallHandy[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]]] := $CellContext`BSCall[$CellContext`S, 
         $CellContext`logForward[$CellContext`S, 
          K, $CellContext`T, $CellContext`r], 
         $CellContext`Z[$CellContext`\[Sigma], $CellContext`T]], \
$CellContext`BSCall[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`S ($CellContext`normalCDF[
           $CellContext`d1[$CellContext`lo, $CellContext`Z]] - 
         Exp[-$CellContext`lo] $CellContext`normalCDF[
           $CellContext`d2[$CellContext`lo, $CellContext`Z]]), $CellContext`Z[
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]]] := $CellContext`\[Sigma] 
        Sqrt[$CellContext`T], $CellContext`normalCDF[
         Pattern[$CellContext`d, 
          Blank[]]] := (1/2) (1 + 
         Erf[$CellContext`d/Sqrt[2]]), $CellContext`d1[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z + $CellContext`Z/
         2, $CellContext`d2[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z - $CellContext`Z/
        2, $CellContext`logForward[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]]] := 
       Log[$CellContext`S/
          K] + $CellContext`r $CellContext`T, \
$CellContext`BSCallTaylorExpansion[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries}, \
$CellContext`std = $CellContext`Z[$CellContext`\[Sigma], $CellContext`T]; \
$CellContext`mu = $CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSCall[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`callPrice = ReplaceAll[
            
            Normal[$CellContext`IVSeries], $CellContext`Z -> \
$CellContext`std]], $CellContext`callPrice = 
       14.231170021098274`, $CellContext`InverseCallIV[
         Pattern[$CellContext`CallPrice, 
          Blank[]], 
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries, \
$CellContext`inversedIVSeries, $CellContext`impliedVol}, $CellContext`mu = \
$CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSCall[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`inversedIVSeries = 
          InverseSeries[$CellContext`IVSeries]; $CellContext`std = ReplaceAll[
            
            Normal[$CellContext`inversedIVSeries], $CellContext`Z -> \
$CellContext`CallPrice]; $CellContext`impliedVol = $CellContext`std/
           Sqrt[$CellContext`T]]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7184106907040043`*^9, 3.7184107140424805`*^9}, {
   3.718410778269255*^9, 3.718410826749381*^9}, 3.718410923975453*^9, {
   3.7184111220196753`*^9, 3.7184111360916176`*^9}, 3.7187425776533003`*^9, 
   3.718742663551868*^9, 3.7187426984482446`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (October 8, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 137, 1, 70, "Section"],
Cell[CellGroupData[{
Cell[742, 27, 294, 8, 30, "Input"],
Cell[1039, 37, 2782, 88, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3858, 130, 291, 8, 49, "Input"],
Cell[4152, 140, 1727, 54, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5916, 199, 223, 6, 30, "Input"],
Cell[6142, 207, 328, 9, 30, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6519, 222, 118, 1, 70, "Section"],
Cell[6640, 225, 3179, 101, 280, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9856, 331, 121, 1, 70, "Section"],
Cell[9980, 334, 1311, 34, 126, "Input"],
Cell[CellGroupData[{
Cell[11316, 372, 537, 11, 50, "Input"],
Cell[11856, 385, 241, 4, 30, "Output"],
Cell[12100, 391, 242, 4, 30, "Output"]
}, Open  ]],
Cell[12357, 398, 1590, 38, 194, "Input"],
Cell[CellGroupData[{
Cell[13972, 440, 358, 7, 30, "Input"],
Cell[14333, 449, 243, 4, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14613, 458, 4801, 105, 525, "Input"],
Cell[19417, 565, 9646, 201, 396, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

