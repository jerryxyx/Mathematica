(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    320765,       6842]
NotebookOptionsPosition[    312672,       6700]
NotebookOutlinePosition[    313030,       6716]
CellTagsIndexPosition[    312987,       6713]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Taylor Expansion Method for Implied Volatility", "Title",
 CellChangeTimes->{{3.7193564374786053`*^9, 
  3.719356463230933*^9}},ExpressionUUID->"6450bd91-c7ec-40b8-9b68-\
2e11915c5821"],

Cell[CellGroupData[{

Cell["Singularities and Laurent Series of Error Function", "Section",
 CellChangeTimes->{{3.718403189124028*^9, 
  3.7184032298142824`*^9}},ExpressionUUID->"4c08c370-1ff2-458c-8eca-\
c16af5f3a48d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Erf", "[", 
    RowBox[{"z", "+", 
     RowBox[{"1", "/", "z"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "1", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7183048328759623`*^9, 
  3.7183048996319036`*^9}},ExpressionUUID->"94ad5817-e37a-4d4a-a671-\
7e33014cd65a"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"Erf", "[", "2", "]"}], "+", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "2"]}], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "3"]}], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "4"]}], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "+", 
   FractionBox[
    RowBox[{"6", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "5"]}], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "6"]}], 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "4"], " ", 
       SqrtBox["\[Pi]"]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"20", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "8"]}], 
    RowBox[{"3", " ", 
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    RowBox[{"34", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "9"]}], 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "4"], " ", 
       SqrtBox["\[Pi]"]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"179", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "10"]}], 
    RowBox[{"15", " ", 
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      RowBox[{"z", "-", "1"}], "]"}], "11"],
    SeriesData[$CellContext`z, 1, {}, 0, 11, 1],
    Editable->False]}],
  SeriesData[$CellContext`z, 1, {
    Erf[2], 0, 2 E^(-4) Pi^Rational[-1, 2], (-2) E^(-4) 
    Pi^Rational[-1, 2], (-2) E^(-4) Pi^Rational[-1, 2], 6 E^(-4) 
    Pi^Rational[-1, 2], Rational[-16, 3] E^(-4) Pi^Rational[-1, 2], 0, 
    Rational[20, 3] E^(-4) Pi^Rational[-1, 2], Rational[-34, 3] E^(-4) 
    Pi^Rational[-1, 2], Rational[179, 15] E^(-4) Pi^Rational[-1, 2]}, 0, 11, 
   1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.718304870150279*^9, 3.718304900149414*^9}, 
   3.71840652683171*^9, 3.7184068225604477`*^9, 3.718410923360364*^9, 
   3.718742577198724*^9, 3.7187436772731857`*^9, 3.7187461781063414`*^9, 
   3.7192431687684083`*^9, 3.719249025288415*^9, 3.719249477357574*^9, 
   3.719250524234991*^9, 3.719328387326745*^9, 3.719330507167047*^9, 
   3.7195971204439087`*^9, 3.719599136844063*^9, 
   3.7195995342152357`*^9},ExpressionUUID->"f5a9952d-75c9-4841-b049-\
1c06c7b25d7a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Erf", "[", 
    FractionBox["1", "z"], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.71830485920623*^9, 3.7183048599840145`*^9}, 
   3.7184028244772577`*^9},ExpressionUUID->"af045238-6101-43fa-9a26-\
a0db1044e097"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], 
   RowBox[{"Floor", "[", 
    FractionBox[
     RowBox[{"\[Pi]", "+", 
      RowBox[{"2", " ", 
       RowBox[{"Arg", "[", "z", "]"}]}]}], 
     RowBox[{"2", " ", "\[Pi]"}]], "]"}]], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    InterpretationBox[
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        SuperscriptBox["z", "2"]]}], "+", 
      InterpretationBox[
       SuperscriptBox[
        RowBox[{"O", "[", "z", "]"}], "11"],
       SeriesData[$CellContext`z, 0, {}, -2, 11, 1],
       Editable->False]}],
     SeriesData[$CellContext`z, 0, {-1}, -2, 11, 1],
     Editable->False]], " ", 
   RowBox[{"(", 
    InterpretationBox[
     RowBox[{
      RowBox[{"-", 
       FractionBox["z", 
        SqrtBox["\[Pi]"]]}], "+", 
      FractionBox[
       SuperscriptBox["z", "3"], 
       RowBox[{"2", " ", 
        SqrtBox["\[Pi]"]}]], "-", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox["z", "5"]}], 
       RowBox[{"4", " ", 
        SqrtBox["\[Pi]"]}]], "+", 
      FractionBox[
       RowBox[{"15", " ", 
        SuperscriptBox["z", "7"]}], 
       RowBox[{"8", " ", 
        SqrtBox["\[Pi]"]}]], "-", 
      FractionBox[
       RowBox[{"105", " ", 
        SuperscriptBox["z", "9"]}], 
       RowBox[{"16", " ", 
        SqrtBox["\[Pi]"]}]], "+", 
      InterpretationBox[
       SuperscriptBox[
        RowBox[{"O", "[", "z", "]"}], "11"],
       SeriesData[$CellContext`z, 0, {}, 1, 11, 1],
       Editable->False]}],
     SeriesData[$CellContext`z, 
      0, {-Pi^Rational[-1, 2], 0, Rational[1, 2] Pi^Rational[-1, 2], 0, 
       Rational[-3, 4] Pi^Rational[-1, 2], 0, Rational[15, 8] 
       Pi^Rational[-1, 2], 0, Rational[-105, 16] Pi^Rational[-1, 2]}, 1, 11, 
      1],
     Editable->False], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7183048603549023`*^9, 3.718402843782461*^9, 
  3.718406526974309*^9, 3.7184068226783266`*^9, 3.71841092373804*^9, 
  3.718742577364993*^9, 3.7187436773623667`*^9, 3.718746178209114*^9, 
  3.7192431688877525`*^9, 3.719249025360593*^9, 3.7192494776470127`*^9, 
  3.7192505243482924`*^9, 3.7193283875379333`*^9, 3.719330507355405*^9, 
  3.719597120645002*^9, 3.7195991373989677`*^9, 
  3.719599534454286*^9},ExpressionUUID->"ad11247a-89f5-4de5-86d1-\
98a624cc7c20"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"Erf", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "n"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.718404713029087*^9, 
  3.718404751597726*^9}},ExpressionUUID->"5a274af3-1b42-47a9-88b3-\
4dcbefd9e8f9"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["2", "n"], " ", 
  SuperscriptBox["x", 
   RowBox[{"1", "-", "n"}]], " ", 
  RowBox[{"HypergeometricPFQRegularized", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", "2"], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "-", 
       FractionBox["n", "2"]}], ",", 
      FractionBox[
       RowBox[{"3", "-", "n"}], "2"]}], "}"}], ",", 
    RowBox[{"-", 
     SuperscriptBox["x", "2"]}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.71840473472009*^9, 3.7184047519883194`*^9}, 
   3.71840652699846*^9, 3.718406822704379*^9, 3.7184109237570887`*^9, 
   3.7187425774276676`*^9, 3.7187436773799276`*^9, 3.7187461782256584`*^9, 
   3.719243168981002*^9, 3.7192490253806458`*^9, 3.7192494776700993`*^9, 
   3.719250524378373*^9, 3.719328387607691*^9, 3.719330507384408*^9, 
   3.719597120713311*^9, 3.719599137455299*^9, 
   3.7195995346052322`*^9},ExpressionUUID->"a203dc0b-0f86-4fd7-bf45-\
184617966625"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Black Scholes Pricing Formula", "Section",
 CellChangeTimes->{{3.718402922661405*^9, 
  3.718402935171898*^9}},ExpressionUUID->"6afdbf59-4267-4fe6-bb75-\
cf95e07339ee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"normalCDF", "[", "d_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Erf", "[", 
       FractionBox["d", 
        SqrtBox["2"]], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logForward", "[", 
    RowBox[{"S_", ",", "K_", ",", "T_", ",", "r_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Log", "[", 
     FractionBox["S", "K"], "]"}], "+", 
    RowBox[{"r", "*", "T"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{"\[Sigma]_", ",", "T_"}], "]"}], ":=", " ", 
   RowBox[{"\[Sigma]", " ", 
    SqrtBox["T"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d1", "[", 
    RowBox[{"lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["lo", "Z"], "+", 
    FractionBox["Z", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d2", "[", 
    RowBox[{"lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["lo", "Z"], "-", 
    FractionBox["Z", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSCall", "[", 
    RowBox[{"S_", ",", "lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{"S", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"normalCDF", "[", 
       RowBox[{"d1", "[", 
        RowBox[{"lo", ",", "Z"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", "lo"}], "]"}], 
       RowBox[{"normalCDF", "[", 
        RowBox[{"d2", "[", 
         RowBox[{"lo", ",", "Z"}], "]"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSCallHandy", "[", 
    RowBox[{"S_", ",", "K_", ",", "T_", ",", "r_", ",", "\[Sigma]_"}], "]"}], 
   ":=", 
   RowBox[{"BSCall", "[", 
    RowBox[{"S", ",", 
     RowBox[{"logForward", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}], ",", 
     RowBox[{"Z", "[", 
      RowBox[{"\[Sigma]", ",", "T"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSPut", "[", 
    RowBox[{"S_", ",", "lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{"S", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"normalCDF", "[", 
        RowBox[{"-", 
         RowBox[{"d1", "[", 
          RowBox[{"lo", ",", "Z"}], "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", "lo"}], "]"}], 
       RowBox[{"normalCDF", "[", 
        RowBox[{"-", 
         RowBox[{"d2", "[", 
          RowBox[{"lo", ",", "Z"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSPutHandy", "[", 
    RowBox[{"S_", ",", "K_", ",", "T_", ",", "r_", ",", "\[Sigma]_"}], "]"}], 
   ":=", 
   RowBox[{"BSPut", "[", 
    RowBox[{"S", ",", 
     RowBox[{"logForward", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}], ",", 
     RowBox[{"Z", "[", 
      RowBox[{"\[Sigma]", ",", "T"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.718407162500527*^9, 3.718407164132204*^9}, {
  3.718407194374468*^9, 3.7184072009009*^9}, {3.71840766393312*^9, 
  3.7184077076621876`*^9}},ExpressionUUID->"205c526e-c48d-4f52-adcc-\
0afc2ae91cb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expansion of Black Scholes Formula", "Section",
 CellChangeTimes->{{3.7184033560035305`*^9, 
  3.718403374548543*^9}},ExpressionUUID->"e78a82ea-0764-40d3-8aed-\
1d38b54a42c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BSCallTaylorExpansion", "[", 
    RowBox[{
    "S_", ",", "K_", ",", "T_", ",", "r_", ",", "\[Sigma]_", ",", "a_", ",", 
     "nOrder_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mu", ",", "std", ",", "IVSeries", ",", "callPrice"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"std", " ", "=", " ", 
       RowBox[{"Z", "[", 
        RowBox[{"\[Sigma]", ",", "T"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mu", " ", "=", " ", 
       RowBox[{"logForward", "[", 
        RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IVSeries", "=", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"BSCall", "[", 
          RowBox[{"S", ",", "mu", ",", "Z"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Z", ",", "a", ",", "nOrder"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"callPrice", " ", "=", " ", 
       RowBox[{
        RowBox[{"Normal", "[", "IVSeries", "]"}], "/.", 
        RowBox[{"Z", "\[Rule]", "std"}]}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BSPutTaylorExpansion", "[", 
   RowBox[{
   "S_", ",", "K_", ",", "T_", ",", "r_", ",", "\[Sigma]_", ",", "a_", ",", 
    "nOrder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mu", ",", "std", ",", "IVSeries", ",", "putPrice"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"std", " ", "=", " ", 
      RowBox[{"Z", "[", 
       RowBox[{"\[Sigma]", ",", "T"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mu", " ", "=", " ", 
      RowBox[{"logForward", "[", 
       RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IVSeries", "=", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"BSPut", "[", 
         RowBox[{"S", ",", "mu", ",", "Z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "a", ",", "nOrder"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"putPrice", " ", "=", " ", 
      RowBox[{
       RowBox[{"Normal", "[", "IVSeries", "]"}], "/.", 
       RowBox[{"Z", "\[Rule]", "std"}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.718408609499116*^9, 3.718408811095866*^9}, {
  3.718408848550049*^9, 3.718408894418955*^9}, {3.7184096598268847`*^9, 
  3.718409677380666*^9}, {3.7193448046326647`*^9, 
  3.719344854379531*^9}},ExpressionUUID->"a7c923bf-00cb-4612-89a9-\
08fed32dd902"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"BSCallTaylorExpansion", "[", 
  RowBox[{
  "100", ",", "100", ",", "1", ",", "0.05", ",", "0.3", ",", "1", ",", "20"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BSCallHandy", "[", 
   RowBox[{"100", ",", "100", ",", "1", ",", "0.05", ",", "0.3"}], "]"}], "//",
   "N"}], "\[IndentingNewLine]", 
 RowBox[{"BSPutTaylorExpansion", "[", 
  RowBox[{
  "100", ",", "100", ",", "1", ",", "0.05", ",", "0.3", ",", "1", ",", "20"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BSPutHandy", "[", 
   RowBox[{"100", ",", "100", ",", "1", ",", "0.05", ",", "0.3"}], "]"}], "//",
   "N"}]}], "Input",
 CellChangeTimes->{{3.7184088283552585`*^9, 3.718408843035983*^9}, {
  3.71840889838206*^9, 3.7184088991699815`*^9}, {3.7184089495687685`*^9, 
  3.718408949869565*^9}, {3.7184096841514835`*^9, 3.718409684343588*^9}, {
  3.7193448734485292`*^9, 
  3.719344890900256*^9}},ExpressionUUID->"244e5e9f-2a67-4c52-ad25-\
0b772f8812d3"],

Cell[BoxData["14.231170021098274`"], "Output",
 CellChangeTimes->{
  3.7184088434710054`*^9, {3.718408899578873*^9, 3.7184089030574436`*^9}, 
   3.7184089511691775`*^9, 3.7184096849714413`*^9, 3.718410923858363*^9, 
   3.718742577502927*^9, 3.7187436774270377`*^9, 3.7187461782854524`*^9, 
   3.7192431690436687`*^9, 3.7192490254377975`*^9, 3.719249477727253*^9, 
   3.7192505244460583`*^9, 3.7193283877913847`*^9, 3.719330507474475*^9, 
   3.719344893253274*^9, 3.7195971208533573`*^9, 3.719599137565716*^9, 
   3.719599534768552*^9},ExpressionUUID->"cc1f5878-b03f-4962-a0c3-\
1a0c710f29a5"],

Cell[BoxData["14.23125478598582`"], "Output",
 CellChangeTimes->{
  3.7184088434710054`*^9, {3.718408899578873*^9, 3.7184089030574436`*^9}, 
   3.7184089511691775`*^9, 3.7184096849714413`*^9, 3.718410923858363*^9, 
   3.718742577502927*^9, 3.7187436774270377`*^9, 3.7187461782854524`*^9, 
   3.7192431690436687`*^9, 3.7192490254377975`*^9, 3.719249477727253*^9, 
   3.7192505244460583`*^9, 3.7193283877913847`*^9, 3.719330507474475*^9, 
   3.719344893253274*^9, 3.7195971208533573`*^9, 3.719599137565716*^9, 
   3.7195995347784843`*^9},ExpressionUUID->"8c3982e7-dbf8-455f-a887-\
989ed566eccc"],

Cell[BoxData["9.354112471169666`"], "Output",
 CellChangeTimes->{
  3.7184088434710054`*^9, {3.718408899578873*^9, 3.7184089030574436`*^9}, 
   3.7184089511691775`*^9, 3.7184096849714413`*^9, 3.718410923858363*^9, 
   3.718742577502927*^9, 3.7187436774270377`*^9, 3.7187461782854524`*^9, 
   3.7192431690436687`*^9, 3.7192490254377975`*^9, 3.719249477727253*^9, 
   3.7192505244460583`*^9, 3.7193283877913847`*^9, 3.719330507474475*^9, 
   3.719344893253274*^9, 3.7195971208533573`*^9, 3.719599137565716*^9, 
   3.719599534785658*^9},ExpressionUUID->"f6f0635b-d78d-4405-b30e-\
d7b686632b8a"],

Cell[BoxData["9.354197236057226`"], "Output",
 CellChangeTimes->{
  3.7184088434710054`*^9, {3.718408899578873*^9, 3.7184089030574436`*^9}, 
   3.7184089511691775`*^9, 3.7184096849714413`*^9, 3.718410923858363*^9, 
   3.718742577502927*^9, 3.7187436774270377`*^9, 3.7187461782854524`*^9, 
   3.7192431690436687`*^9, 3.7192490254377975`*^9, 3.719249477727253*^9, 
   3.7192505244460583`*^9, 3.7193283877913847`*^9, 3.719330507474475*^9, 
   3.719344893253274*^9, 3.7195971208533573`*^9, 3.719599137565716*^9, 
   3.719599534791066*^9},ExpressionUUID->"3f0fb25c-7ece-47cb-980a-\
87eb62470e40"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"InverseCallIV", "[", 
    RowBox[{
    "CallPrice_", ",", "S_", ",", "K_", ",", "T_", ",", "r_", ",", "a_", ",", 
     "nOrder_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mu", ",", "std", ",", "IVSeries", ",", "inversedIVSeries", ",", 
       "impliedVol"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mu", " ", "=", " ", 
       RowBox[{"logForward", "[", 
        RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IVSeries", "=", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"BSCall", "[", 
          RowBox[{"S", ",", "mu", ",", "Z"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Z", ",", "a", ",", "nOrder"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inversedIVSeries", " ", "=", " ", 
       RowBox[{"InverseSeries", "[", "IVSeries", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"std", " ", "=", " ", 
       RowBox[{
        RowBox[{"Normal", "[", "inversedIVSeries", "]"}], "/.", 
        RowBox[{"Z", "\[Rule]", "CallPrice"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"impliedVol", " ", "=", " ", 
       FractionBox["std", 
        SqrtBox["T"]]}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"InversePutIV", "[", 
    RowBox[{
    "CallPrice_", ",", "S_", ",", "K_", ",", "T_", ",", "r_", ",", "a_", ",", 
     "nOrder_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mu", ",", "std", ",", "IVSeries", ",", "inversedIVSeries", ",", 
       "impliedVol"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mu", " ", "=", " ", 
       RowBox[{"logForward", "[", 
        RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"IVSeries", "=", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"BSPut", "[", 
          RowBox[{"S", ",", "mu", ",", "Z"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Z", ",", "a", ",", "nOrder"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"inversedIVSeries", " ", "=", " ", 
       RowBox[{"InverseSeries", "[", "IVSeries", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"std", " ", "=", " ", 
       RowBox[{
        RowBox[{"Normal", "[", "inversedIVSeries", "]"}], "/.", 
        RowBox[{"Z", "\[Rule]", "CallPrice"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"impliedVol", " ", "=", " ", 
       FractionBox["std", 
        SqrtBox["T"]]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7184091105870247`*^9, 3.718409311343723*^9}, {
  3.718409510545992*^9, 3.7184095777784986`*^9}, {3.718409690872712*^9, 
  3.718409695266431*^9}, {3.7184099744590883`*^9, 3.7184099751357155`*^9}, {
  3.7184103612142906`*^9, 3.7184104326866245`*^9}, {3.7193449360085917`*^9, 
  3.71934496065561*^9}},ExpressionUUID->"a979571c-e568-4997-95ea-\
1d358a566165"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"InverseCallIV", "[", 
  RowBox[{
  "14.2281", ",", "100", ",", "100", ",", "1", ",", "0.05", ",", "1", ",", 
   "10"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"InversePutIV", "[", 
  RowBox[{
  "9.3542", ",", "100", ",", "100", ",", "1", ",", "0.05", ",", "1", ",", 
   "10"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7184095904827757`*^9, 3.718409633858567*^9}, {
   3.7184097000809965`*^9, 3.7184097003946886`*^9}, {3.7184099786725273`*^9, 
   3.718409987392254*^9}, 3.7184104364099417`*^9, {3.719344970374319*^9, 
   3.7193449968443823`*^9}},ExpressionUUID->"d1a321ff-51db-41f0-a378-\
afd12eea3649"],

Cell[BoxData["0.2999935900284324`"], "Output",
 CellChangeTimes->{
  3.7184096344403324`*^9, 3.7184097007525973`*^9, {3.7184099798634553`*^9, 
   3.7184099881599116`*^9}, 3.718410436972763*^9, 3.718410923902484*^9, 
   3.7187425775389814`*^9, 3.718743677473161*^9, 3.7187461783269734`*^9, 
   3.71924316908434*^9, 3.7192490254779043`*^9, 3.719249477785882*^9, 
   3.719250524489674*^9, 3.719328387870878*^9, 3.719330507543022*^9, 
   3.719344997191313*^9, 3.719597120941008*^9, 3.719599137717917*^9, 
   3.719599534843025*^9},ExpressionUUID->"ae060288-54c1-4fd6-bbe3-\
d6d3cb74b35f"],

Cell[BoxData["0.3000766831945564`"], "Output",
 CellChangeTimes->{
  3.7184096344403324`*^9, 3.7184097007525973`*^9, {3.7184099798634553`*^9, 
   3.7184099881599116`*^9}, 3.718410436972763*^9, 3.718410923902484*^9, 
   3.7187425775389814`*^9, 3.718743677473161*^9, 3.7187461783269734`*^9, 
   3.71924316908434*^9, 3.7192490254779043`*^9, 3.719249477785882*^9, 
   3.719250524489674*^9, 3.719328387870878*^9, 3.719330507543022*^9, 
   3.719344997191313*^9, 3.719597120941008*^9, 3.719599137717917*^9, 
   3.719599534872405*^9},ExpressionUUID->"6afb70ca-bb1b-41cf-b050-\
e63fe55a1eae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "targetCallPrice", ",", "estimatedCallPrice", ",", "estimatedIV", ",", 
       "newtonRoot"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"targetCallPrice", "=", 
       RowBox[{"BSCallHandy", "[", 
        RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"estimatedCallPrice", "=", 
       RowBox[{"BSCallTaylorExpansion", "[", 
        RowBox[{
        "S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]", ",", "a", ",", 
         "order"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"estimatedIV", "=", 
       RowBox[{"InverseCallIV", "[", 
        RowBox[{
        "targetCallPrice", ",", "S", ",", "K", ",", "T", ",", "r", ",", "a", 
         ",", "order"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newtonRoot", " ", "=", " ", 
       RowBox[{"Timing", "[", 
        RowBox[{"FindRoot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"BSCallHandy", "[", 
            RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "x"}], "]"}], 
           "\[Equal]", "targetCallPrice"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"targetCallPrice", ",", "estimatedCallPrice"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]", ",", "estimatedIV", ",", "newtonRoot"}], "}"}]}],
        "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
   "\"\<underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)\>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "100.", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "150", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<strike, K\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"K", ",", "100", ",", "\"\<\>\""}], "}"}], ",", "0", ",", "150",
      ",", "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<volatility, \[Sigma]\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", "0.3", ",", "\"\<\>\""}], "}"}], ",", "0.01", 
     ",", "1", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<risk-free rate, r\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "0.05", ",", "\"\<\>\""}], "}"}], ",", "0.0", ",", 
     "0.25", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<years to maturity, T\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "0.1", ",", "3", 
     ",", "0.25", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<truncated order, order\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "10", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "64", ",", "8", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<fixed point, a\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "0", ",", "5", 
     ",", "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"targetPutPrice", "=", 
        RowBox[{"BSPutHandy", "[", 
         RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], 
         "]"}]}], ",", 
       RowBox[{"estimatedPutPrice", "=", 
        RowBox[{"BSPutTaylorExpansion", "[", 
         RowBox[{
         "S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]", ",", "a", ",", 
          "order"}], "]"}]}], ",", "estimatedIV"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"estimatedIV", "=", 
       RowBox[{"InversePutIV", "[", 
        RowBox[{
        "targetPutPrice", ",", "S", ",", "K", ",", "T", ",", "r", ",", "a", 
         ",", "order"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"targetPutPrice", ",", "estimatedPutPrice"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]", ",", "estimatedIV"}], "}"}]}], "}"}]}]}], "]"}], 
   ",", "\[IndentingNewLine]", 
   "\"\<underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)\>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "100.", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "150", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<strike, K\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"K", ",", "100", ",", "\"\<\>\""}], "}"}], ",", "0", ",", "150",
      ",", "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<volatility, \[Sigma]\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", "0.3", ",", "\"\<\>\""}], "}"}], ",", "0.01", 
     ",", "1", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<risk-free rate, r\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "0.05", ",", "\"\<\>\""}], "}"}], ",", "0.0", ",", 
     "0.25", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<years to maturity, T\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "0.1", ",", "3", 
     ",", "0.25", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<truncated order, order\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "10", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "64", ",", "8", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<fixed point, a\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "0", ",", "5", 
     ",", "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7184085421068325`*^9, 3.718408542680831*^9}, 
   3.7184085728521786`*^9, {3.7184089996538534`*^9, 3.718409033145206*^9}, {
   3.718409730168476*^9, 3.7184099645308905`*^9}, {3.7184099964972754`*^9, 
   3.7184101705597315`*^9}, {3.7184102006259146`*^9, 
   3.7184102013979692`*^9}, {3.7184102451104774`*^9, 
   3.7184102623953953`*^9}, {3.718410298574753*^9, 3.718410329419793*^9}, 
   3.7184104694645886`*^9, {3.7184105544690866`*^9, 3.718410826199757*^9}, {
   3.7184111076266127`*^9, 3.7184111357230916`*^9}, {3.7187426971628942`*^9, 
   3.7187426974103913`*^9}, {3.7187461412421227`*^9, 3.7187461604640503`*^9}, 
   3.7192431658337293`*^9, {3.719345027307643*^9, 3.71934508881742*^9}, {
   3.719345125662434*^9, 3.7193451271673403`*^9}, {3.7196019865927553`*^9, 
   3.719602135942979*^9}, {3.719602222405903*^9, 
   3.719602245530677*^9}},ExpressionUUID->"041da8f9-5be5-42a5-a4f5-\
27d45525e36f"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 1, K$$ = 47., $CellContext`order$$ = 
    10, $CellContext`r$$ = 0.05, $CellContext`S$$ = 132, $CellContext`T$$ = 
    1, $CellContext`\[Sigma]$$ = 0.75, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold["underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)"], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`S$$], 100., ""}, 0, 150, 1}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["strike, K"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[K$$], 100, ""}, 0, 150, 0.5}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["volatility, \[Sigma]"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Sigma]$$], 0.3, ""}, 0.01, 1, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["risk-free rate, r"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`r$$], 0.05, ""}, 0., 0.25, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["years to maturity, T"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`T$$], 1, ""}, 0.1, 3, 0.25}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["truncated order, order"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`order$$], 10, ""}, 0, 64, 8}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["fixed point, a"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`a$$], 1, ""}, 0, 5, 0.5}}, Typeset`size$$ = {
    466., {3., 9.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`S$18865$$ = 0, K$18866$$ = 
    0, $CellContext`\[Sigma]$18867$$ = 0, $CellContext`r$18868$$ = 
    0, $CellContext`T$18869$$ = 0, $CellContext`order$18870$$ = 
    0, $CellContext`a$18871$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 1, K$$ = 100, $CellContext`order$$ = 
        10, $CellContext`r$$ = 0.05, $CellContext`S$$ = 
        100., $CellContext`T$$ = 1, $CellContext`\[Sigma]$$ = 0.3}, 
      "ControllerVariables" :> {
        Hold[$CellContext`S$$, $CellContext`S$18865$$, 0], 
        Hold[K$$, K$18866$$, 0], 
        Hold[$CellContext`\[Sigma]$$, $CellContext`\[Sigma]$18867$$, 0], 
        Hold[$CellContext`r$$, $CellContext`r$18868$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$18869$$, 0], 
        Hold[$CellContext`order$$, $CellContext`order$18870$$, 0], 
        Hold[$CellContext`a$$, $CellContext`a$18871$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`targetCallPrice$, \
$CellContext`estimatedCallPrice$, $CellContext`estimatedIV$, \
$CellContext`newtonRoot$}, $CellContext`targetCallPrice$ = \
$CellContext`BSCallHandy[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$]; \
$CellContext`estimatedCallPrice$ = \
$CellContext`BSCallTaylorExpansion[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$, \
$CellContext`a$$, $CellContext`order$$]; $CellContext`estimatedIV$ = \
$CellContext`InverseCallIV[$CellContext`targetCallPrice$, $CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`a$$, \
$CellContext`order$$]; $CellContext`newtonRoot$ = Timing[
           
           FindRoot[$CellContext`BSCallHandy[$CellContext`S$$, 
              K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`x] == \
$CellContext`targetCallPrice$, {$CellContext`x, 
             
             1}]]; {{$CellContext`targetCallPrice$, \
$CellContext`estimatedCallPrice$}, {$CellContext`\[Sigma]$$, \
$CellContext`estimatedIV$, $CellContext`newtonRoot$}}], 
      "Specifications" :> {
       "underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)", {{$CellContext`S$$, 
          100., ""}, 0, 150, 1, Appearance -> "Labeled", ImageSize -> Tiny}, 
        "", "strike, K", {{K$$, 100, ""}, 0, 150, 0.5, Appearance -> 
         "Labeled", ImageSize -> Tiny}, "", 
        "volatility, \[Sigma]", {{$CellContext`\[Sigma]$$, 0.3, ""}, 0.01, 1, 
         0.01, Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "risk-free rate, r", {{$CellContext`r$$, 0.05, ""}, 0., 0.25, 0.01, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "years to maturity, T", {{$CellContext`T$$, 1, ""}, 0.1, 3, 0.25, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "truncated order, order", {{$CellContext`order$$, 10, ""}, 0, 64, 8, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "fixed point, a", {{$CellContext`a$$, 1, ""}, 0, 5, 0.5, Appearance -> 
         "Labeled", ImageSize -> Tiny}}, 
      "Options" :> {ControlPlacement -> Left}, "DefaultOptions" :> {}],
     ImageSizeCache->{638., {168., 173.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`BSCallHandy[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]]] := $CellContext`BSCall[$CellContext`S, 
         $CellContext`logForward[$CellContext`S, 
          K, $CellContext`T, $CellContext`r], 
         $CellContext`Z[$CellContext`\[Sigma], $CellContext`T]], \
$CellContext`BSCall[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`S ($CellContext`normalCDF[
           $CellContext`d1[$CellContext`lo, $CellContext`Z]] - 
         Exp[-$CellContext`lo] $CellContext`normalCDF[
           $CellContext`d2[$CellContext`lo, $CellContext`Z]]), $CellContext`Z[
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]]] := $CellContext`\[Sigma] 
        Sqrt[$CellContext`T], $CellContext`normalCDF[
         Pattern[$CellContext`d, 
          Blank[]]] := (1/2) (1 + 
         Erf[$CellContext`d/Sqrt[2]]), $CellContext`d1[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z + $CellContext`Z/
         2, $CellContext`d2[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z - $CellContext`Z/
        2, $CellContext`logForward[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]]] := 
       Log[$CellContext`S/
          K] + $CellContext`r $CellContext`T, \
$CellContext`BSCallTaylorExpansion[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries, \
$CellContext`callPrice}, $CellContext`std = $CellContext`Z[$CellContext`\
\[Sigma], $CellContext`T]; $CellContext`mu = \
$CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSCall[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`callPrice = ReplaceAll[
            
            Normal[$CellContext`IVSeries], $CellContext`Z -> \
$CellContext`std]], $CellContext`callPrice = 
       14.228124311728868`, $CellContext`InverseCallIV[
         Pattern[$CellContext`CallPrice, 
          Blank[]], 
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries, \
$CellContext`inversedIVSeries, $CellContext`impliedVol}, $CellContext`mu = \
$CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSCall[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`inversedIVSeries = 
          InverseSeries[$CellContext`IVSeries]; $CellContext`std = ReplaceAll[
            
            Normal[$CellContext`inversedIVSeries], $CellContext`Z -> \
$CellContext`CallPrice]; $CellContext`impliedVol = $CellContext`std/
           Sqrt[$CellContext`T]]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7184106907040043`*^9, 3.7184107140424805`*^9}, {
   3.718410778269255*^9, 3.718410826749381*^9}, 3.718410923975453*^9, {
   3.7184111220196753`*^9, 3.7184111360916176`*^9}, 3.7187425776533003`*^9, 
   3.718742663551868*^9, 3.7187426984482446`*^9, 3.718743677553712*^9, {
   3.718746161353861*^9, 3.718746178371091*^9}, 3.719243169120534*^9, 
   3.719249025541072*^9, 3.7192494778774576`*^9, 3.7192505245618677`*^9, 
   3.719328388466036*^9, 3.719330507597821*^9, {3.719345115991839*^9, 
   3.719345127706077*^9}, 3.719597121048049*^9, 3.71959895273201*^9, 
   3.719599137837061*^9, 3.719599535576974*^9, 3.719602010475566*^9, 
   3.719602136544497*^9, 
   3.719602246533868*^9},ExpressionUUID->"91b18adc-090b-47de-8d70-\
8eeaf37c017e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 1, K$$ = 100, $CellContext`order$$ = 
    10, $CellContext`r$$ = 0.05, $CellContext`S$$ = 100., $CellContext`T$$ = 
    1, $CellContext`\[Sigma]$$ = 0.3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold["underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)"], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`S$$], 100., ""}, 0, 150, 1}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["strike, K"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[K$$], 100, ""}, 0, 150, 0.5}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["volatility, \[Sigma]"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Sigma]$$], 0.3, ""}, 0.01, 1, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["risk-free rate, r"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`r$$], 0.05, ""}, 0., 0.25, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["years to maturity, T"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`T$$], 1, ""}, 0.1, 3, 0.25}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["truncated order, order"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`order$$], 10, ""}, 0, 64, 8}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["fixed point, a"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`a$$], 1, ""}, 0, 5, 0.5}}, Typeset`size$$ = {
    274., {3., 9.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`S$18903$$ = 0, K$18904$$ = 
    0, $CellContext`\[Sigma]$18905$$ = 0, $CellContext`r$18906$$ = 
    0, $CellContext`T$18907$$ = 0, $CellContext`order$18908$$ = 
    0, $CellContext`a$18909$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 1, K$$ = 100, $CellContext`order$$ = 
        10, $CellContext`r$$ = 0.05, $CellContext`S$$ = 
        100., $CellContext`T$$ = 1, $CellContext`\[Sigma]$$ = 0.3}, 
      "ControllerVariables" :> {
        Hold[$CellContext`S$$, $CellContext`S$18903$$, 0], 
        Hold[K$$, K$18904$$, 0], 
        Hold[$CellContext`\[Sigma]$$, $CellContext`\[Sigma]$18905$$, 0], 
        Hold[$CellContext`r$$, $CellContext`r$18906$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$18907$$, 0], 
        Hold[$CellContext`order$$, $CellContext`order$18908$$, 0], 
        Hold[$CellContext`a$$, $CellContext`a$18909$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`targetPutPrice$ = \
$CellContext`BSPutHandy[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$], \
$CellContext`estimatedPutPrice$ = \
$CellContext`BSPutTaylorExpansion[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$, \
$CellContext`a$$, $CellContext`order$$], $CellContext`estimatedIV$}, \
$CellContext`estimatedIV$ = \
$CellContext`InversePutIV[$CellContext`targetPutPrice$, $CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`a$$, \
$CellContext`order$$]; {{$CellContext`targetPutPrice$, \
$CellContext`estimatedPutPrice$}, {$CellContext`\[Sigma]$$, \
$CellContext`estimatedIV$}}], 
      "Specifications" :> {
       "underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)", {{$CellContext`S$$, 
          100., ""}, 0, 150, 1, Appearance -> "Labeled", ImageSize -> Tiny}, 
        "", 
        "strike, K", {{K$$, 100, ""}, 0, 150, 0.5, Appearance -> "Labeled", 
         ImageSize -> Tiny}, "", 
        "volatility, \[Sigma]", {{$CellContext`\[Sigma]$$, 0.3, ""}, 0.01, 1, 
         0.01, Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "risk-free rate, r", {{$CellContext`r$$, 0.05, ""}, 0., 0.25, 0.01, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "years to maturity, T", {{$CellContext`T$$, 1, ""}, 0.1, 3, 0.25, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "truncated order, order", {{$CellContext`order$$, 10, ""}, 0, 64, 8, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "fixed point, a", {{$CellContext`a$$, 1, ""}, 0, 5, 0.5, Appearance -> 
         "Labeled", ImageSize -> Tiny}}, 
      "Options" :> {ControlPlacement -> Left}, "DefaultOptions" :> {}],
     ImageSizeCache->{446., {168., 173.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`BSPutHandy[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]]] := $CellContext`BSPut[$CellContext`S, 
         $CellContext`logForward[$CellContext`S, 
          K, $CellContext`T, $CellContext`r], 
         $CellContext`Z[$CellContext`\[Sigma], $CellContext`T]], \
$CellContext`BSPut[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          
          Blank[]]] := $CellContext`S \
(-$CellContext`normalCDF[-$CellContext`d1[$CellContext`lo, $CellContext`Z]] + 
         Exp[-$CellContext`lo] \
$CellContext`normalCDF[-$CellContext`d2[$CellContext`lo, $CellContext`Z]]), \
$CellContext`Z[
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]]] := $CellContext`\[Sigma] 
        Sqrt[$CellContext`T], $CellContext`normalCDF[
         Pattern[$CellContext`d, 
          Blank[]]] := (1/2) (1 + 
         Erf[$CellContext`d/Sqrt[2]]), $CellContext`d1[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z + $CellContext`Z/
         2, $CellContext`d2[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z - $CellContext`Z/
        2, $CellContext`logForward[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]]] := 
       Log[$CellContext`S/
          K] + $CellContext`r $CellContext`T, \
$CellContext`BSPutTaylorExpansion[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries, \
$CellContext`putPrice}, $CellContext`std = $CellContext`Z[$CellContext`\
\[Sigma], $CellContext`T]; $CellContext`mu = \
$CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSPut[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`putPrice = ReplaceAll[
            
            Normal[$CellContext`IVSeries], $CellContext`Z -> \
$CellContext`std]], $CellContext`InversePutIV[
         Pattern[$CellContext`CallPrice, 
          Blank[]], 
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries, \
$CellContext`inversedIVSeries, $CellContext`impliedVol}, $CellContext`mu = \
$CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSPut[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`inversedIVSeries = 
          InverseSeries[$CellContext`IVSeries]; $CellContext`std = ReplaceAll[
            
            Normal[$CellContext`inversedIVSeries], $CellContext`Z -> \
$CellContext`CallPrice]; $CellContext`impliedVol = $CellContext`std/
           Sqrt[$CellContext`T]]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7184106907040043`*^9, 3.7184107140424805`*^9}, {
   3.718410778269255*^9, 3.718410826749381*^9}, 3.718410923975453*^9, {
   3.7184111220196753`*^9, 3.7184111360916176`*^9}, 3.7187425776533003`*^9, 
   3.718742663551868*^9, 3.7187426984482446`*^9, 3.718743677553712*^9, {
   3.718746161353861*^9, 3.718746178371091*^9}, 3.719243169120534*^9, 
   3.719249025541072*^9, 3.7192494778774576`*^9, 3.7192505245618677`*^9, 
   3.719328388466036*^9, 3.719330507597821*^9, {3.719345115991839*^9, 
   3.719345127706077*^9}, 3.719597121048049*^9, 3.71959895273201*^9, 
   3.719599137837061*^9, 3.719599535576974*^9, 3.719602010475566*^9, 
   3.719602136544497*^9, 
   3.719602246683134*^9},ExpressionUUID->"7511fae0-2c39-4e5e-8907-\
f0638d490e3c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"lo", "=", 
      RowBox[{"logForward", "[", 
       RowBox[{"100", ",", "100", ",", "1", ",", "0.05"}], "]"}]}], ",", 
     RowBox[{"a", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"Z", "-", "a"}], ")"}], 
          RowBox[{
           RowBox[{"BSCall", "[", 
            RowBox[{"S", ",", "lo", ",", "Z"}], "]"}], "-", 
           RowBox[{"BSCall", "[", 
            RowBox[{"S", ",", "lo", ",", "a"}], "]"}]}]], ")"}], "2"], ",", 
       "Z"}], "]"}], ",", 
     RowBox[{"Z", "\[Rule]", "a"}]}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.718742735326175*^9, 3.7187427494144106`*^9}, {
  3.718742798947158*^9, 3.7187428908113956`*^9}, {3.718742926833728*^9, 
  3.718742933846698*^9}, {3.7187432012761965`*^9, 
  3.7187432712785997`*^9}},ExpressionUUID->"228c8dda-889a-42ce-bb38-\
fc3dc9d10ea7"],

Cell[BoxData[
 FractionBox["2.10440416368881`", 
  SuperscriptBox["S", "2"]]], "Output",
 CellChangeTimes->{{3.7187428404133673`*^9, 3.718742891500673*^9}, 
   3.7187430636221447`*^9, 3.7187432726529727`*^9, 3.718743677956784*^9, 
   3.7187461787093744`*^9, 3.719243169519069*^9, 3.719249025672326*^9, 
   3.7192494787579994`*^9, 3.7192505250040417`*^9, 3.719328390647582*^9, 
   3.71933050773991*^9, 3.719597121647915*^9, 3.719599138985125*^9, 
   3.7195995379563217`*^9},ExpressionUUID->"6de4e49e-3267-420e-9077-\
aa1e335d6aff"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ReversionCoeffs", "[", 
    RowBox[{"S_", ",", "K_", ",", "T_", ",", "r_", ",", "a_", ",", "n_"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"lo", "=", 
       RowBox[{"logForward", "[", 
        RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Limit", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{"Z", "-", "a"}], ")"}], 
            RowBox[{
             RowBox[{"BSCall", "[", 
              RowBox[{"S", ",", "lo", ",", "Z"}], "]"}], "-", 
             RowBox[{"BSCall", "[", 
              RowBox[{"S", ",", "lo", ",", "a"}], "]"}]}]], ")"}], "n"], ",", 
         RowBox[{"{", 
          RowBox[{"Z", ",", 
           RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"Z", "\[Rule]", "a"}]}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.718743318165514*^9, 3.718743319399342*^9}, {
  3.7187433575605803`*^9, 
  3.7187435457699356`*^9}},ExpressionUUID->"a715d212-f502-4466-9a8b-\
254939140f89"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"ReversionCoeffs", "[", 
    RowBox[{"100", ",", "100", ",", "1", ",", "0.05", ",", "1", ",", "n"}], 
    "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.718743550071216*^9, 3.7187435980159993`*^9}, {
  3.718743671045268*^9, 
  3.718743671376648*^9}},ExpressionUUID->"4b406a20-e6b0-41e1-9991-\
0b0384281404"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.029159291976334666`", ",", "0.000210440416368881`", ",", 
   "9.421689901363702`*^-6"}], "}"}]], "Output",
 CellChangeTimes->{{3.7187435704859734`*^9, 3.7187435785970154`*^9}, 
   3.7187436800351596`*^9, 3.7187461787279243`*^9, 3.719243171527109*^9, 
   3.719249025706417*^9, 3.7192494811168437`*^9, 3.719250527254828*^9, 
   3.7193283945712147`*^9, 3.719330507824139*^9, 3.719597124845881*^9, 
   3.719599143315946*^9, 
   3.719599542355468*^9},ExpressionUUID->"e40c1d93-60a5-4f4e-a2b8-\
3cf71de36933"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Adjusted initial point using Jim Gatheral\[CloseCurlyQuote]s tight upper \
bound of implied volatility: A more rapidly asymptotic series.\
\>", "Section",
 CellChangeTimes->{{3.7192443982469754`*^9, 
  3.7192444713402057`*^9}},ExpressionUUID->"4f3ff7d2-4832-4e1e-9fb0-\
7f1f4cb10327"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"StdUpperBound", "[", 
    RowBox[{"C_", ",", "F_", ",", "K_", ",", "T_", ",", "r_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "c", ",", "k", ",", "a", ",", "psi", ",", "theta", ",", "upperBound"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"c", "=", 
       FractionBox["C", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "r"}], " ", "T"}], "]"}], " ", "F"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"k", "=", 
       RowBox[{"Log", "[", 
        FractionBox["K", "F"], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"a", "=", 
       FractionBox[
        RowBox[{"1", "-", "c"}], 
        RowBox[{"1", "+", 
         RowBox[{"Exp", "[", "k", "]"}]}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"psi", "=", 
       RowBox[{"InverseCDF", "[", 
        RowBox[{
         RowBox[{"NormalDistribution", "[", 
          RowBox[{"0", ",", "1"}], "]"}], ",", "a"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"theta", "=", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"PDF", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "1"}], "]"}], ",", "psi"}], "]"}], "psi"]}], 
        "*", " ", 
        FractionBox[
         RowBox[{
          RowBox[{"Exp", "[", "k", "]"}], "-", "1"}], 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"2", " ", "k"}], "]"}], "+", "1"}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"upperBound", " ", "=", 
       RowBox[{"N", "[", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"InverseCDF", "[", 
            RowBox[{
             RowBox[{"NormalDistribution", "[", 
              RowBox[{"0", ",", "1"}], "]"}], ",", 
             RowBox[{"a", "+", 
              RowBox[{"theta", "*", 
               RowBox[{"Exp", "[", "k", "]"}]}]}]}], "]"}]}], "-", 
          RowBox[{"InverseCDF", "[", 
           RowBox[{
            RowBox[{"NormalDistribution", "[", 
             RowBox[{"0", ",", "1"}], "]"}], ",", 
            RowBox[{"a", "-", "theta"}]}], "]"}]}], ",", "30"}], "]"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.71924320459818*^9, 3.719243305062341*^9}, {
  3.7192433380413713`*^9, 3.719243479995822*^9}, {3.71924358033877*^9, 
  3.719243607089596*^9}, {3.7192436800012765`*^9, 3.719243902811346*^9}, {
  3.7192441293208313`*^9, 3.7192441341043577`*^9}, {3.719248995664137*^9, 
  3.719248997600459*^9}, {3.719249398685669*^9, 
  3.7192494037359776`*^9}},ExpressionUUID->"ec986b81-c0c4-4297-8994-\
af529782013a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "100"}], ",", 
     RowBox[{"K", "=", "120"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"r", "=", "0.05"}], ",", 
     RowBox[{"\[Sigma]", "=", "0.3"}]}], "}"}], ",", 
   RowBox[{"StdUpperBound", "[", 
    RowBox[{
     RowBox[{"BSCallHandy", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}], 
     ",", 
     RowBox[{"S", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"r", " ", "T"}], "]"}]}], ",", "K", ",", "T", ",", "r"}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7192439072641296`*^9, 3.7192439237420006`*^9}, {
  3.7192439723203135`*^9, 3.719244099331224*^9}, {3.7192441405442257`*^9, 
  3.71924420285784*^9}, {3.7192494074159307`*^9, 
  3.7192494088717313`*^9}},ExpressionUUID->"5482c4e2-61db-4db2-af2d-\
f2e99ebea7fb"],

Cell[BoxData["0.3001412933884637`"], "Output",
 CellChangeTimes->{{3.7192440736047473`*^9, 3.719244099697445*^9}, {
   3.719244137732541*^9, 3.7192442032879295`*^9}, 3.7192490257320194`*^9, 
   3.719249482397484*^9, 3.7192505280208626`*^9, 3.719328394710609*^9, 
   3.719330507907979*^9, 3.71959712497504*^9, 3.719599143535103*^9, 
   3.71959954249755*^9},ExpressionUUID->"a708b0b8-a1fa-432e-b0c1-\
9375ad3d5092"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"targetCallPrice", "=", 
        RowBox[{"BSCallHandy", "[", 
         RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], 
         "]"}]}], ",", 
       RowBox[{"estimatedCallPrice", "=", 
        RowBox[{"BSCallTaylorExpansion", "[", 
         RowBox[{
         "S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]", ",", "a", ",", 
          "order"}], "]"}]}], ",", "estimatedIV", ",", "fixa", ",", 
       "upperbound"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"fixa", "=", " ", 
       RowBox[{"StdUpperBound", "[", 
        RowBox[{
         RowBox[{"BSCallHandy", "[", 
          RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}],
          ",", 
         RowBox[{"S", "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"r", " ", "T"}], "]"}]}], ",", "K", ",", "T", ",", "r"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"upperbound", " ", "=", " ", 
       FractionBox["fixa", 
        SqrtBox["T"]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"estimatedIV", "=", 
       RowBox[{"InverseCallIV", "[", 
        RowBox[{
        "targetCallPrice", ",", "S", ",", "K", ",", "T", ",", "r", ",", "a", 
         ",", "order"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"targetCallPrice", ",", "estimatedCallPrice"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]", ",", "upperbound", ",", "estimatedIV"}], "}"}]}],
        "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
   "\"\<underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)\>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "100.", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "150", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<strike, K\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"K", ",", "100", ",", "\"\<\>\""}], "}"}], ",", "0", ",", "150",
      ",", "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<volatility, \[Sigma]\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", "0.3", ",", "\"\<\>\""}], "}"}], ",", "0.01", 
     ",", "1", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<risk-free rate, r\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "0.05", ",", "\"\<\>\""}], "}"}], ",", "0.0", ",", 
     "0.25", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<years to maturity, T\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "0.1", ",", "3", 
     ",", "0.25", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<truncated order, order\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "10", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "64", ",", "8", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<fixed point, a\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{"StdUpperBound", "[", 
        RowBox[{
         RowBox[{"BSCallHandy", "[", 
          RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}],
          ",", 
         RowBox[{"S", "*", 
          RowBox[{"Exp", "[", 
           RowBox[{"r", " ", "T"}], "]"}]}], ",", "K", ",", "T", ",", "r"}], 
        "]"}], ",", "\"\<\>\""}], "}"}], ",", "0", ",", "5", ",", "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.719244267738454*^9, 3.7192442684238305`*^9}, {
  3.71924472575788*^9, 3.719244845115471*^9}, {3.7192449133551865`*^9, 
  3.719244917611848*^9}, {3.719247923084504*^9, 3.719247945593335*^9}, {
  3.719248797638819*^9, 3.7192488422931786`*^9}, {3.7192488826376686`*^9, 
  3.719248928172059*^9}, {3.7192490019763994`*^9, 3.7192490084887943`*^9}, {
  3.7192490390091853`*^9, 3.719249048868826*^9}, {3.7192494122425127`*^9, 
  3.719249418409501*^9}, {3.719345574550219*^9, 3.719345696960525*^9}, {
  3.719352288455309*^9, 3.719352289232615*^9}, {3.7193550849725924`*^9, 
  3.719355085576631*^9}, {3.7193551596145*^9, 
  3.719355159950609*^9}},ExpressionUUID->"7f28ed16-d987-4569-8ff4-\
9913fe2ae203"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = ConditionalExpression[
    1.4142135623730950488016887242096980785696718753769480731767`30. 
      InverseErfc[
       2.`30. ((1.`30. + 
            2.7182818284590452353602874713526624938382062863352767788129`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
           1.`30. + 0.5`30. 
            2.7182818284590452353602874713526624938382062863352767788129`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) 
            K$$ $CellContext`S$$^(-1) (1.`30. + 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. ((-0.5`30.) $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
           0.5`30. (-1.`30. - 1.`30. 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. (0.5`30. $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) - 
         0.2820947917738781434740397257803862929220253146644994284221`30. 
         2.7182818284590452353602874713526624976385970411900203714065`30.^((-\
1.`30.) InverseErfc[
             2.`30. (1.`30. + 
                2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
               1.`30. + 0.5`30. 
                2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1.`30. + 
                 Erf[0.7071067811865475244008443621048490392848359376884740365\
884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               0.5`30. (-1.`30. - 1.`30. 
                 Erf[0.7071067811865475244008443621048490392848359376884740365\
884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) (1.`30. + 
           2.7182818284590452353602874713526624976385970411900203714065`30.^((\
-2.`30.) $CellContext`r$$ $CellContext`T$$) 
            K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
          2.7182818284590452353602874713526624976385970411900203714065`30.^((-\
1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)/InverseErfc[
         2.`30. (1.`30. + 
            2.7182818284590452353602874713526624976385970411900203714065`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
           1.`30. + 0.5`30. 
            2.7182818284590452353602874713526624976385970411900203714065`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) 
            K$$ $CellContext`S$$^(-1) (1.`30. + 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. ((-0.5`30.) $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
           0.5`30. (-1.`30. - 1.`30. 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. (0.5`30. $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))])] + 
     1.4142135623730950488016887242096980785696718753769480731767`30. 
      InverseErfc[
       2.`30. ((1.`30. + 
            2.7182818284590452353602874713526624938382062863352767788129`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
           1.`30. + 0.5`30. 
            2.7182818284590452353602874713526624938382062863352767788129`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) 
            K$$ $CellContext`S$$^(-1) (1.`30. + 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. ((-0.5`30.) $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
           0.5`30. (-1.`30. - 1.`30. 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. (0.5`30. $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) + 
         0.2820947917738781434740397257803862929220253146644994284221`30. 
          2.7182818284590452353602874713526624976385970411900203714065`30.^((-\
1.`30.) $CellContext`r$$ $CellContext`T$$ - 1.`30. 
            InverseErfc[
              2.`30. (1.`30. + 
                 2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
                1.`30. + 0.5`30. 
                 2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                 K$$ $CellContext`S$$^(-1) (1.`30. + 
                  Erf[0.707106781186547524400844362104849039284835937688474036\
5884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                0.5`30. (-1.`30. - 1.`30. 
                  Erf[0.707106781186547524400844362104849039284835937688474036\
5884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) 
          K$$ (1.`30. + 
            2.7182818284590452353602874713526624976385970411900203714065`30.^(\
(-2.`30.) $CellContext`r$$ $CellContext`T$$) 
             K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
           2.7182818284590452353602874713526624976385970411900203714065`30.^((\
-1.`30.) $CellContext`r$$ $CellContext`T$$) 
            K$$/$CellContext`S$$) $CellContext`S$$^(-1)/InverseErfc[
          2.`30. (1.`30. + 
             2.7182818284590452353602874713526624976385970411900203714065`30.^\
((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
            1.`30. + 0.5`30. 
             2.7182818284590452353602874713526624976385970411900203714065`30.^\
((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
             K$$ $CellContext`S$$^(-1) (1.`30. + 
              Erf[0.7071067811865475244008443621048490392848359376884740365884\
`30. ((-0.5`30.) $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
            0.5`30. (-1.`30. - 1.`30. 
              Erf[0.7071067811865475244008443621048490392848359376884740365884\
`30. (0.5`30. $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))])], 
     And[0 <= (1.`30. + 
          2.7182818284590452353602874713526624938382062863352767788129`30.^((-\
1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (1.`30. + 
         0.5`30. 2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
          K$$ $CellContext`S$$^(-1) (1.`30. + 
           Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. ((-0.5`30.) $CellContext`T$$^
                Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                Rational[-1, 
                  2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
         0.5`30. (-1.`30. - 1.`30. 
           Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. (0.5`30. $CellContext`T$$^
                Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                Rational[-1, 
                  2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) - 
       0.2820947917738781434740397257803862929220253146644994284221`30. 
       2.7182818284590452353602874713526624976385970411900203714065`30.^((-1.`\
30.) InverseErfc[
           2.`30. (1.`30. + 
              2.7182818284590452353602874713526624976385970411900203714065`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
             1.`30. + 0.5`30. 
              2.7182818284590452353602874713526624976385970411900203714065`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
              K$$ $CellContext`S$$^(-1) (1.`30. + 
               Erf[0.707106781186547524400844362104849039284835937688474036588\
4`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
             0.5`30. (-1.`30. - 1.`30. 
               Erf[0.707106781186547524400844362104849039284835937688474036588\
4`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) (1.`30. + 
         2.7182818284590452353602874713526624976385970411900203714065`30.^((-\
2.`30.) $CellContext`r$$ $CellContext`T$$) 
          K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
        2.7182818284590452353602874713526624976385970411900203714065`30.^((-1.\
`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)/InverseErfc[
       2.`30. (1.`30. + 
          2.7182818284590452353602874713526624976385970411900203714065`30.^((-\
1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (1.`30. + 
         0.5`30. 2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
          K$$ $CellContext`S$$^(-1) (1.`30. + 
           Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. ((-0.5`30.) $CellContext`T$$^
                Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                Rational[-1, 
                  2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
         0.5`30. (-1.`30. - 1.`30. 
           Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. (0.5`30. $CellContext`T$$^
                Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                Rational[-1, 
                  2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))] <= 1.`30., 
      0 <= (1.`30. + 
         2.7182818284590452353602874713526624938382062863352767788129`30.^((-\
1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (1.`30. + 
        0.5`30. 2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
         K$$ $CellContext`S$$^(-1) (1.`30. + 
          Erf[0.7071067811865475244008443621048490392848359376884740365884`30.\
 ((-0.5`30.) $CellContext`T$$^
               Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
               Rational[-1, 
                 2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
        0.5`30. (-1.`30. - 1.`30. 
          Erf[0.7071067811865475244008443621048490392848359376884740365884`30.\
 (0.5`30. $CellContext`T$$^
               Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
               Rational[-1, 
                 2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30., 
      0 <= (1.`30. + 
         2.7182818284590452353602874713526624938382062863352767788129`30.^((-\
1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (1.`30. + 
        0.5`30. 2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
         K$$ $CellContext`S$$^(-1) (1.`30. + 
          Erf[0.7071067811865475244008443621048490392848359376884740365884`30.\
 ((-0.5`30.) $CellContext`T$$^
               Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
               Rational[-1, 
                 2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
        0.5`30. (-1.`30. - 1.`30. 
          Erf[0.7071067811865475244008443621048490392848359376884740365884`30.\
 (0.5`30. $CellContext`T$$^
               Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
               Rational[-1, 
                 2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30., 
      0 <= (1.`30. + 
          2.7182818284590452353602874713526624938382062863352767788129`30.^((-\
1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (1.`30. + 
         0.5`30. 2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
          K$$ $CellContext`S$$^(-1) (1.`30. + 
           Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. ((-0.5`30.) $CellContext`T$$^
                Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                Rational[-1, 
                  2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
         0.5`30. (-1.`30. - 1.`30. 
           Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. (0.5`30. $CellContext`T$$^
                Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                Rational[-1, 
                  2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) + 
       0.2820947917738781434740397257803862929220253146644994284221`30. 
        2.7182818284590452353602874713526624976385970411900203714065`30.^((-1.\
`30.) $CellContext`r$$ $CellContext`T$$ - 1.`30. 
          InverseErfc[
            2.`30. (1.`30. + 
               2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
              1.`30. + 0.5`30. 
               2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1.`30. + 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              0.5`30. (-1.`30. - 1.`30. 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) 
        K$$ (1.`30. + 
          2.7182818284590452353602874713526624976385970411900203714065`30.^((-\
2.`30.) $CellContext`r$$ $CellContext`T$$) 
           K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
         2.7182818284590452353602874713526624976385970411900203714065`30.^((-\
1.`30.) $CellContext`r$$ $CellContext`T$$) 
          K$$/$CellContext`S$$) $CellContext`S$$^(-1)/InverseErfc[
        2.`30. (1.`30. + 
           2.7182818284590452353602874713526624976385970411900203714065`30.^((\
-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
          1.`30. + 0.5`30. 
           2.7182818284590452353602874713526624976385970411900203714065`30.^((\
-1.`30.) $CellContext`r$$ $CellContext`T$$) 
           K$$ $CellContext`S$$^(-1) (1.`30. + 
            Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. ((-0.5`30.) $CellContext`T$$^
                 Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                 Rational[-1, 
                   2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
          0.5`30. (-1.`30. - 1.`30. 
            Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. (0.5`30. $CellContext`T$$^
                 Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                 Rational[-1, 
                   2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))] <= 1.`30., 
      0 <= (1.`30. + 
         2.7182818284590452353602874713526624938382062863352767788129`30.^((-\
1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (1.`30. + 
        0.5`30. 2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
         K$$ $CellContext`S$$^(-1) (1.`30. + 
          Erf[0.7071067811865475244008443621048490392848359376884740365884`30.\
 ((-0.5`30.) $CellContext`T$$^
               Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
               Rational[-1, 
                 2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
        0.5`30. (-1.`30. - 1.`30. 
          Erf[0.7071067811865475244008443621048490392848359376884740365884`30.\
 (0.5`30. $CellContext`T$$^
               Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
               Rational[-1, 
                 2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30., 
      0 <= (1.`30. + 
         2.7182818284590452353602874713526624938382062863352767788129`30.^((-\
1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (1.`30. + 
        0.5`30. 2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
         K$$ $CellContext`S$$^(-1) (1.`30. + 
          Erf[0.7071067811865475244008443621048490392848359376884740365884`30.\
 ((-0.5`30.) $CellContext`T$$^
               Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
               Rational[-1, 
                 2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
        0.5`30. (-1.`30. - 1.`30. 
          Erf[0.7071067811865475244008443621048490392848359376884740365884`30.\
 (0.5`30. $CellContext`T$$^
               Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
               Rational[-1, 
                 2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30.]], K$$ = 
    100, $CellContext`order$$ = 10, $CellContext`r$$ = 
    0.05, $CellContext`S$$ = 100., $CellContext`T$$ = 
    1, $CellContext`\[Sigma]$$ = 0.3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold["underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)"], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`S$$], 100., ""}, 0, 150, 1}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["strike, K"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[K$$], 100, ""}, 0, 150, 0.5}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["volatility, \[Sigma]"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Sigma]$$], 0.3, ""}, 0.01, 1, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["risk-free rate, r"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`r$$], 0.05, ""}, 0., 0.25, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["years to maturity, T"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`T$$], 1, ""}, 0.1, 3, 0.25}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["truncated order, order"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`order$$], 10, ""}, 0, 64, 8}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["fixed point, a"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`a$$], 
       ConditionalExpression[
       1.4142135623730950488016887242096980785696718753769480731767`30. 
         InverseErfc[
          2.`30. ((1.`30. + 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
              1.`30. + 0.5`30. 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1.`30. + 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              0.5`30. (-1.`30. - 1.`30. 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) - 
            0.2820947917738781434740397257803862929220253146644994284221`30. 
            2.7182818284590452353602874713526624976385970411900203714065`30.^(\
(-1.`30.) InverseErfc[
                2.`30. (1.`30. + 
                   2.718281828459045235360287471352662497638597041190020371406\
5`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$/$CellContext`S$$)^(-1) (1.`30. + 
                  0.5`30. 
                   2.718281828459045235360287471352662497638597041190020371406\
5`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                   K$$ $CellContext`S$$^(-1) (1.`30. + 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                  0.5`30. (-1.`30. - 1.`30. 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) (1.`30. + 
              2.7182818284590452353602874713526624976385970411900203714065`30.\
^((-2.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
             2.7182818284590452353602874713526624976385970411900203714065`30.^\
((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)/
            InverseErfc[
            2.`30. (1.`30. + 
               2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
              1.`30. + 0.5`30. 
               2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1.`30. + 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              0.5`30. (-1.`30. - 1.`30. 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))])] + 
        1.4142135623730950488016887242096980785696718753769480731767`30. 
         InverseErfc[
          2.`30. ((1.`30. + 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
              1.`30. + 0.5`30. 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1.`30. + 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              0.5`30. (-1.`30. - 1.`30. 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) + 
            0.2820947917738781434740397257803862929220253146644994284221`30. 
             2.7182818284590452353602874713526624976385970411900203714065`30.^\
((-1.`30.) $CellContext`r$$ $CellContext`T$$ - 1.`30. 
               InverseErfc[
                 2.`30. (1.`30. + 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$/$CellContext`S$$)^(-1) (1.`30. + 
                   0.5`30. 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$ $CellContext`S$$^(-1) (1.`30. + 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                   0.5`30. (-1.`30. - 1.`30. 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) 
             K$$ (1.`30. + 
               2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-2.`30.) $CellContext`r$$ $CellContext`T$$) 
                K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
              2.7182818284590452353602874713526624976385970411900203714065`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$/$CellContext`S$$) $CellContext`S$$^(-1)/InverseErfc[
             2.`30. (1.`30. + 
                2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
               1.`30. + 0.5`30. 
                2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1.`30. + 
                 Erf[0.7071067811865475244008443621048490392848359376884740365\
884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               0.5`30. (-1.`30. - 1.`30. 
                 Erf[0.7071067811865475244008443621048490392848359376884740365\
884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))])], 
        And[
        0 <= (1.`30. + 
             2.7182818284590452353602874713526624938382062863352767788129`30.^\
((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
            1.`30. + 0.5`30. 
             2.7182818284590452353602874713526624938382062863352767788129`30.^\
((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
             K$$ $CellContext`S$$^(-1) (1.`30. + 
              Erf[0.7071067811865475244008443621048490392848359376884740365884\
`30. ((-0.5`30.) $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
            0.5`30. (-1.`30. - 1.`30. 
              Erf[0.7071067811865475244008443621048490392848359376884740365884\
`30. (0.5`30. $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) - 
          0.2820947917738781434740397257803862929220253146644994284221`30. 
          2.7182818284590452353602874713526624976385970411900203714065`30.^((-\
1.`30.) InverseErfc[
              2.`30. (1.`30. + 
                 2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
                1.`30. + 0.5`30. 
                 2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                 K$$ $CellContext`S$$^(-1) (1.`30. + 
                  Erf[0.707106781186547524400844362104849039284835937688474036\
5884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                0.5`30. (-1.`30. - 1.`30. 
                  Erf[0.707106781186547524400844362104849039284835937688474036\
5884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) (1.`30. + 
            2.7182818284590452353602874713526624976385970411900203714065`30.^(\
(-2.`30.) $CellContext`r$$ $CellContext`T$$) 
             K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
           2.7182818284590452353602874713526624976385970411900203714065`30.^((\
-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)/InverseErfc[
          2.`30. (1.`30. + 
             2.7182818284590452353602874713526624976385970411900203714065`30.^\
((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
            1.`30. + 0.5`30. 
             2.7182818284590452353602874713526624976385970411900203714065`30.^\
((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
             K$$ $CellContext`S$$^(-1) (1.`30. + 
              Erf[0.7071067811865475244008443621048490392848359376884740365884\
`30. ((-0.5`30.) $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
            0.5`30. (-1.`30. - 1.`30. 
              Erf[0.7071067811865475244008443621048490392848359376884740365884\
`30. (0.5`30. $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))] <= 1.`30., 
         0 <= (1.`30. + 
            2.7182818284590452353602874713526624938382062863352767788129`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
           1.`30. + 0.5`30. 
            2.7182818284590452353602874713526624938382062863352767788129`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) 
            K$$ $CellContext`S$$^(-1) (1.`30. + 
             Erf[
              0.7071067811865475244008443621048490392848359376884740365884`30.\
 ((-0.5`30.) $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
           0.5`30. (-1.`30. - 1.`30. 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. (0.5`30. $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30., 
         0 <= (1.`30. + 
            2.7182818284590452353602874713526624938382062863352767788129`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
           1.`30. + 0.5`30. 
            2.7182818284590452353602874713526624938382062863352767788129`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) 
            K$$ $CellContext`S$$^(-1) (1.`30. + 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. ((-0.5`30.) $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
           0.5`30. (-1.`30. - 1.`30. 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. (0.5`30. $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30., 
         0 <= (1.`30. + 
             2.7182818284590452353602874713526624938382062863352767788129`30.^\
((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
            1.`30. + 0.5`30. 
             2.7182818284590452353602874713526624938382062863352767788129`30.^\
((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
             K$$ $CellContext`S$$^(-1) (1.`30. + 
              Erf[0.7071067811865475244008443621048490392848359376884740365884\
`30. ((-0.5`30.) $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
            0.5`30. (-1.`30. - 1.`30. 
              Erf[0.7071067811865475244008443621048490392848359376884740365884\
`30. (0.5`30. $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) + 
          0.2820947917738781434740397257803862929220253146644994284221`30. 
           2.7182818284590452353602874713526624976385970411900203714065`30.^((\
-1.`30.) $CellContext`r$$ $CellContext`T$$ - 1.`30. 
             InverseErfc[
               2.`30. (1.`30. + 
                  2.7182818284590452353602874713526624976385970411900203714065\
`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                   K$$/$CellContext`S$$)^(-1) (1.`30. + 
                 0.5`30. 
                  2.7182818284590452353602874713526624976385970411900203714065\
`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                  K$$ $CellContext`S$$^(-1) (1.`30. + 
                   Erf[0.70710678118654752440084436210484903928483593768847403\
65884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                 0.5`30. (-1.`30. - 1.`30. 
                   Erf[0.70710678118654752440084436210484903928483593768847403\
65884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) 
           K$$ (1.`30. + 
             2.7182818284590452353602874713526624976385970411900203714065`30.^\
((-2.`30.) $CellContext`r$$ $CellContext`T$$) 
              K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
            2.7182818284590452353602874713526624976385970411900203714065`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) 
             K$$/$CellContext`S$$) $CellContext`S$$^(-1)/InverseErfc[
           2.`30. (1.`30. + 
              2.7182818284590452353602874713526624976385970411900203714065`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
             1.`30. + 0.5`30. 
              2.7182818284590452353602874713526624976385970411900203714065`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
              K$$ $CellContext`S$$^(-1) (1.`30. + 
               Erf[0.707106781186547524400844362104849039284835937688474036588\
4`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
             0.5`30. (-1.`30. - 1.`30. 
               Erf[0.707106781186547524400844362104849039284835937688474036588\
4`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))] <= 1.`30., 
         0 <= (1.`30. + 
            2.7182818284590452353602874713526624938382062863352767788129`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
           1.`30. + 0.5`30. 
            2.7182818284590452353602874713526624938382062863352767788129`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) 
            K$$ $CellContext`S$$^(-1) (1.`30. + 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. ((-0.5`30.) $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
           0.5`30. (-1.`30. - 1.`30. 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. (0.5`30. $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30., 
         0 <= (1.`30. + 
            2.7182818284590452353602874713526624938382062863352767788129`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
           1.`30. + 0.5`30. 
            2.7182818284590452353602874713526624938382062863352767788129`30.^(\
(-1.`30.) $CellContext`r$$ $CellContext`T$$) 
            K$$ $CellContext`S$$^(-1) (1.`30. + 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. ((-0.5`30.) $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
           0.5`30. (-1.`30. - 1.`30. 
             Erf[0.7071067811865475244008443621048490392848359376884740365884`\
30. (0.5`30. $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30.]], ""}, 0, 5,
       0.5}}, Typeset`size$$ = {279., {3., 9.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`S$5558$$ = 0, K$5559$$ = 
    0, $CellContext`\[Sigma]$5560$$ = 0, $CellContext`r$5561$$ = 
    0, $CellContext`T$5562$$ = 0, $CellContext`order$5563$$ = 
    0, $CellContext`a$5564$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 
        ConditionalExpression[
         1.4142135623730950488016887242096980785696718753769480731767`30. 
           InverseErfc[
            2.`30. ((1.`30. + 
                 2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
                1.`30. + 0.5`30. 
                 2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                 K$$ $CellContext`S$$^(-1) (1.`30. + 
                  Erf[0.707106781186547524400844362104849039284835937688474036\
5884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                0.5`30. (-1.`30. - 1.`30. 
                  Erf[0.707106781186547524400844362104849039284835937688474036\
5884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) - 
              0.2820947917738781434740397257803862929220253146644994284221`30.\
 2.7182818284590452353602874713526624976385970411900203714065`30.^((-1.`30.) 
                InverseErfc[
                  2.`30. (1.`30. + 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$/$CellContext`S$$)^(-1) (1.`30. + 
                    0.5`30. 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$ $CellContext`S$$^(-1) (1.`30. + 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                    0.5`30. (-1.`30. - 1.`30. 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) (1.`30. + 
                2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-2.`30.) $CellContext`r$$ $CellContext`T$$) 
                 K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
               2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)/
              InverseErfc[
              2.`30. (1.`30. + 
                 2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
                1.`30. + 0.5`30. 
                 2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                 K$$ $CellContext`S$$^(-1) (1.`30. + 
                  Erf[0.707106781186547524400844362104849039284835937688474036\
5884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                0.5`30. (-1.`30. - 1.`30. 
                  Erf[0.707106781186547524400844362104849039284835937688474036\
5884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))])] + 
          1.4142135623730950488016887242096980785696718753769480731767`30. 
           InverseErfc[
            2.`30. ((1.`30. + 
                 2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
                1.`30. + 0.5`30. 
                 2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                 K$$ $CellContext`S$$^(-1) (1.`30. + 
                  Erf[0.707106781186547524400844362104849039284835937688474036\
5884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                0.5`30. (-1.`30. - 1.`30. 
                  Erf[0.707106781186547524400844362104849039284835937688474036\
5884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) + 
              0.2820947917738781434740397257803862929220253146644994284221`30.\
 2.7182818284590452353602874713526624976385970411900203714065`30.^((-1.`30.) \
$CellContext`r$$ $CellContext`T$$ - 1.`30. 
                 InverseErfc[
                   2.`30. (1.`30. + 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$/$CellContext`S$$)^(-1) (1.`30. + 
                    0.5`30. 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$ $CellContext`S$$^(-1) (1.`30. + 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                    0.5`30. (-1.`30. - 1.`30. 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) 
               K$$ (1.`30. + 
                 2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-2.`30.) $CellContext`r$$ $CellContext`T$$) 
                  K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
                2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                 K$$/$CellContext`S$$) $CellContext`S$$^(-1)/InverseErfc[
               2.`30. (1.`30. + 
                  2.7182818284590452353602874713526624976385970411900203714065\
`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                   K$$/$CellContext`S$$)^(-1) (1.`30. + 
                 0.5`30. 
                  2.7182818284590452353602874713526624976385970411900203714065\
`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                  K$$ $CellContext`S$$^(-1) (1.`30. + 
                   Erf[0.70710678118654752440084436210484903928483593768847403\
65884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                 0.5`30. (-1.`30. - 1.`30. 
                   Erf[0.70710678118654752440084436210484903928483593768847403\
65884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))])], 
          And[
          0 <= (1.`30. + 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
              1.`30. + 0.5`30. 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1.`30. + 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              0.5`30. (-1.`30. - 1.`30. 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) - 
            0.2820947917738781434740397257803862929220253146644994284221`30. 
            2.7182818284590452353602874713526624976385970411900203714065`30.^(\
(-1.`30.) InverseErfc[
                2.`30. (1.`30. + 
                   2.718281828459045235360287471352662497638597041190020371406\
5`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$/$CellContext`S$$)^(-1) (1.`30. + 
                  0.5`30. 
                   2.718281828459045235360287471352662497638597041190020371406\
5`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                   K$$ $CellContext`S$$^(-1) (1.`30. + 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                  0.5`30. (-1.`30. - 1.`30. 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) (1.`30. + 
              2.7182818284590452353602874713526624976385970411900203714065`30.\
^((-2.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
             2.7182818284590452353602874713526624976385970411900203714065`30.^\
((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)/
            InverseErfc[
            2.`30. (1.`30. + 
               2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
              1.`30. + 0.5`30. 
               2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1.`30. + 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              0.5`30. (-1.`30. - 1.`30. 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))] <= 1.`30., 
           0 <= (1.`30. + 
              2.7182818284590452353602874713526624938382062863352767788129`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
             1.`30. + 0.5`30. 
              2.7182818284590452353602874713526624938382062863352767788129`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
              K$$ $CellContext`S$$^(-1) (1.`30. + 
               Erf[0.707106781186547524400844362104849039284835937688474036588\
4`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
             0.5`30. (-1.`30. - 1.`30. 
               Erf[0.707106781186547524400844362104849039284835937688474036588\
4`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30., 
           0 <= (1.`30. + 
              2.7182818284590452353602874713526624938382062863352767788129`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
             1.`30. + 0.5`30. 
              2.7182818284590452353602874713526624938382062863352767788129`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
              K$$ $CellContext`S$$^(-1) (1.`30. + 
               Erf[0.707106781186547524400844362104849039284835937688474036588\
4`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
             0.5`30. (-1.`30. - 1.`30. 
               Erf[0.707106781186547524400844362104849039284835937688474036588\
4`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30., 
           0 <= (1.`30. + 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
              1.`30. + 0.5`30. 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1.`30. + 
                Erf[
                 0.7071067811865475244008443621048490392848359376884740365884`\
30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              0.5`30. (-1.`30. - 1.`30. 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) + 
            0.2820947917738781434740397257803862929220253146644994284221`30. 
             2.7182818284590452353602874713526624976385970411900203714065`30.^\
((-1.`30.) $CellContext`r$$ $CellContext`T$$ - 1.`30. 
               InverseErfc[
                 2.`30. (1.`30. + 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$/$CellContext`S$$)^(-1) (1.`30. + 
                   0.5`30. 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$ $CellContext`S$$^(-1) (1.`30. + 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                   0.5`30. (-1.`30. - 1.`30. 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) 
             K$$ (1.`30. + 
               2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-2.`30.) $CellContext`r$$ $CellContext`T$$) 
                K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
              2.7182818284590452353602874713526624976385970411900203714065`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$/$CellContext`S$$) $CellContext`S$$^(-1)/InverseErfc[
             2.`30. (1.`30. + 
                2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
               1.`30. + 0.5`30. 
                2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1.`30. + 
                 Erf[0.7071067811865475244008443621048490392848359376884740365\
884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               0.5`30. (-1.`30. - 1.`30. 
                 Erf[0.7071067811865475244008443621048490392848359376884740365\
884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))] <= 1.`30., 
           0 <= (1.`30. + 
              2.7182818284590452353602874713526624938382062863352767788129`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
             1.`30. + 0.5`30. 
              2.7182818284590452353602874713526624938382062863352767788129`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
              K$$ $CellContext`S$$^(-1) (1.`30. + 
               Erf[0.707106781186547524400844362104849039284835937688474036588\
4`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
             0.5`30. (-1.`30. - 1.`30. 
               Erf[0.707106781186547524400844362104849039284835937688474036588\
4`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30., 
           0 <= (1.`30. + 
              2.7182818284590452353602874713526624938382062863352767788129`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
             1.`30. + 0.5`30. 
              2.7182818284590452353602874713526624938382062863352767788129`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
              K$$ $CellContext`S$$^(-1) (1.`30. + 
               Erf[0.707106781186547524400844362104849039284835937688474036588\
4`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
             0.5`30. (-1.`30. - 1.`30. 
               Erf[0.707106781186547524400844362104849039284835937688474036588\
4`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30.]], K$$ = 
        100, $CellContext`order$$ = 10, $CellContext`r$$ = 
        0.05, $CellContext`S$$ = 100., $CellContext`T$$ = 
        1, $CellContext`\[Sigma]$$ = 0.3}, "ControllerVariables" :> {
        Hold[$CellContext`S$$, $CellContext`S$5558$$, 0], 
        Hold[K$$, K$5559$$, 0], 
        Hold[$CellContext`\[Sigma]$$, $CellContext`\[Sigma]$5560$$, 0], 
        Hold[$CellContext`r$$, $CellContext`r$5561$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$5562$$, 0], 
        Hold[$CellContext`order$$, $CellContext`order$5563$$, 0], 
        Hold[$CellContext`a$$, $CellContext`a$5564$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`targetCallPrice$ = \
$CellContext`BSCallHandy[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$], \
$CellContext`estimatedCallPrice$ = \
$CellContext`BSCallTaylorExpansion[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$, \
$CellContext`a$$, $CellContext`order$$], $CellContext`estimatedIV$, \
$CellContext`fixa$, $CellContext`upperbound$}, $CellContext`fixa$ = \
$CellContext`StdUpperBound[
           $CellContext`BSCallHandy[$CellContext`S$$, 
            K$$, $CellContext`T$$, $CellContext`r$$, \
$CellContext`\[Sigma]$$], $CellContext`S$$ 
           Exp[$CellContext`r$$ $CellContext`T$$], 
           K$$, $CellContext`T$$, $CellContext`r$$]; $CellContext`upperbound$ = \
$CellContext`fixa$/
          Sqrt[$CellContext`T$$]; $CellContext`estimatedIV$ = \
$CellContext`InverseCallIV[$CellContext`targetCallPrice$, $CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`a$$, \
$CellContext`order$$]; {{$CellContext`targetCallPrice$, \
$CellContext`estimatedCallPrice$}, {$CellContext`\[Sigma]$$, \
$CellContext`upperbound$, $CellContext`estimatedIV$}}], 
      "Specifications" :> {
       "underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)", {{$CellContext`S$$, 
          100., ""}, 0, 150, 1, Appearance -> "Labeled", ImageSize -> Tiny}, 
        "", "strike, K", {{K$$, 100, ""}, 0, 150, 0.5, Appearance -> 
         "Labeled", ImageSize -> Tiny}, "", 
        "volatility, \[Sigma]", {{$CellContext`\[Sigma]$$, 0.3, ""}, 0.01, 1, 
         0.01, Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "risk-free rate, r", {{$CellContext`r$$, 0.05, ""}, 0., 0.25, 0.01, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "years to maturity, T", {{$CellContext`T$$, 1, ""}, 0.1, 3, 0.25, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "truncated order, order", {{$CellContext`order$$, 10, ""}, 0, 64, 8, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "fixed point, a", {{$CellContext`a$$, 
          ConditionalExpression[
          1.4142135623730950488016887242096980785696718753769480731767`30. 
            InverseErfc[
             2.`30. ((1.`30. + 
                  2.7182818284590452353602874713526624938382062863352767788129\
`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                   K$$/$CellContext`S$$)^(-1) (1.`30. + 
                 0.5`30. 
                  2.7182818284590452353602874713526624938382062863352767788129\
`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                  K$$ $CellContext`S$$^(-1) (1.`30. + 
                   Erf[0.70710678118654752440084436210484903928483593768847403\
65884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                 0.5`30. (-1.`30. - 1.`30. 
                   Erf[0.70710678118654752440084436210484903928483593768847403\
65884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) - 
               0.2820947917738781434740397257803862929220253146644994284221`\
30. 2.7182818284590452353602874713526624976385970411900203714065`30.^((-1.`30.\
) InverseErfc[2.`30. (1.`30. + 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$/$CellContext`S$$)^(-1) (1.`30. + 
                    0.5`30. 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$ $CellContext`S$$^(-1) (1.`30. + 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                    0.5`30. (-1.`30. - 1.`30. 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) (1.`30. + 
                 
                 2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-2.`30.) $CellContext`r$$ $CellContext`T$$) 
                  K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
                2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)/
               InverseErfc[
               2.`30. (1.`30. + 
                  2.7182818284590452353602874713526624976385970411900203714065\
`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                   K$$/$CellContext`S$$)^(-1) (1.`30. + 
                 0.5`30. 
                  2.7182818284590452353602874713526624976385970411900203714065\
`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                  K$$ $CellContext`S$$^(-1) (1.`30. + 
                   Erf[0.70710678118654752440084436210484903928483593768847403\
65884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                 0.5`30. (-1.`30. - 1.`30. 
                   Erf[0.70710678118654752440084436210484903928483593768847403\
65884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))])] + 
           1.4142135623730950488016887242096980785696718753769480731767`30. 
            InverseErfc[
             2.`30. ((1.`30. + 
                  2.7182818284590452353602874713526624938382062863352767788129\
`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                   K$$/$CellContext`S$$)^(-1) (1.`30. + 
                 0.5`30. 
                  2.7182818284590452353602874713526624938382062863352767788129\
`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                  K$$ $CellContext`S$$^(-1) (1.`30. + 
                   Erf[0.70710678118654752440084436210484903928483593768847403\
65884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                 0.5`30. (-1.`30. - 1.`30. 
                   Erf[0.70710678118654752440084436210484903928483593768847403\
65884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) + 
               0.2820947917738781434740397257803862929220253146644994284221`\
30. 2.7182818284590452353602874713526624976385970411900203714065`30.^((-1.`30.\
) $CellContext`r$$ $CellContext`T$$ - 1.`30. 
                  InverseErfc[
                    2.`30. (1.`30. + 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$/$CellContext`S$$)^(-1) (1.`30. + 
                    0.5`30. 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$ $CellContext`S$$^(-1) (1.`30. + 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                    0.5`30. (-1.`30. - 1.`30. 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) 
                K$$ (1.`30. + 
                  2.7182818284590452353602874713526624976385970411900203714065\
`30.^((-2.`30.) $CellContext`r$$ $CellContext`T$$) 
                   K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
                 2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                  K$$/$CellContext`S$$) $CellContext`S$$^(-1)/InverseErfc[
                2.`30. (1.`30. + 
                   2.718281828459045235360287471352662497638597041190020371406\
5`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$/$CellContext`S$$)^(-1) (1.`30. + 
                  0.5`30. 
                   2.718281828459045235360287471352662497638597041190020371406\
5`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                   K$$ $CellContext`S$$^(-1) (1.`30. + 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                  0.5`30. (-1.`30. - 1.`30. 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))])], 
           And[
           0 <= (1.`30. + 
                2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
               1.`30. + 0.5`30. 
                2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1.`30. + 
                 Erf[0.7071067811865475244008443621048490392848359376884740365\
884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               0.5`30. (-1.`30. - 1.`30. 
                 Erf[0.7071067811865475244008443621048490392848359376884740365\
884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) - 
             0.2820947917738781434740397257803862929220253146644994284221`30. 
             2.7182818284590452353602874713526624976385970411900203714065`30.^\
((-1.`30.) InverseErfc[
                 2.`30. (1.`30. + 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$/$CellContext`S$$)^(-1) (1.`30. + 
                   0.5`30. 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$ $CellContext`S$$^(-1) (1.`30. + 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                   0.5`30. (-1.`30. - 1.`30. 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) (1.`30. + 
               2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-2.`30.) $CellContext`r$$ $CellContext`T$$) 
                K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
              2.7182818284590452353602874713526624976385970411900203714065`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)/
             InverseErfc[
             2.`30. (1.`30. + 
                2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
               1.`30. + 0.5`30. 
                2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1.`30. + 
                 Erf[0.7071067811865475244008443621048490392848359376884740365\
884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               0.5`30. (-1.`30. - 1.`30. 
                 Erf[0.7071067811865475244008443621048490392848359376884740365\
884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))] <= 1.`30., 
            0 <= (1.`30. + 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
              1.`30. + 0.5`30. 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1.`30. + 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              0.5`30. (-1.`30. - 1.`30. 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30., 
            0 <= (1.`30. + 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
              1.`30. + 0.5`30. 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1.`30. + 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              0.5`30. (-1.`30. - 1.`30. 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30., 
            0 <= (1.`30. + 
                2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
               1.`30. + 0.5`30. 
                2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1.`30. + 
                 Erf[0.7071067811865475244008443621048490392848359376884740365\
884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               0.5`30. (-1.`30. - 1.`30. 
                 Erf[0.7071067811865475244008443621048490392848359376884740365\
884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) + 
             0.2820947917738781434740397257803862929220253146644994284221`30. 
              2.7182818284590452353602874713526624976385970411900203714065`30.\
^((-1.`30.) $CellContext`r$$ $CellContext`T$$ - 1.`30. 
                InverseErfc[
                  2.`30. (1.`30. + 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$/$CellContext`S$$)^(-1) (1.`30. + 
                    0.5`30. 
                    2.71828182845904523536028747135266249763859704119002037140\
65`30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                    K$$ $CellContext`S$$^(-1) (1.`30. + 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                    0.5`30. (-1.`30. - 1.`30. 
                    Erf[0.7071067811865475244008443621048490392848359376884740\
365884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))]^2) 
              K$$ (1.`30. + 
                2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-2.`30.) $CellContext`r$$ $CellContext`T$$) 
                 K$$^2 $CellContext`S$$^(-2))^(-1) (-1.`30. + 
               2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                K$$/$CellContext`S$$) $CellContext`S$$^(-1)/InverseErfc[
              2.`30. (1.`30. + 
                 2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
                1.`30. + 0.5`30. 
                 2.7182818284590452353602874713526624976385970411900203714065`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
                 K$$ $CellContext`S$$^(-1) (1.`30. + 
                  Erf[0.707106781186547524400844362104849039284835937688474036\
5884`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
                0.5`30. (-1.`30. - 1.`30. 
                  Erf[0.707106781186547524400844362104849039284835937688474036\
5884`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]))] <= 1.`30., 
            0 <= (1.`30. + 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
              1.`30. + 0.5`30. 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1.`30. + 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              0.5`30. (-1.`30. - 1.`30. 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30., 
            0 <= (1.`30. + 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) K$$/$CellContext`S$$)^(-1) (
              1.`30. + 0.5`30. 
               2.7182818284590452353602874713526624938382062863352767788129`\
30.^((-1.`30.) $CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1.`30. + 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. ((-0.5`30.) $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              0.5`30. (-1.`30. - 1.`30. 
                Erf[0.70710678118654752440084436210484903928483593768847403658\
84`30. (0.5`30. $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ + $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 1.`30.]], ""}, 0, 5,
          0.5, Appearance -> "Labeled", ImageSize -> Tiny}}, 
      "Options" :> {ControlPlacement -> Left}, "DefaultOptions" :> {}],
     ImageSizeCache->{451., {168., 173.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`BSCallHandy[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]]] := $CellContext`BSCall[$CellContext`S, 
         $CellContext`logForward[$CellContext`S, 
          K, $CellContext`T, $CellContext`r], 
         $CellContext`Z[$CellContext`\[Sigma], $CellContext`T]], \
$CellContext`BSCall[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`S ($CellContext`normalCDF[
           $CellContext`d1[$CellContext`lo, $CellContext`Z]] - 
         Exp[-$CellContext`lo] $CellContext`normalCDF[
           $CellContext`d2[$CellContext`lo, $CellContext`Z]]), $CellContext`Z[
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]]] := $CellContext`\[Sigma] 
        Sqrt[$CellContext`T], $CellContext`normalCDF[
         Pattern[$CellContext`d, 
          Blank[]]] := (1/2) (1 + 
         Erf[$CellContext`d/Sqrt[2]]), $CellContext`d1[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z + $CellContext`Z/
         2, $CellContext`d2[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z - $CellContext`Z/
        2, $CellContext`logForward[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]]] := 
       Log[$CellContext`S/
          K] + $CellContext`r $CellContext`T, \
$CellContext`BSCallTaylorExpansion[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries, \
$CellContext`callPrice}, $CellContext`std = $CellContext`Z[$CellContext`\
\[Sigma], $CellContext`T]; $CellContext`mu = \
$CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSCall[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`callPrice = ReplaceAll[
            
            Normal[$CellContext`IVSeries], $CellContext`Z -> \
$CellContext`std]], $CellContext`callPrice = 
       14.228124311728868`, $CellContext`StdUpperBound[
         Pattern[C, 
          Blank[]], 
         Pattern[$CellContext`F, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]]] := 
       Module[{$CellContext`c, $CellContext`k, $CellContext`a, \
$CellContext`psi, $CellContext`theta, $CellContext`upperBound}, \
$CellContext`c = 
          C/(Exp[(-$CellContext`r) $CellContext`T] $CellContext`F); \
$CellContext`k = 
          Log[K/$CellContext`F]; $CellContext`a = (1 - $CellContext`c)/(1 + 
           Exp[$CellContext`k]); $CellContext`psi = InverseCDF[
            NormalDistribution[
            0, 1], $CellContext`a]; $CellContext`theta = (-(PDF[
               NormalDistribution[
               0, 1], $CellContext`psi]/$CellContext`psi)) ((
             Exp[$CellContext`k] - 1)/(Exp[2 $CellContext`k] + 
            1)); $CellContext`upperBound = N[-InverseCDF[
               NormalDistribution[
               0, 1], $CellContext`a + $CellContext`theta 
                Exp[$CellContext`k]] - InverseCDF[
             NormalDistribution[0, 1], $CellContext`a - $CellContext`theta], 
            30]], $CellContext`F = 
       105.12710963760242`, $CellContext`InverseCallIV[
         Pattern[$CellContext`CallPrice, 
          Blank[]], 
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries, \
$CellContext`inversedIVSeries, $CellContext`impliedVol}, $CellContext`mu = \
$CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSCall[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`inversedIVSeries = 
          InverseSeries[$CellContext`IVSeries]; $CellContext`std = ReplaceAll[
            
            Normal[$CellContext`inversedIVSeries], $CellContext`Z -> \
$CellContext`CallPrice]; $CellContext`impliedVol = $CellContext`std/
           Sqrt[$CellContext`T]]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7192489290421553`*^9, {3.719249025835874*^9, 3.7192490515724382`*^9}, 
   3.7192494826977825`*^9, 3.7192505281522136`*^9, 3.7193283949525003`*^9, 
   3.719330508036845*^9, {3.719345670593483*^9, 3.7193456978294287`*^9}, 
   3.719352290128065*^9, 3.719354589083768*^9, 3.719355086553712*^9, {
   3.7193551338636837`*^9, 3.719355161119095*^9}, 3.719597125090554*^9, 
   3.7195991438087597`*^9, 
   3.719599542663143*^9},ExpressionUUID->"ee22a0f9-715f-4603-a918-\
dd31bd28ccf1"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Stefanica and Radoicic explicit volatility approximation formula\
\>", "Section",
 CellChangeTimes->{{3.719347842868188*^9, 
  3.719347911328557*^9}},ExpressionUUID->"f59f6acb-b86d-4f55-b76b-\
4fe2874d0efd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Polya", "[", "x_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", "+", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"Sign", "[", "x", "]"}], "2"], 
     SqrtBox[
      RowBox[{"1", "-", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["2", "Pi"]}], " ", 
         SuperscriptBox["x", "2"]}], "]"}]}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"k_", ",", "\[Sigma]_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "k", "]"}], " ", 
     RowBox[{"Polya", "[", 
      RowBox[{
       FractionBox["k", "\[Sigma]"], "+", 
       FractionBox["\[Sigma]", "2"]}], "]"}]}], "-", 
    RowBox[{"Polya", "[", 
     RowBox[{
      FractionBox["k", "\[Sigma]"], "+", 
      FractionBox["\[Sigma]", "2"]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SRVolPut", "[", 
     RowBox[{"P_", ",", "K_", ",", "T_", ",", "F_", ",", "r_"}], "]"}], ":=", 
    " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "srVol", ",", "y", ",", "R", ",", "A", ",", "B", ",", "C", ",", 
        "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "P0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"y", " ", "=", " ", 
        RowBox[{"Log", "[", 
         RowBox[{"F", "/", "K"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]", " ", "=", " ", 
        RowBox[{"P", "*", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"r", " ", "T"}], "]"}], "/", "K"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R", " ", "=", " ", 
        RowBox[{
         RowBox[{"2", " ", "\[Alpha]"}], " ", "+", " ", 
         RowBox[{"Exp", "[", "y", "]"}], " ", "-", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", "/", "Pi"}]}], ")"}], " ", "y"}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", "/", "Pi"}]}], ")"}]}], " ", "y"}], "]"}]}], 
          ")"}], "2"]}], ";", "\[IndentingNewLine]", 
       RowBox[{"B", " ", "=", " ", 
        RowBox[{
         RowBox[{"4", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"2", "/", "Pi"}], "*", "y"}], "]"}], "+", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], "/", "Pi"}], "*", "y"}], "]"}]}], ")"}]}], 
         "-", 
         RowBox[{"2", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", "y"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", "/", "Pi"}]}], ")"}], " ", "y"}], "]"}], "+", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", "/", "Pi"}]}], ")"}]}], " ", "y"}], "]"}]}], 
           ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "y"}], "]"}], "+", "1", "-", 
            SuperscriptBox["R", "2"]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "2"}], " ", "y"}], "]"}], 
         RowBox[{"(", " ", 
          RowBox[{
           SuperscriptBox["R", "2"], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exp", "[", "y", "]"}], "-", "1"}], ")"}], "2"]}], 
          ")"}], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exp", "[", "y", "]"}], "+", "1"}], ")"}], "2"], "-", 
           SuperscriptBox["R", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Beta]", " ", "=", " ", 
        FractionBox[
         RowBox[{"2", " ", "C"}], 
         RowBox[{"B", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["B", "2"], "+", 
            RowBox[{"4", " ", "A", " ", "C"}]}]]}]]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]", " ", "=", " ", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["Pi", "2"]}], 
         RowBox[{"Log", "[", "\[Beta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"P0", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"y", "\[GreaterEqual]", " ", "0"}], ",", 
          RowBox[{"K", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "r"}], " ", "T"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "2"], "-", 
             RowBox[{
              RowBox[{"Exp", "[", "y", "]"}], " ", 
              RowBox[{"Polya", "[", 
               RowBox[{"-", 
                SqrtBox[
                 RowBox[{"2", " ", "y"}]]}], "]"}]}]}], ")"}]}], ",", 
          RowBox[{"K", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "r"}], " ", "T"}], "]"}], " ", 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"Polya", "[", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", "2"}], " ", "y"}]], "]"}], "-", 
             FractionBox[
              RowBox[{"Exp", "[", "y", "]"}], "2"]}], ")"}]}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"srVol", " ", "=", " ", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"P", "\[LessEqual]", "P0"}], " ", "&&", " ", 
           RowBox[{"y", "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["T"]], 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              RowBox[{"\[Gamma]", "+", "y"}]], "-", 
             SqrtBox[
              RowBox[{"\[Gamma]", "-", "y"}]]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"P", ">", "P0"}], " ", "&&", " ", 
           RowBox[{"y", "\[GreaterEqual]", "0"}]}], ",", " ", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["T"]], 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              RowBox[{"\[Gamma]", "+", "y"}]], "+", 
             SqrtBox[
              RowBox[{"\[Gamma]", "-", "y"}]]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"P", "\[LessEqual]", "P0"}], " ", "&&", " ", 
           RowBox[{"y", "<", "0"}]}], ",", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["T"]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SqrtBox[
               RowBox[{"\[Gamma]", "+", "y"}]]}], "+", 
             SqrtBox[
              RowBox[{"\[Gamma]", "-", "y"}]]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"P", ">", "P0"}], " ", "&&", " ", 
           RowBox[{"y", "<", "0"}]}], ",", " ", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["T"]], 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              RowBox[{"\[Gamma]", "+", "y"}]], "+", 
             SqrtBox[
              RowBox[{"\[Gamma]", "-", "y"}]]}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "\[Beta]", ",", "\[Gamma]", ",", "y", ",", "P", ",", "P0", ",", 
         RowBox[{"K", "*", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "r"}], " ", "T"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "2"], "-", 
            RowBox[{
             RowBox[{"Exp", "[", "y", "]"}], "*", " ", 
             RowBox[{"Polya", "[", 
              RowBox[{"-", 
               SqrtBox[
                RowBox[{"2", "*", "y"}]]}], "]"}]}]}], ")"}]}], ",", 
         "srVol"}], "}"}], ";", "\[IndentingNewLine]", "srVol"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SRVolCall", "[", 
     RowBox[{"Call_", ",", "K_", ",", "T_", ",", "F_", ",", "r_"}], "]"}], ":=",
     " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "srVol", ",", "y", ",", "R", ",", "A", ",", "B", ",", "C", ",", 
        "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "P", ",", "P0"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"P", " ", "=", " ", 
        RowBox[{"Call", "-", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "r"}], " ", "T"}], "]"}], 
          RowBox[{"(", 
           RowBox[{"F", "-", "K"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"y", " ", "=", " ", 
        RowBox[{"Log", "[", 
         RowBox[{"F", "/", "K"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Alpha]", " ", "=", " ", 
        RowBox[{"P", "*", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"r", " ", "T"}], "]"}], "/", "K"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"R", " ", "=", " ", 
        RowBox[{
         RowBox[{"2", " ", "\[Alpha]"}], " ", "+", " ", 
         RowBox[{"Exp", "[", "y", "]"}], " ", "-", "1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A", " ", "=", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"2", "/", "Pi"}]}], ")"}], " ", "y"}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", "/", "Pi"}]}], ")"}]}], " ", "y"}], "]"}]}], 
          ")"}], "2"]}], ";", "\[IndentingNewLine]", 
       RowBox[{"B", " ", "=", " ", 
        RowBox[{
         RowBox[{"4", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"2", "/", "Pi"}], "*", "y"}], "]"}], "+", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], "/", "Pi"}], "*", "y"}], "]"}]}], ")"}]}], 
         "-", 
         RowBox[{"2", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{"-", "y"}], "]"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", "/", "Pi"}]}], ")"}], " ", "y"}], "]"}], "+", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", "/", "Pi"}]}], ")"}]}], " ", "y"}], "]"}]}], 
           ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"2", " ", "y"}], "]"}], "+", "1", "-", 
            SuperscriptBox["R", "2"]}], ")"}]}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"C", " ", "=", " ", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "2"}], " ", "y"}], "]"}], 
         RowBox[{"(", " ", 
          RowBox[{
           SuperscriptBox["R", "2"], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exp", "[", "y", "]"}], "-", "1"}], ")"}], "2"]}], 
          ")"}], 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Exp", "[", "y", "]"}], "+", "1"}], ")"}], "2"], "-", 
           SuperscriptBox["R", "2"]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"\[Beta]", " ", "=", " ", 
        FractionBox[
         RowBox[{"2", " ", "C"}], 
         RowBox[{"B", "+", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["B", "2"], "+", 
            RowBox[{"4", " ", "A", " ", "C"}]}]]}]]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Gamma]", " ", "=", " ", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["Pi", "2"]}], 
         RowBox[{"Log", "[", "\[Beta]", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"P0", " ", "=", " ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"y", "\[GreaterEqual]", " ", "0"}], ",", 
          RowBox[{"K", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "r"}], " ", "T"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "2"], "-", 
             RowBox[{
              RowBox[{"Exp", "[", "y", "]"}], " ", 
              RowBox[{"Polya", "[", 
               RowBox[{"-", 
                SqrtBox[
                 RowBox[{"2", " ", "y"}]]}], "]"}]}]}], ")"}]}], ",", 
          RowBox[{"K", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "r"}], " ", "T"}], "]"}], " ", 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"Polya", "[", 
              SqrtBox[
               RowBox[{
                RowBox[{"-", "2"}], " ", "y"}]], "]"}], "-", 
             FractionBox[
              RowBox[{"Exp", "[", "y", "]"}], "2"]}], ")"}]}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"srVol", " ", "=", " ", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"P", "\[LessEqual]", "P0"}], " ", "&&", " ", 
           RowBox[{"y", "\[GreaterEqual]", "0"}]}], ",", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["T"]], 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              RowBox[{"\[Gamma]", "+", "y"}]], "-", 
             SqrtBox[
              RowBox[{"\[Gamma]", "-", "y"}]]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"P", ">", "P0"}], " ", "&&", " ", 
           RowBox[{"y", "\[GreaterEqual]", "0"}]}], ",", " ", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["T"]], 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              RowBox[{"\[Gamma]", "+", "y"}]], "+", 
             SqrtBox[
              RowBox[{"\[Gamma]", "-", "y"}]]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"P", "\[LessEqual]", "P0"}], " ", "&&", " ", 
           RowBox[{"y", "<", "0"}]}], ",", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["T"]], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SqrtBox[
               RowBox[{"\[Gamma]", "+", "y"}]]}], "+", 
             SqrtBox[
              RowBox[{"\[Gamma]", "-", "y"}]]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"P", ">", "P0"}], " ", "&&", " ", 
           RowBox[{"y", "<", "0"}]}], ",", " ", 
          RowBox[{
           FractionBox["1", 
            SqrtBox["T"]], 
           RowBox[{"(", 
            RowBox[{
             SqrtBox[
              RowBox[{"\[Gamma]", "+", "y"}]], "+", 
             SqrtBox[
              RowBox[{"\[Gamma]", "-", "y"}]]}], ")"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
        "P", ",", "\[Beta]", ",", "\[Gamma]", ",", "y", ",", "P", ",", "P0", 
         ",", 
         RowBox[{"K", "*", " ", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "r"}], " ", "T"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "2"], "-", 
            RowBox[{
             RowBox[{"Exp", "[", "y", "]"}], "*", " ", 
             RowBox[{"Polya", "[", 
              RowBox[{"-", 
               SqrtBox[
                RowBox[{"2", "*", "y"}]]}], "]"}]}]}], ")"}]}]}], "}"}], ";", 
       "\[IndentingNewLine]", "srVol"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.719347944135799*^9, 3.719348033457231*^9}, {
   3.719348071698028*^9, 3.719348077804187*^9}, {3.719348108862328*^9, 
   3.7193483005410223`*^9}, {3.719348361136549*^9, 3.719348710053122*^9}, {
   3.7193487956058607`*^9, 3.71934886535633*^9}, {3.719348900006494*^9, 
   3.71934906312401*^9}, {3.719349209598111*^9, 3.719349250921361*^9}, {
   3.719349286494082*^9, 3.719349337577629*^9}, {3.719349439493431*^9, 
   3.719349464477057*^9}, {3.719349518494755*^9, 3.7193496769583282`*^9}, {
   3.7193499174882927`*^9, 3.7193499253002253`*^9}, {3.719350023035509*^9, 
   3.719350030899562*^9}, {3.7193501072477694`*^9, 3.719350160504587*^9}, {
   3.71935026936133*^9, 3.71935026975718*^9}, {3.719350386195776*^9, 
   3.719350389764189*^9}, {3.7193504851113987`*^9, 3.719350505560649*^9}, {
   3.7193505372288723`*^9, 3.719350543910419*^9}, 3.719350577464171*^9, {
   3.719350665961707*^9, 3.7193506929756193`*^9}, {3.719350737245367*^9, 
   3.719350836847518*^9}, {3.7193509266606407`*^9, 3.719350929698534*^9}, {
   3.719351085344459*^9, 3.719351089619339*^9}, {3.719351323350711*^9, 
   3.719351328876597*^9}, {3.71935231456317*^9, 3.7193523534157667`*^9}, {
   3.719352396236718*^9, 3.7193523981840963`*^9}, {3.719352431846108*^9, 
   3.7193524619583473`*^9}, {3.719352494742508*^9, 3.7193525247859087`*^9}, {
   3.719352707771179*^9, 3.719352726402315*^9}, {3.719352793319745*^9, 
   3.719352815371449*^9}},ExpressionUUID->"55aaaebe-cd64-4bac-885c-\
152247680c6b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SRVolPut", "[", 
  RowBox[{
  "9.354197236057226", ",", "100", ",", "1", ",", "105.12710963760242", ",", 
   "0.05"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"BSCallHandy", "[", 
  RowBox[{"100", ",", "100", ",", "1", ",", "0.05", ",", "0.3"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"SRVolCall", "[", 
  RowBox[{
   RowBox[{"BSCallHandy", "[", 
    RowBox[{"100", ",", "100", ",", "1", ",", "0.05", ",", "0.3"}], "]"}], 
   ",", "100", ",", "1", ",", "105.12710963760242", ",", "0.05"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.719349877323318*^9, 3.719349886019582*^9}, {
  3.7193504399753113`*^9, 3.719350440561933*^9}, {3.719350619568116*^9, 
  3.7193506370432243`*^9}, {3.719352594259165*^9, 
  3.719352685661861*^9}},ExpressionUUID->"996344b4-99b1-41f7-81aa-\
8ab8e83351e3"],

Cell[BoxData["0.29976192122025613`"], "Output",
 CellChangeTimes->{
  3.7193498871328773`*^9, 3.7193499322385187`*^9, {3.719350125050235*^9, 
   3.719350163146962*^9}, 3.71935027197605*^9, 3.719350397972335*^9, 
   3.7193504410696*^9, 3.7193505090199547`*^9, 3.719350547137548*^9, 
   3.7193505841675034`*^9, {3.7193506234315*^9, 3.719350637699641*^9}, 
   3.71935067272196*^9, 3.71935084237057*^9, 3.719350939206358*^9, 
   3.719351092464591*^9, 3.719351334374466*^9, {3.719352643612443*^9, 
   3.7193526864783163`*^9}, {3.7193527168595324`*^9, 
   3.7193527287574177`*^9}, {3.719352797939767*^9, 3.719352817536838*^9}, 
   3.719597125438496*^9, 3.7195991441795893`*^9, 
   3.71959954294173*^9},ExpressionUUID->"e96550ce-e36b-4586-b583-\
ce7ca19784c1"],

Cell[BoxData["14.23125478598582`"], "Output",
 CellChangeTimes->{
  3.7193498871328773`*^9, 3.7193499322385187`*^9, {3.719350125050235*^9, 
   3.719350163146962*^9}, 3.71935027197605*^9, 3.719350397972335*^9, 
   3.7193504410696*^9, 3.7193505090199547`*^9, 3.719350547137548*^9, 
   3.7193505841675034`*^9, {3.7193506234315*^9, 3.719350637699641*^9}, 
   3.71935067272196*^9, 3.71935084237057*^9, 3.719350939206358*^9, 
   3.719351092464591*^9, 3.719351334374466*^9, {3.719352643612443*^9, 
   3.7193526864783163`*^9}, {3.7193527168595324`*^9, 
   3.7193527287574177`*^9}, {3.719352797939767*^9, 3.719352817536838*^9}, 
   3.719597125438496*^9, 3.7195991441795893`*^9, 
   3.719599542946245*^9},ExpressionUUID->"77a6f811-e64b-43eb-ba5d-\
865ae512bd9a"],

Cell[BoxData["0.2997619212201`"], "Output",
 CellChangeTimes->{
  3.7193498871328773`*^9, 3.7193499322385187`*^9, {3.719350125050235*^9, 
   3.719350163146962*^9}, 3.71935027197605*^9, 3.719350397972335*^9, 
   3.7193504410696*^9, 3.7193505090199547`*^9, 3.719350547137548*^9, 
   3.7193505841675034`*^9, {3.7193506234315*^9, 3.719350637699641*^9}, 
   3.71935067272196*^9, 3.71935084237057*^9, 3.719350939206358*^9, 
   3.719351092464591*^9, 3.719351334374466*^9, {3.719352643612443*^9, 
   3.7193526864783163`*^9}, {3.7193527168595324`*^9, 
   3.7193527287574177`*^9}, {3.719352797939767*^9, 3.719352817536838*^9}, 
   3.719597125438496*^9, 3.7195991441795893`*^9, 
   3.719599542949753*^9},ExpressionUUID->"a6277c6c-d28b-4570-b4fb-\
b62ee3e7df9a"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.719352657952672*^9, 
  3.719352659415909*^9}},ExpressionUUID->"3f80c133-1da7-4d20-9cd9-\
15d5b78df942"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "100"}], ",", 
     RowBox[{"K", "=", "100"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"r", "=", "0.05"}], ",", 
     RowBox[{"\[Sigma]", "=", "0.3"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"putBS", " ", "=", " ", 
     RowBox[{"BSPutHandy", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"callBS", " ", "=", " ", 
     RowBox[{"BSCallHandy", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"F", " ", "=", " ", 
     RowBox[{"S", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"r", " ", "T"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"SRVolPut", "[", 
       RowBox[{"putBS", ",", "K", ",", "T", ",", "F", ",", "r"}], "]"}], ",", 
      RowBox[{"SRVolCall", "[", 
       RowBox[{"callBS", ",", "K", ",", "T", ",", "F", ",", "r"}], "]"}]}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.719349695276701*^9, 3.719349851616043*^9}, {
  3.71935094574964*^9, 3.719350953172802*^9}, {3.719352863943933*^9, 
  3.719352919098184*^9}},ExpressionUUID->"dee89846-2267-48a7-911a-\
fa6c351095b1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.29976192122025613`", ",", "0.2997619212201`"}], "}"}]], "Output",
 CellChangeTimes->{3.7193529194311457`*^9, 3.719597125634746*^9, 
  3.71959914433606*^9, 
  3.719599542994831*^9},ExpressionUUID->"1602dc75-9161-4ceb-aa7a-\
6ef5a22820b8"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Put option implied volatility", "Subsection",
 CellChangeTimes->{{3.7193529369400167`*^9, 
  3.7193529518841333`*^9}},ExpressionUUID->"f00c38ea-0781-4021-8621-\
261950989f65"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "targetPutPrice", ",", "estimatedPutPrice", ",", "estimatedIV", ",", 
       "fixa", ",", "fixa2", ",", "upperbound", ",", "newtonRoot", ",", "t1", 
       ",", "t2", ",", "t3"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"targetPutPrice", "=", 
       RowBox[{"BSPutHandy", "[", 
        RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"estimatedPutPrice", "=", 
       RowBox[{"BSPutTaylorExpansion", "[", 
        RowBox[{
        "S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]", ",", "a", ",", 
         "order"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"t1", " ", "=", " ", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fixa", "=", " ", 
       RowBox[{
        RowBox[{"SRVolPut", "[", 
         RowBox[{"targetPutPrice", ",", "K", ",", "T", ",", 
          RowBox[{"S", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"r", " ", "T"}], "]"}]}], ",", "r"}], "]"}], "*", 
        SqrtBox["T"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"upperbound", " ", "=", " ", 
       FractionBox["fixa", 
        SqrtBox["T"]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"estimatedIV", "=", 
       RowBox[{"InversePutIV", "[", 
        RowBox[{
        "targetPutPrice", ",", "S", ",", "K", ",", "T", ",", "r", ",", "fixa",
          ",", "order"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t2", " ", "=", " ", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fixa2", "=", " ", 
       RowBox[{
        RowBox[{"SRVolPut", "[", 
         RowBox[{"targetPutPrice", ",", "K", ",", "T", ",", 
          RowBox[{"S", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"r", " ", "T"}], "]"}]}], ",", "r"}], "]"}], "*", 
        SqrtBox["T"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"newtonRoot", " ", "=", " ", 
       RowBox[{"FindRoot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"BSPutHandy", "[", 
           RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "x"}], "]"}], 
          "\[Equal]", "targetPutPrice"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "fixa2"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"t3", " ", "=", " ", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"targetPutPrice", ",", "estimatedPutPrice"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "\[Sigma]", ",", "fixa", ",", "upperbound", ",", "estimatedIV", ",", 
          "newtonRoot"}], "}"}], ",", 
        RowBox[{"t2", "-", "t1"}], ",", 
        RowBox[{"t3", "-", "t2"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   "\"\<underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)\>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "80.", ",", "\"\<\>\""}], "}"}], ",", "0", ",", "150",
      ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<strike, K\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"K", ",", "120", ",", "\"\<\>\""}], "}"}], ",", "0", ",", "150",
      ",", "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<volatility, \[Sigma]\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", "0.3124245214", ",", "\"\<\>\""}], "}"}], ",", 
     "0.01", ",", "1", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<risk-free rate, r\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "0.05", ",", "\"\<\>\""}], "}"}], ",", "0.0", ",", 
     "0.25", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<years to maturity, T\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", "0.1", ",", "\"\<\>\""}], "}"}], ",", "0.1", ",", "3",
      ",", "0.25", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<truncated order, order\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "10", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "64", ",", "8", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<fixed point, a\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{
        RowBox[{"SRVolPut", "[", 
         RowBox[{
          RowBox[{"BSPutHandy", "[", 
           RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], 
           "]"}], ",", "K", ",", "T", ",", 
          RowBox[{"S", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"r", " ", "T"}], "]"}]}], ",", "r"}], "]"}], "*", 
        SqrtBox["T"]}], ",", "\"\<\>\""}], "}"}], ",", "0", ",", "5", ",", 
     "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.719351013315649*^9, 3.7193510613946733`*^9}, 
   3.719351217025928*^9, {3.719354370560542*^9, 3.719354375725284*^9}, {
   3.71935454680587*^9, 3.719354552180088*^9}, {3.71935464966269*^9, 
   3.719354674931552*^9}, {3.71935500981664*^9, 3.719355011362464*^9}, 
   3.719355123049823*^9, {3.7193553180239973`*^9, 3.719355330739197*^9}, {
   3.719356320313788*^9, 3.719356321233244*^9}, {3.7195992799136887`*^9, 
   3.719599371142434*^9}, {3.71959958198425*^9, 3.719599594795919*^9}, {
   3.7196023349832973`*^9, 3.719602583190143*^9}, {3.719602836291514*^9, 
   3.719602859498005*^9}, {3.7196030218781757`*^9, 3.719603024662224*^9}, {
   3.719603100732345*^9, 3.719603161471951*^9}, {3.719603279876238*^9, 
   3.719603324931612*^9}},ExpressionUUID->"fcf45a7c-c5f1-4f5e-b48a-\
5afdfdc768ae"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 0.09721456513549231, K$$ = 
    120, $CellContext`order$$ = 10, $CellContext`r$$ = 
    0.05, $CellContext`S$$ = 80., $CellContext`T$$ = 
    0.1, $CellContext`\[Sigma]$$ = 0.3124245214, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold["underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)"], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`S$$], 80., ""}, 0, 150, 1}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["strike, K"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[K$$], 120, ""}, 0, 150, 0.5}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["volatility, \[Sigma]"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Sigma]$$], 0.3124245214, ""}, 0.01, 1, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["risk-free rate, r"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`r$$], 0.05, ""}, 0., 0.25, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["years to maturity, T"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`T$$], 0.1, ""}, 0.1, 3, 0.25}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["truncated order, order"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`order$$], 10, ""}, 0, 64, 8}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["fixed point, a"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`a$$], $CellContext`T$$^Rational[1, 2] Which[
         And[$CellContext`S$$ (
            Rational[1, 2] (-1 - Erf[
              2^Rational[-1, 2] (
                Rational[-1, 2] $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                 Rational[-1, 
                   2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
            Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
             K$$ $CellContext`S$$^(-1) (1 + 
              Erf[2^Rational[-1, 2] (
                 Rational[1, 2] $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 
          If[Log[E^($CellContext`r$$ $CellContext`T$$) 
              K$$^(-1) $CellContext`S$$] >= 0, K$$ 
            Exp[(-$CellContext`r$$) $CellContext`T$$] (1/2 - 
             Exp[$CellContext`y$26563] $CellContext`Polya[-
               Sqrt[2 $CellContext`y$26563]]), K$$ 
            Exp[(-$CellContext`r$$) $CellContext`T$$] ($CellContext`Polya[
               Sqrt[(-2) $CellContext`y$26563]] - Exp[$CellContext`y$26563]/
             2)], Log[
           E^($CellContext`r$$ $CellContext`T$$) K$$^(-1) $CellContext`S$$] >= 
          0], (1/Sqrt[$CellContext`T$$]) (
          Sqrt[$CellContext`\[Gamma]$26563 + $CellContext`y$26563] - 
          Sqrt[$CellContext`\[Gamma]$26563 - $CellContext`y$26563]), 
         And[$CellContext`S$$ (
            Rational[1, 2] (-1 - Erf[
              2^Rational[-1, 2] (
                Rational[-1, 2] $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                 Rational[-1, 
                   2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
            Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
             K$$ $CellContext`S$$^(-1) (1 + 
              Erf[2^Rational[-1, 2] (
                 Rational[1, 2] $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + 
                  Log[K$$^(-1) $CellContext`S$$]))])) > \
$CellContext`P0$26563, $CellContext`y$26563 >= 0], (1/
          Sqrt[$CellContext`T$$]) (
          Sqrt[$CellContext`\[Gamma]$26563 + $CellContext`y$26563] + 
          Sqrt[$CellContext`\[Gamma]$26563 - $CellContext`y$26563]), 
         And[$CellContext`S$$ (
            Rational[1, 2] (-1 - Erf[
              2^Rational[-1, 2] (
                Rational[-1, 2] $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                 Rational[-1, 
                   2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
            Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
             K$$ $CellContext`S$$^(-1) (1 + 
              Erf[2^Rational[-1, 2] (
                 Rational[1, 2] $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + 
                  Log[K$$^(-1) $CellContext`S$$]))])) <= \
$CellContext`P0$26563, $CellContext`y$26563 < 0], (1/
          Sqrt[$CellContext`T$$]) (-
           Sqrt[$CellContext`\[Gamma]$26563 + $CellContext`y$26563] + 
          Sqrt[$CellContext`\[Gamma]$26563 - $CellContext`y$26563]), 
         And[$CellContext`S$$ (
            Rational[1, 2] (-1 - Erf[
              2^Rational[-1, 2] (
                Rational[-1, 2] $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                 Rational[-1, 
                   2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
            Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
             K$$ $CellContext`S$$^(-1) (1 + 
              Erf[2^Rational[-1, 2] (
                 Rational[1, 2] $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + 
                  Log[K$$^(-1) $CellContext`S$$]))])) > \
$CellContext`P0$26563, $CellContext`y$26563 < 0], (1/Sqrt[$CellContext`T$$]) (
          Sqrt[$CellContext`\[Gamma]$26563 + $CellContext`y$26563] + 
          Sqrt[$CellContext`\[Gamma]$26563 - $CellContext`y$26563])], ""}, 0, 
      5, 0.5}}, Typeset`size$$ = {745., {3., 9.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`S$26565$$ = 0, K$26566$$ = 
    0, $CellContext`\[Sigma]$26567$$ = 0, $CellContext`r$26568$$ = 
    0, $CellContext`T$26569$$ = 0, $CellContext`order$26570$$ = 
    0, $CellContext`a$26571$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = $CellContext`T$$^Rational[1, 2] Which[
           
           And[$CellContext`S$$ (
              Rational[1, 2] (-1 - Erf[
                2^Rational[-1, 2] (
                  Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1 + 
                Erf[2^Rational[-1, 2] (
                   Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 
            If[Log[E^($CellContext`r$$ $CellContext`T$$) 
                K$$^(-1) $CellContext`S$$] >= 0, K$$ 
              Exp[(-$CellContext`r$$) $CellContext`T$$] (1/2 - 
               Exp[$CellContext`y$26563] $CellContext`Polya[-
                 Sqrt[2 $CellContext`y$26563]]), K$$ 
              Exp[(-$CellContext`r$$) $CellContext`T$$] ($CellContext`Polya[
                 Sqrt[(-2) $CellContext`y$26563]] - Exp[$CellContext`y$26563]/
               2)], Log[
             E^($CellContext`r$$ $CellContext`T$$) K$$^(-1) $CellContext`S$$] >= 
            0], (1/Sqrt[$CellContext`T$$]) (
            Sqrt[$CellContext`\[Gamma]$26563 + $CellContext`y$26563] - 
            Sqrt[$CellContext`\[Gamma]$26563 - $CellContext`y$26563]), 
           
           And[$CellContext`S$$ (
              Rational[1, 2] (-1 - Erf[
                2^Rational[-1, 2] (
                  Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1 + 
                Erf[2^Rational[-1, 2] (
                   Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[
                    K$$^(-1) $CellContext`S$$]))])) > $CellContext`P0$26563, \
$CellContext`y$26563 >= 0], (1/Sqrt[$CellContext`T$$]) (
            Sqrt[$CellContext`\[Gamma]$26563 + $CellContext`y$26563] + 
            Sqrt[$CellContext`\[Gamma]$26563 - $CellContext`y$26563]), 
           
           And[$CellContext`S$$ (
              Rational[1, 2] (-1 - Erf[
                2^Rational[-1, 2] (
                  Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1 + 
                Erf[2^Rational[-1, 2] (
                   Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[
                    K$$^(-1) $CellContext`S$$]))])) <= $CellContext`P0$26563, \
$CellContext`y$26563 < 0], (1/
            Sqrt[$CellContext`T$$]) (-
             Sqrt[$CellContext`\[Gamma]$26563 + $CellContext`y$26563] + 
            Sqrt[$CellContext`\[Gamma]$26563 - $CellContext`y$26563]), 
           
           And[$CellContext`S$$ (
              Rational[1, 2] (-1 - Erf[
                2^Rational[-1, 2] (
                  Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1 + 
                Erf[2^Rational[-1, 2] (
                   Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[
                    K$$^(-1) $CellContext`S$$]))])) > $CellContext`P0$26563, \
$CellContext`y$26563 < 0], (1/Sqrt[$CellContext`T$$]) (
            Sqrt[$CellContext`\[Gamma]$26563 + $CellContext`y$26563] + 
            Sqrt[$CellContext`\[Gamma]$26563 - $CellContext`y$26563])], K$$ = 
        120, $CellContext`order$$ = 10, $CellContext`r$$ = 
        0.05, $CellContext`S$$ = 80., $CellContext`T$$ = 
        0.1, $CellContext`\[Sigma]$$ = 0.3124245214}, "ControllerVariables" :> {
        Hold[$CellContext`S$$, $CellContext`S$26565$$, 0], 
        Hold[K$$, K$26566$$, 0], 
        Hold[$CellContext`\[Sigma]$$, $CellContext`\[Sigma]$26567$$, 0], 
        Hold[$CellContext`r$$, $CellContext`r$26568$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$26569$$, 0], 
        Hold[$CellContext`order$$, $CellContext`order$26570$$, 0], 
        Hold[$CellContext`a$$, $CellContext`a$26571$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`targetPutPrice$, $CellContext`estimatedPutPrice$, \
$CellContext`estimatedIV$, $CellContext`fixa$, $CellContext`fixa2$, \
$CellContext`upperbound$, $CellContext`newtonRoot$, $CellContext`t1$, \
$CellContext`t2$, $CellContext`t3$}, $CellContext`targetPutPrice$ = \
$CellContext`BSPutHandy[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$]; \
$CellContext`estimatedPutPrice$ = \
$CellContext`BSPutTaylorExpansion[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$, \
$CellContext`a$$, $CellContext`order$$]; $CellContext`t1$ = 
         AbsoluteTime[]; $CellContext`fixa$ = \
$CellContext`SRVolPut[$CellContext`targetPutPrice$, 
            K$$, $CellContext`T$$, $CellContext`S$$ 
            Exp[$CellContext`r$$ $CellContext`T$$], $CellContext`r$$] 
          Sqrt[$CellContext`T$$]; $CellContext`upperbound$ = \
$CellContext`fixa$/
          Sqrt[$CellContext`T$$]; $CellContext`estimatedIV$ = \
$CellContext`InversePutIV[$CellContext`targetPutPrice$, $CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`fixa$, \
$CellContext`order$$]; $CellContext`t2$ = 
         AbsoluteTime[]; $CellContext`fixa2$ = \
$CellContext`SRVolPut[$CellContext`targetPutPrice$, 
            K$$, $CellContext`T$$, $CellContext`S$$ 
            Exp[$CellContext`r$$ $CellContext`T$$], $CellContext`r$$] 
          Sqrt[$CellContext`T$$]; $CellContext`newtonRoot$ = 
         FindRoot[$CellContext`BSPutHandy[$CellContext`S$$, 
             K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`x] == \
$CellContext`targetPutPrice$, {$CellContext`x, $CellContext`fixa2$}]; \
$CellContext`t3$ = 
         AbsoluteTime[]; {{$CellContext`targetPutPrice$, \
$CellContext`estimatedPutPrice$}, {$CellContext`\[Sigma]$$, \
$CellContext`fixa$, $CellContext`upperbound$, $CellContext`estimatedIV$, \
$CellContext`newtonRoot$}, $CellContext`t2$ - $CellContext`t1$, \
$CellContext`t3$ - $CellContext`t2$}], 
      "Specifications" :> {
       "underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)", {{$CellContext`S$$, 
          80., ""}, 0, 150, 1, Appearance -> "Labeled", ImageSize -> Tiny}, 
        "", "strike, K", {{K$$, 120, ""}, 0, 150, 0.5, Appearance -> 
         "Labeled", ImageSize -> Tiny}, "", 
        "volatility, \[Sigma]", {{$CellContext`\[Sigma]$$, 0.3124245214, ""}, 
         0.01, 1, 0.01, Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "risk-free rate, r", {{$CellContext`r$$, 0.05, ""}, 0., 0.25, 0.01, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "years to maturity, T", {{$CellContext`T$$, 0.1, ""}, 0.1, 3, 0.25, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "truncated order, order", {{$CellContext`order$$, 10, ""}, 0, 64, 8, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "fixed point, a", {{$CellContext`a$$, $CellContext`T$$^Rational[1, 2] 
          Which[
            
            And[$CellContext`S$$ (
               Rational[1, 2] (-1 - Erf[
                 2^Rational[-1, 2] (
                   Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1 + 
                 Erf[2^Rational[-1, 2] (
                    Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 
             If[Log[E^($CellContext`r$$ $CellContext`T$$) 
                 K$$^(-1) $CellContext`S$$] >= 0, K$$ 
               Exp[(-$CellContext`r$$) $CellContext`T$$] (1/2 - 
                Exp[$CellContext`y$26563] $CellContext`Polya[-
                  Sqrt[2 $CellContext`y$26563]]), K$$ 
               Exp[(-$CellContext`r$$) $CellContext`T$$] ($CellContext`Polya[
                  Sqrt[(-2) $CellContext`y$26563]] - 
                Exp[$CellContext`y$26563]/2)], 
             Log[E^($CellContext`r$$ $CellContext`T$$) 
               K$$^(-1) $CellContext`S$$] >= 0], (1/Sqrt[$CellContext`T$$]) (
             Sqrt[$CellContext`\[Gamma]$26563 + $CellContext`y$26563] - 
             Sqrt[$CellContext`\[Gamma]$26563 - $CellContext`y$26563]), 
            
            And[$CellContext`S$$ (
               Rational[1, 2] (-1 - Erf[
                 2^Rational[-1, 2] (
                   Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1 + 
                 Erf[2^Rational[-1, 2] (
                    Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[
                    K$$^(-1) $CellContext`S$$]))])) > $CellContext`P0$26563, \
$CellContext`y$26563 >= 0], (1/Sqrt[$CellContext`T$$]) (
             Sqrt[$CellContext`\[Gamma]$26563 + $CellContext`y$26563] + 
             Sqrt[$CellContext`\[Gamma]$26563 - $CellContext`y$26563]), 
            
            And[$CellContext`S$$ (
               Rational[1, 2] (-1 - Erf[
                 2^Rational[-1, 2] (
                   Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1 + 
                 Erf[2^Rational[-1, 2] (
                    Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[
                    K$$^(-1) $CellContext`S$$]))])) <= $CellContext`P0$26563, \
$CellContext`y$26563 < 0], (1/
             Sqrt[$CellContext`T$$]) (-
              Sqrt[$CellContext`\[Gamma]$26563 + $CellContext`y$26563] + 
             Sqrt[$CellContext`\[Gamma]$26563 - $CellContext`y$26563]), 
            
            And[$CellContext`S$$ (
               Rational[1, 2] (-1 - Erf[
                 2^Rational[-1, 2] (
                   Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1 + 
                 Erf[2^Rational[-1, 2] (
                    Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[
                    K$$^(-1) $CellContext`S$$]))])) > $CellContext`P0$26563, \
$CellContext`y$26563 < 0], (1/Sqrt[$CellContext`T$$]) (
             Sqrt[$CellContext`\[Gamma]$26563 + $CellContext`y$26563] + 
             Sqrt[$CellContext`\[Gamma]$26563 - $CellContext`y$26563])], ""}, 
         0, 5, 0.5, Appearance -> "Labeled", ImageSize -> Tiny}}, 
      "Options" :> {ControlPlacement -> Left}, "DefaultOptions" :> {}],
     ImageSizeCache->{928., {168., 173.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`BSPutHandy[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]]] := $CellContext`BSPut[$CellContext`S, 
         $CellContext`logForward[$CellContext`S, 
          K, $CellContext`T, $CellContext`r], 
         $CellContext`Z[$CellContext`\[Sigma], $CellContext`T]], \
$CellContext`BSPut[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          
          Blank[]]] := $CellContext`S \
(-$CellContext`normalCDF[-$CellContext`d1[$CellContext`lo, $CellContext`Z]] + 
         Exp[-$CellContext`lo] \
$CellContext`normalCDF[-$CellContext`d2[$CellContext`lo, $CellContext`Z]]), \
$CellContext`Z[
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]]] := $CellContext`\[Sigma] 
        Sqrt[$CellContext`T], $CellContext`normalCDF[
         Pattern[$CellContext`d, 
          Blank[]]] := (1/2) (1 + 
         Erf[$CellContext`d/Sqrt[2]]), $CellContext`d1[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z + $CellContext`Z/
         2, $CellContext`d2[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z - $CellContext`Z/
        2, $CellContext`logForward[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]]] := 
       Log[$CellContext`S/
          K] + $CellContext`r $CellContext`T, \
$CellContext`BSPutTaylorExpansion[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries, \
$CellContext`putPrice}, $CellContext`std = $CellContext`Z[$CellContext`\
\[Sigma], $CellContext`T]; $CellContext`mu = \
$CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSPut[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`putPrice = ReplaceAll[
            
            Normal[$CellContext`IVSeries], $CellContext`Z -> \
$CellContext`std]], $CellContext`SRVolPut[
         Pattern[$CellContext`P, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`F, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]]] := 
       Module[{$CellContext`srVol, $CellContext`y, $CellContext`R, \
$CellContext`A, $CellContext`B, 
          C, $CellContext`\[Alpha], $CellContext`\[Beta], $CellContext`\
\[Gamma], $CellContext`P0}, $CellContext`y = 
          Log[$CellContext`F/K]; $CellContext`\[Alpha] = $CellContext`P (
            Exp[$CellContext`r $CellContext`T]/K); $CellContext`R = 
          2 $CellContext`\[Alpha] + Exp[$CellContext`y] - 
           1; $CellContext`A = (Exp[(1 - 2/Pi) $CellContext`y] - 
            Exp[(-(1 - 2/Pi)) $CellContext`y])^2; $CellContext`B = 
          4 (Exp[(2/Pi) $CellContext`y] + Exp[((-2)/Pi) $CellContext`y]) - 2 
           Exp[-$CellContext`y] (Exp[(1 - 2/Pi) $CellContext`y] + 
            Exp[(-(1 - 2/Pi)) $CellContext`y]) (Exp[2 $CellContext`y] + 
            1 - $CellContext`R^2); 
         C = Exp[(-2) $CellContext`y] ($CellContext`R^2 - (
             Exp[$CellContext`y] - 
             1)^2) ((Exp[$CellContext`y] + 
              1)^2 - $CellContext`R^2); $CellContext`\[Beta] = (2 
            C)/($CellContext`B + 
           Sqrt[$CellContext`B^2 + 
             4 $CellContext`A C]); $CellContext`\[Gamma] = (-(Pi/2)) 
           Log[$CellContext`\[Beta]]; $CellContext`P0 = 
          If[$CellContext`y >= 0, K 
            Exp[(-$CellContext`r) $CellContext`T] (1/2 - 
             Exp[$CellContext`y] $CellContext`Polya[-Sqrt[2 $CellContext`y]]),
             K Exp[(-$CellContext`r) $CellContext`T] ($CellContext`Polya[
               Sqrt[(-2) $CellContext`y]] - Exp[$CellContext`y]/
             2)]; $CellContext`srVol = Which[
            
            And[$CellContext`P <= $CellContext`P0, $CellContext`y >= 0], (1/
             Sqrt[$CellContext`T]) (
             Sqrt[$CellContext`\[Gamma] + $CellContext`y] - 
             Sqrt[$CellContext`\[Gamma] - $CellContext`y]), 
            
            And[$CellContext`P > $CellContext`P0, $CellContext`y >= 0], (1/
             Sqrt[$CellContext`T]) (
             Sqrt[$CellContext`\[Gamma] + $CellContext`y] + 
             Sqrt[$CellContext`\[Gamma] - $CellContext`y]), 
            
            And[$CellContext`P <= $CellContext`P0, $CellContext`y < 0], (1/
             Sqrt[$CellContext`T]) (-
              Sqrt[$CellContext`\[Gamma] + $CellContext`y] + 
             Sqrt[$CellContext`\[Gamma] - $CellContext`y]), 
            
            And[$CellContext`P > $CellContext`P0, $CellContext`y < 0], (1/
             Sqrt[$CellContext`T]) (
             Sqrt[$CellContext`\[Gamma] + $CellContext`y] + 
             Sqrt[$CellContext`\[Gamma] - $CellContext`y])]; {$CellContext`\
\[Beta], $CellContext`\[Gamma], $CellContext`y, $CellContext`P, \
$CellContext`P0, K 
           Exp[(-$CellContext`r) $CellContext`T] (1/2 - 
            Exp[$CellContext`y] $CellContext`Polya[-
              Sqrt[2 $CellContext`y]]), $CellContext`srVol}; \
$CellContext`srVol], $CellContext`P[
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]]] := 
       Exp[$CellContext`k] \
$CellContext`A[$CellContext`k/$CellContext`\[Sigma] + $CellContext`\[Sigma]/
            2] - $CellContext`A[$CellContext`k/$CellContext`\[Sigma] + \
$CellContext`\[Sigma]/2], $CellContext`A[
         Pattern[$CellContext`x, 
          Blank[]]] := 
       1/2 + (Sign[$CellContext`x]/2) 
         Sqrt[1 - Exp[(-(2/Pi)) $CellContext`x^2]], $CellContext`F = 
       105.12710963760242`, $CellContext`Polya[
         Pattern[$CellContext`x, 
          Blank[]]] := 
       1/2 + (Sign[$CellContext`x]/2) 
         Sqrt[1 - Exp[(-(2/Pi)) $CellContext`x^2]], $CellContext`InversePutIV[
         Pattern[$CellContext`CallPrice, 
          Blank[]], 
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries, \
$CellContext`inversedIVSeries, $CellContext`impliedVol}, $CellContext`mu = \
$CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSPut[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`inversedIVSeries = 
          InverseSeries[$CellContext`IVSeries]; $CellContext`std = ReplaceAll[
            
            Normal[$CellContext`inversedIVSeries], $CellContext`Z -> \
$CellContext`CallPrice]; $CellContext`impliedVol = $CellContext`std/
           Sqrt[$CellContext`T]], 
       Attributes[$CellContext`y$26563] = {Temporary}, $CellContext`y$26563 = 
       Log[(E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/K$$], 
       Attributes[$CellContext`\[Gamma]$26563] = {
        Temporary}, $CellContext`\[Gamma]$26563 = -(Pi 
         Log[(2 K$$^2 ((
               1 + (E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$)^2 - (-1 + (
                E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
               K$$ + (2 
                E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$ ((-1 - 
                   Erf[(-(Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]])/2 + (
                   K$$ (1 + Erf[((
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]]))/(2 
                  E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)))/
               K$$)^2) (-(-1 + (
                  E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                 K$$)^2 + (-1 + (
                 E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$ + (2 
                 E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$ ((-1 - 
                    Erf[(-(Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]])/2 + (
                    K$$ (1 + Erf[((
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]]))/(2 
                   E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)))/
                K$$)^2))/(
           E^(2 $CellContext`r$$ $CellContext`T$$) $CellContext`S$$^2 (
            4 (((E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$)^((-2)/
                Pi) + ((
                 E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$)^(2/Pi)) - (2 
             K$$ (((E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$)^(1 - 2/
                Pi) + ((
                 E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$)^(-1 + 2/Pi)) (
              1 + (E^(2 $CellContext`r$$ $CellContext`T$$) \
$CellContext`S$$^2)/
               K$$^2 - (-1 + (
                 E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$ + (2 
                 E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$ ((-1 - 
                    Erf[(-(Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]])/
                   2 + (K$$ (1 + 
                    Erf[((Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]]))/(2 
                   E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)))/
                K$$)^2))/(
            E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$) + 
            Sqrt[(4 K$$^2 (((
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$)^(1 - 2/Pi) - ((
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                   K$$)^(-1 + 2/Pi))^2 ((
                   1 + (E^($CellContext`r$$ $CellContext`T$$) \
$CellContext`S$$)/K$$)^2 - (-1 + (
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                   K$$ + (2 
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$ \
((-1 - Erf[(-(Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]])/2 + (
                    K$$ (1 + Erf[((
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]]))/(2 
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)))/
                   K$$)^2) (-(-1 + (
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$)^2 + (-1 + (
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$ + (2 
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$ \
((-1 - Erf[(-(Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]])/2 + (
                    K$$ (1 + Erf[((
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]]))/(2 
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)))/
                    K$$)^2))/(
               E^(2 $CellContext`r$$ $CellContext`T$$) $CellContext`S$$^2) + (
                4 (((E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$)^((-2)/
                    Pi) + ((
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$)^(2/Pi)) - (2 
                 K$$ (((E^($CellContext`r$$ $CellContext`T$$) \
$CellContext`S$$)/K$$)^(1 - 2/
                    Pi) + ((
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$)^(-1 + 2/Pi)) (
                  1 + (E^(
                    2 $CellContext`r$$ $CellContext`T$$) $CellContext`S$$^2)/
                   K$$^2 - (-1 + (
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$ + (2 
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$ \
((-1 - Erf[(-(Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]])/2 + (
                    K$$ (1 + Erf[((
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]]))/(2 
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)))/
                    K$$)^2))/(
                E^($CellContext`r$$ $CellContext`T$$) \
$CellContext`S$$))^2]))])/2, 
       Attributes[$CellContext`P0$26563] = {Temporary}, $CellContext`P0$26563 = 
       If[Log[(E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/K$$] >= 
         0, K$$ Exp[(-$CellContext`r$$) $CellContext`T$$] (1/2 - 
          Exp[$CellContext`y$26563] $CellContext`Polya[-
            Sqrt[2 $CellContext`y$26563]]), K$$ 
         Exp[(-$CellContext`r$$) $CellContext`T$$] ($CellContext`Polya[
            Sqrt[(-2) $CellContext`y$26563]] - Exp[$CellContext`y$26563]/2)]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.71960286067775*^9, 3.719602968394055*^9, 3.719603025530138*^9, {
   3.719603101686261*^9, 3.719603162042346*^9}, {3.7196032806992817`*^9, 
   3.7196032847154818`*^9}, {3.719603314827915*^9, 
   3.719603325832387*^9}},ExpressionUUID->"ebb667d2-802b-475c-ae7b-\
0fec219431b8"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Call option implied volatility", "Subsection",
 CellChangeTimes->{{3.719352963273788*^9, 
  3.719352969417973*^9}},ExpressionUUID->"4d3d4d40-d83a-45a1-9fbb-\
398475356cfc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "targetCallPrice", ",", "targetPutPrice2", ",", "targetPutPrice", ",", 
       " ", "estimatedPutPrice", ",", "estimatedIV", ",", "fixa", ",", 
       "upperbound", ",", "F", ",", "t1", ",", "t2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t1", "=", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"targetCallPrice", "=", 
       RowBox[{"BSCallHandy", "[", 
        RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"targetPutPrice2", "=", 
       RowBox[{"BSPutHandy", "[", 
        RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}]}],
       ";", "\[IndentingNewLine]", " ", 
      RowBox[{"estimatedPutPrice", "=", 
       RowBox[{"BSPutTaylorExpansion", "[", 
        RowBox[{
        "S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]", ",", "a", ",", 
         "order"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"F", " ", "=", " ", 
       RowBox[{"S", " ", 
        RowBox[{"Exp", "[", 
         RowBox[{"r", " ", "T"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"targetPutPrice", " ", "=", " ", 
       RowBox[{"targetCallPrice", "-", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "r"}], " ", "T"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"F", "-", "K"}], ")"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fixa", "=", " ", 
       RowBox[{
        RowBox[{"SRVolCall", "[", 
         RowBox[{"targetCallPrice", ",", "K", ",", "T", ",", 
          RowBox[{"S", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"r", " ", "T"}], "]"}]}], ",", "r"}], "]"}], "*", 
        SqrtBox["T"]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"upperbound", " ", "=", " ", 
       FractionBox["fixa", 
        SqrtBox["T"]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"estimatedIV", "=", 
       RowBox[{"InversePutIV", "[", 
        RowBox[{
        "targetPutPrice", ",", "S", ",", "K", ",", "T", ",", "r", ",", "fixa",
          ",", "order"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"t2", " ", "=", " ", 
       RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "targetCallPrice", ",", "targetPutPrice", ",", "targetPutPrice2", 
          ",", "estimatedPutPrice"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]", ",", "upperbound", ",", "estimatedIV"}], "}"}], 
        ",", 
        RowBox[{"t2", "-", "t1"}]}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   "\"\<underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)\>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "100.", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "150", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<strike, K\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"K", ",", "100", ",", "\"\<\>\""}], "}"}], ",", "0", ",", "150",
      ",", "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<volatility, \[Sigma]\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", "0.3", ",", "\"\<\>\""}], "}"}], ",", "0.01", 
     ",", "1", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<risk-free rate, r\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "0.05", ",", "\"\<\>\""}], "}"}], ",", "0.0", ",", 
     "0.25", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<years to maturity, T\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "0.1", ",", "3", 
     ",", "0.25", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<truncated order, order\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "10", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "64", ",", "8", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<fixed point, a\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{
        RowBox[{"SRVolPut", "[", 
         RowBox[{
          RowBox[{"BSPutHandy", "[", 
           RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], 
           "]"}], ",", "K", ",", "T", ",", 
          RowBox[{"S", " ", 
           RowBox[{"Exp", "[", 
            RowBox[{"r", " ", "T"}], "]"}]}], ",", "r"}], "]"}], "*", 
        SqrtBox["T"]}], ",", "\"\<\>\""}], "}"}], ",", "0", ",", "5", ",", 
     "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.719352985574544*^9, 3.719353078280504*^9}, {
  3.7193531364922457`*^9, 3.719353240436433*^9}, {3.7193532820198383`*^9, 
  3.719353382098756*^9}, {3.7193546908201*^9, 3.7193547125881147`*^9}, {
  3.719355046171446*^9, 3.7193550468516817`*^9}, {3.719596983531098*^9, 
  3.719597096750547*^9}, {3.719599348498074*^9, 3.719599351604351*^9}, {
  3.7195996112127132`*^9, 
  3.719599619288596*^9}},ExpressionUUID->"6aad2cf8-4410-4a66-a990-\
2b569cc6a6ba"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 0.2997619212201755, K$$ = 
    100, $CellContext`order$$ = 60, $CellContext`r$$ = 
    0.05, $CellContext`S$$ = 100., $CellContext`T$$ = 
    1, $CellContext`\[Sigma]$$ = 0.3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold["underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)"], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`S$$], 100., ""}, 0, 150, 1}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["strike, K"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[K$$], 100, ""}, 0, 150, 0.5}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["volatility, \[Sigma]"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Sigma]$$], 0.3, ""}, 0.01, 1, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["risk-free rate, r"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`r$$], 0.05, ""}, 0., 0.25, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["years to maturity, T"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`T$$], 1, ""}, 0.1, 3, 0.25}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["truncated order, order"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`order$$], 10, ""}, 0, 64, 8}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["fixed point, a"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`a$$], $CellContext`T$$^Rational[1, 2] Which[
         And[$CellContext`S$$ (
            Rational[1, 2] (-1 - Erf[
              2^Rational[-1, 2] (
                Rational[-1, 2] $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                 Rational[-1, 
                   2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
            Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
             K$$ $CellContext`S$$^(-1) (1 + 
              Erf[2^Rational[-1, 2] (
                 Rational[1, 2] $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 
          If[Log[E^($CellContext`r$$ $CellContext`T$$) 
              K$$^(-1) $CellContext`S$$] >= 0, K$$ 
            Exp[(-$CellContext`r$$) $CellContext`T$$] (1/2 - 
             Exp[$CellContext`y$12862] $CellContext`Polya[-
               Sqrt[2 $CellContext`y$12862]]), K$$ 
            Exp[(-$CellContext`r$$) $CellContext`T$$] ($CellContext`Polya[
               Sqrt[(-2) $CellContext`y$12862]] - Exp[$CellContext`y$12862]/
             2)], Log[
           E^($CellContext`r$$ $CellContext`T$$) K$$^(-1) $CellContext`S$$] >= 
          0], (1/Sqrt[$CellContext`T$$]) (
          Sqrt[$CellContext`\[Gamma]$12862 + $CellContext`y$12862] - 
          Sqrt[$CellContext`\[Gamma]$12862 - $CellContext`y$12862]), 
         And[$CellContext`S$$ (
            Rational[1, 2] (-1 - Erf[
              2^Rational[-1, 2] (
                Rational[-1, 2] $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                 Rational[-1, 
                   2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
            Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
             K$$ $CellContext`S$$^(-1) (1 + 
              Erf[2^Rational[-1, 2] (
                 Rational[1, 2] $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + 
                  Log[K$$^(-1) $CellContext`S$$]))])) > \
$CellContext`P0$12862, $CellContext`y$12862 >= 0], (1/
          Sqrt[$CellContext`T$$]) (
          Sqrt[$CellContext`\[Gamma]$12862 + $CellContext`y$12862] + 
          Sqrt[$CellContext`\[Gamma]$12862 - $CellContext`y$12862]), 
         And[$CellContext`S$$ (
            Rational[1, 2] (-1 - Erf[
              2^Rational[-1, 2] (
                Rational[-1, 2] $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                 Rational[-1, 
                   2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
            Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
             K$$ $CellContext`S$$^(-1) (1 + 
              Erf[2^Rational[-1, 2] (
                 Rational[1, 2] $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + 
                  Log[K$$^(-1) $CellContext`S$$]))])) <= \
$CellContext`P0$12862, $CellContext`y$12862 < 0], (1/
          Sqrt[$CellContext`T$$]) (-
           Sqrt[$CellContext`\[Gamma]$12862 + $CellContext`y$12862] + 
          Sqrt[$CellContext`\[Gamma]$12862 - $CellContext`y$12862]), 
         And[$CellContext`S$$ (
            Rational[1, 2] (-1 - Erf[
              2^Rational[-1, 2] (
                Rational[-1, 2] $CellContext`T$$^
                  Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                 Rational[-1, 
                   2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
            Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
             K$$ $CellContext`S$$^(-1) (1 + 
              Erf[2^Rational[-1, 2] (
                 Rational[1, 2] $CellContext`T$$^
                   Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                  Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + 
                  Log[K$$^(-1) $CellContext`S$$]))])) > \
$CellContext`P0$12862, $CellContext`y$12862 < 0], (1/Sqrt[$CellContext`T$$]) (
          Sqrt[$CellContext`\[Gamma]$12862 + $CellContext`y$12862] + 
          Sqrt[$CellContext`\[Gamma]$12862 - $CellContext`y$12862])], ""}, 0, 
      5, 0.5}}, Typeset`size$$ = {505., {3., 9.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    False, $CellContext`S$12865$$ = 0, K$12866$$ = 
    0, $CellContext`\[Sigma]$12867$$ = 0, $CellContext`r$12868$$ = 
    0, $CellContext`T$12869$$ = 0, $CellContext`order$12870$$ = 
    0, $CellContext`a$12871$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = $CellContext`T$$^Rational[1, 2] Which[
           
           And[$CellContext`S$$ (
              Rational[1, 2] (-1 - Erf[
                2^Rational[-1, 2] (
                  Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1 + 
                Erf[2^Rational[-1, 2] (
                   Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 
            If[Log[E^($CellContext`r$$ $CellContext`T$$) 
                K$$^(-1) $CellContext`S$$] >= 0, K$$ 
              Exp[(-$CellContext`r$$) $CellContext`T$$] (1/2 - 
               Exp[$CellContext`y$12862] $CellContext`Polya[-
                 Sqrt[2 $CellContext`y$12862]]), K$$ 
              Exp[(-$CellContext`r$$) $CellContext`T$$] ($CellContext`Polya[
                 Sqrt[(-2) $CellContext`y$12862]] - Exp[$CellContext`y$12862]/
               2)], Log[
             E^($CellContext`r$$ $CellContext`T$$) K$$^(-1) $CellContext`S$$] >= 
            0], (1/Sqrt[$CellContext`T$$]) (
            Sqrt[$CellContext`\[Gamma]$12862 + $CellContext`y$12862] - 
            Sqrt[$CellContext`\[Gamma]$12862 - $CellContext`y$12862]), 
           
           And[$CellContext`S$$ (
              Rational[1, 2] (-1 - Erf[
                2^Rational[-1, 2] (
                  Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1 + 
                Erf[2^Rational[-1, 2] (
                   Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[
                    K$$^(-1) $CellContext`S$$]))])) > $CellContext`P0$12862, \
$CellContext`y$12862 >= 0], (1/Sqrt[$CellContext`T$$]) (
            Sqrt[$CellContext`\[Gamma]$12862 + $CellContext`y$12862] + 
            Sqrt[$CellContext`\[Gamma]$12862 - $CellContext`y$12862]), 
           
           And[$CellContext`S$$ (
              Rational[1, 2] (-1 - Erf[
                2^Rational[-1, 2] (
                  Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1 + 
                Erf[2^Rational[-1, 2] (
                   Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[
                    K$$^(-1) $CellContext`S$$]))])) <= $CellContext`P0$12862, \
$CellContext`y$12862 < 0], (1/
            Sqrt[$CellContext`T$$]) (-
             Sqrt[$CellContext`\[Gamma]$12862 + $CellContext`y$12862] + 
            Sqrt[$CellContext`\[Gamma]$12862 - $CellContext`y$12862]), 
           
           And[$CellContext`S$$ (
              Rational[1, 2] (-1 - Erf[
                2^Rational[-1, 2] (
                  Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                   Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
              Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
               K$$ $CellContext`S$$^(-1) (1 + 
                Erf[2^Rational[-1, 2] (
                   Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[
                    K$$^(-1) $CellContext`S$$]))])) > $CellContext`P0$12862, \
$CellContext`y$12862 < 0], (1/Sqrt[$CellContext`T$$]) (
            Sqrt[$CellContext`\[Gamma]$12862 + $CellContext`y$12862] + 
            Sqrt[$CellContext`\[Gamma]$12862 - $CellContext`y$12862])], K$$ = 
        100, $CellContext`order$$ = 10, $CellContext`r$$ = 
        0.05, $CellContext`S$$ = 100., $CellContext`T$$ = 
        1, $CellContext`\[Sigma]$$ = 0.3}, "ControllerVariables" :> {
        Hold[$CellContext`S$$, $CellContext`S$12865$$, 0], 
        Hold[K$$, K$12866$$, 0], 
        Hold[$CellContext`\[Sigma]$$, $CellContext`\[Sigma]$12867$$, 0], 
        Hold[$CellContext`r$$, $CellContext`r$12868$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$12869$$, 0], 
        Hold[$CellContext`order$$, $CellContext`order$12870$$, 0], 
        Hold[$CellContext`a$$, $CellContext`a$12871$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`targetCallPrice$, $CellContext`targetPutPrice2$, \
$CellContext`targetPutPrice$, $CellContext`estimatedPutPrice$, \
$CellContext`estimatedIV$, $CellContext`fixa$, $CellContext`upperbound$, \
$CellContext`F$, $CellContext`t1$, $CellContext`t2$}, $CellContext`t1$ = 
         AbsoluteTime[]; $CellContext`targetCallPrice$ = \
$CellContext`BSCallHandy[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$]; \
$CellContext`targetPutPrice2$ = $CellContext`BSPutHandy[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$]; \
$CellContext`estimatedPutPrice$ = \
$CellContext`BSPutTaylorExpansion[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$, \
$CellContext`a$$, $CellContext`order$$]; $CellContext`F$ = $CellContext`S$$ 
          Exp[$CellContext`r$$ $CellContext`T$$]; \
$CellContext`targetPutPrice$ = $CellContext`targetCallPrice$ - 
          Exp[(-$CellContext`r$$) $CellContext`T$$] ($CellContext`F$ - 
           K$$); $CellContext`fixa$ = \
$CellContext`SRVolCall[$CellContext`targetCallPrice$, 
            K$$, $CellContext`T$$, $CellContext`S$$ 
            Exp[$CellContext`r$$ $CellContext`T$$], $CellContext`r$$] 
          Sqrt[$CellContext`T$$]; $CellContext`upperbound$ = \
$CellContext`fixa$/
          Sqrt[$CellContext`T$$]; $CellContext`estimatedIV$ = \
$CellContext`InversePutIV[$CellContext`targetPutPrice$, $CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`fixa$, \
$CellContext`order$$]; $CellContext`t2$ = 
         AbsoluteTime[]; {{$CellContext`targetCallPrice$, \
$CellContext`targetPutPrice$, $CellContext`targetPutPrice2$, \
$CellContext`estimatedPutPrice$}, {$CellContext`\[Sigma]$$, \
$CellContext`upperbound$, $CellContext`estimatedIV$}, $CellContext`t2$ - \
$CellContext`t1$}], 
      "Specifications" :> {
       "underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)", {{$CellContext`S$$, 
          100., ""}, 0, 150, 1, Appearance -> "Labeled", ImageSize -> Tiny}, 
        "", "strike, K", {{K$$, 100, ""}, 0, 150, 0.5, Appearance -> 
         "Labeled", ImageSize -> Tiny}, "", 
        "volatility, \[Sigma]", {{$CellContext`\[Sigma]$$, 0.3, ""}, 0.01, 1, 
         0.01, Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "risk-free rate, r", {{$CellContext`r$$, 0.05, ""}, 0., 0.25, 0.01, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "years to maturity, T", {{$CellContext`T$$, 1, ""}, 0.1, 3, 0.25, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "truncated order, order", {{$CellContext`order$$, 10, ""}, 0, 64, 8, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "fixed point, a", {{$CellContext`a$$, $CellContext`T$$^Rational[1, 2] 
          Which[
            
            And[$CellContext`S$$ (
               Rational[1, 2] (-1 - Erf[
                 2^Rational[-1, 2] (
                   Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1 + 
                 Erf[2^Rational[-1, 2] (
                    Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))])) <= 
             If[Log[E^($CellContext`r$$ $CellContext`T$$) 
                 K$$^(-1) $CellContext`S$$] >= 0, K$$ 
               Exp[(-$CellContext`r$$) $CellContext`T$$] (1/2 - 
                Exp[$CellContext`y$12862] $CellContext`Polya[-
                  Sqrt[2 $CellContext`y$12862]]), K$$ 
               Exp[(-$CellContext`r$$) $CellContext`T$$] ($CellContext`Polya[
                  Sqrt[(-2) $CellContext`y$12862]] - 
                Exp[$CellContext`y$12862]/2)], 
             Log[E^($CellContext`r$$ $CellContext`T$$) 
               K$$^(-1) $CellContext`S$$] >= 0], (1/Sqrt[$CellContext`T$$]) (
             Sqrt[$CellContext`\[Gamma]$12862 + $CellContext`y$12862] - 
             Sqrt[$CellContext`\[Gamma]$12862 - $CellContext`y$12862]), 
            
            And[$CellContext`S$$ (
               Rational[1, 2] (-1 - Erf[
                 2^Rational[-1, 2] (
                   Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1 + 
                 Erf[2^Rational[-1, 2] (
                    Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[
                    K$$^(-1) $CellContext`S$$]))])) > $CellContext`P0$12862, \
$CellContext`y$12862 >= 0], (1/Sqrt[$CellContext`T$$]) (
             Sqrt[$CellContext`\[Gamma]$12862 + $CellContext`y$12862] + 
             Sqrt[$CellContext`\[Gamma]$12862 - $CellContext`y$12862]), 
            
            And[$CellContext`S$$ (
               Rational[1, 2] (-1 - Erf[
                 2^Rational[-1, 2] (
                   Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1 + 
                 Erf[2^Rational[-1, 2] (
                    Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[
                    K$$^(-1) $CellContext`S$$]))])) <= $CellContext`P0$12862, \
$CellContext`y$12862 < 0], (1/
             Sqrt[$CellContext`T$$]) (-
              Sqrt[$CellContext`\[Gamma]$12862 + $CellContext`y$12862] + 
             Sqrt[$CellContext`\[Gamma]$12862 - $CellContext`y$12862]), 
            
            And[$CellContext`S$$ (
               Rational[1, 2] (-1 - Erf[
                 2^Rational[-1, 2] (
                   Rational[-1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[K$$^(-1) $CellContext`S$$]))]) + 
               Rational[1, 2] E^(-$CellContext`r$$ $CellContext`T$$) 
                K$$ $CellContext`S$$^(-1) (1 + 
                 Erf[2^Rational[-1, 2] (
                    Rational[1, 2] $CellContext`T$$^
                    Rational[1, 2] $CellContext`\[Sigma]$$ - $CellContext`T$$^
                    Rational[-1, 
                    2] $CellContext`\[Sigma]$$^(-1) ($CellContext`r$$ \
$CellContext`T$$ + Log[
                    K$$^(-1) $CellContext`S$$]))])) > $CellContext`P0$12862, \
$CellContext`y$12862 < 0], (1/Sqrt[$CellContext`T$$]) (
             Sqrt[$CellContext`\[Gamma]$12862 + $CellContext`y$12862] + 
             Sqrt[$CellContext`\[Gamma]$12862 - $CellContext`y$12862])], ""}, 
         0, 5, 0.5, Appearance -> "Labeled", ImageSize -> Tiny}}, 
      "Options" :> {ControlPlacement -> Left}, "DefaultOptions" :> {}],
     ImageSizeCache->{757., {176., 182.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`F = 
       105.12710963760242`, $CellContext`BSCallHandy[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]]] := $CellContext`BSCall[$CellContext`S, 
         $CellContext`logForward[$CellContext`S, 
          K, $CellContext`T, $CellContext`r], 
         $CellContext`Z[$CellContext`\[Sigma], $CellContext`T]], \
$CellContext`BSCall[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`S ($CellContext`normalCDF[
           $CellContext`d1[$CellContext`lo, $CellContext`Z]] - 
         Exp[-$CellContext`lo] $CellContext`normalCDF[
           $CellContext`d2[$CellContext`lo, $CellContext`Z]]), $CellContext`Z[
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]]] := $CellContext`\[Sigma] 
        Sqrt[$CellContext`T], $CellContext`normalCDF[
         Pattern[$CellContext`d, 
          Blank[]]] := (1/2) (1 + 
         Erf[$CellContext`d/Sqrt[2]]), $CellContext`d1[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z + $CellContext`Z/
         2, $CellContext`d2[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z - $CellContext`Z/
        2, $CellContext`logForward[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]]] := 
       Log[$CellContext`S/
          K] + $CellContext`r $CellContext`T, $CellContext`BSPutHandy[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]]] := $CellContext`BSPut[$CellContext`S, 
         $CellContext`logForward[$CellContext`S, 
          K, $CellContext`T, $CellContext`r], 
         $CellContext`Z[$CellContext`\[Sigma], $CellContext`T]], \
$CellContext`BSPut[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          
          Blank[]]] := $CellContext`S \
(-$CellContext`normalCDF[-$CellContext`d1[$CellContext`lo, $CellContext`Z]] + 
         Exp[-$CellContext`lo] \
$CellContext`normalCDF[-$CellContext`d2[$CellContext`lo, $CellContext`Z]]), \
$CellContext`BSPutTaylorExpansion[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries, \
$CellContext`putPrice}, $CellContext`std = $CellContext`Z[$CellContext`\
\[Sigma], $CellContext`T]; $CellContext`mu = \
$CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSPut[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`putPrice = ReplaceAll[
            
            Normal[$CellContext`IVSeries], $CellContext`Z -> \
$CellContext`std]], $CellContext`SRVolCall[
         Pattern[$CellContext`Call, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`F, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]]] := 
       Module[{$CellContext`srVol, $CellContext`y, $CellContext`R, \
$CellContext`A, $CellContext`B, 
          C, $CellContext`\[Alpha], $CellContext`\[Beta], $CellContext`\
\[Gamma], $CellContext`P, $CellContext`P0}, $CellContext`P = \
$CellContext`Call - 
           Exp[(-$CellContext`r) $CellContext`T] ($CellContext`F - 
            K); $CellContext`y = 
          Log[$CellContext`F/K]; $CellContext`\[Alpha] = $CellContext`P (
            Exp[$CellContext`r $CellContext`T]/K); $CellContext`R = 
          2 $CellContext`\[Alpha] + Exp[$CellContext`y] - 
           1; $CellContext`A = (Exp[(1 - 2/Pi) $CellContext`y] - 
            Exp[(-(1 - 2/Pi)) $CellContext`y])^2; $CellContext`B = 
          4 (Exp[(2/Pi) $CellContext`y] + Exp[((-2)/Pi) $CellContext`y]) - 2 
           Exp[-$CellContext`y] (Exp[(1 - 2/Pi) $CellContext`y] + 
            Exp[(-(1 - 2/Pi)) $CellContext`y]) (Exp[2 $CellContext`y] + 
            1 - $CellContext`R^2); 
         C = Exp[(-2) $CellContext`y] ($CellContext`R^2 - (
             Exp[$CellContext`y] - 
             1)^2) ((Exp[$CellContext`y] + 
              1)^2 - $CellContext`R^2); $CellContext`\[Beta] = (2 
            C)/($CellContext`B + 
           Sqrt[$CellContext`B^2 + 
             4 $CellContext`A C]); $CellContext`\[Gamma] = (-(Pi/2)) 
           Log[$CellContext`\[Beta]]; $CellContext`P0 = 
          If[$CellContext`y >= 0, K 
            Exp[(-$CellContext`r) $CellContext`T] (1/2 - 
             Exp[$CellContext`y] $CellContext`Polya[-Sqrt[2 $CellContext`y]]),
             K Exp[(-$CellContext`r) $CellContext`T] ($CellContext`Polya[
               Sqrt[(-2) $CellContext`y]] - Exp[$CellContext`y]/
             2)]; $CellContext`srVol = Which[
            
            And[$CellContext`P <= $CellContext`P0, $CellContext`y >= 0], (1/
             Sqrt[$CellContext`T]) (
             Sqrt[$CellContext`\[Gamma] + $CellContext`y] - 
             Sqrt[$CellContext`\[Gamma] - $CellContext`y]), 
            
            And[$CellContext`P > $CellContext`P0, $CellContext`y >= 0], (1/
             Sqrt[$CellContext`T]) (
             Sqrt[$CellContext`\[Gamma] + $CellContext`y] + 
             Sqrt[$CellContext`\[Gamma] - $CellContext`y]), 
            
            And[$CellContext`P <= $CellContext`P0, $CellContext`y < 0], (1/
             Sqrt[$CellContext`T]) (-
              Sqrt[$CellContext`\[Gamma] + $CellContext`y] + 
             Sqrt[$CellContext`\[Gamma] - $CellContext`y]), 
            
            And[$CellContext`P > $CellContext`P0, $CellContext`y < 0], (1/
             Sqrt[$CellContext`T]) (
             Sqrt[$CellContext`\[Gamma] + $CellContext`y] + 
             Sqrt[$CellContext`\[Gamma] - $CellContext`y])]; {$CellContext`P, \
$CellContext`\[Beta], $CellContext`\[Gamma], $CellContext`y, $CellContext`P, \
$CellContext`P0, K 
           Exp[(-$CellContext`r) $CellContext`T] (1/2 - 
            Exp[$CellContext`y] $CellContext`Polya[-
              Sqrt[2 $CellContext`y]])}; $CellContext`srVol], $CellContext`A[
         Pattern[$CellContext`x, 
          Blank[]]] := 
       1/2 + (Sign[$CellContext`x]/2) 
         Sqrt[1 - Exp[(-(2/Pi)) $CellContext`x^2]], $CellContext`P[
         Pattern[$CellContext`k, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]]] := 
       Exp[$CellContext`k] \
$CellContext`A[$CellContext`k/$CellContext`\[Sigma] + $CellContext`\[Sigma]/
            2] - $CellContext`A[$CellContext`k/$CellContext`\[Sigma] + \
$CellContext`\[Sigma]/2], $CellContext`Polya[
         Pattern[$CellContext`x, 
          Blank[]]] := 
       1/2 + (Sign[$CellContext`x]/2) 
         Sqrt[1 - Exp[(-(2/Pi)) $CellContext`x^2]], $CellContext`InversePutIV[
         Pattern[$CellContext`CallPrice, 
          Blank[]], 
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries, \
$CellContext`inversedIVSeries, $CellContext`impliedVol}, $CellContext`mu = \
$CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSPut[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`inversedIVSeries = 
          InverseSeries[$CellContext`IVSeries]; $CellContext`std = ReplaceAll[
            
            Normal[$CellContext`inversedIVSeries], $CellContext`Z -> \
$CellContext`CallPrice]; $CellContext`impliedVol = $CellContext`std/
           Sqrt[$CellContext`T]], 
       Attributes[$CellContext`y$12862] = {Temporary}, $CellContext`y$12862 = 
       Log[(E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/K$$], 
       Attributes[$CellContext`\[Gamma]$12862] = {
        Temporary}, $CellContext`\[Gamma]$12862 = -(Pi 
         Log[(2 K$$^2 ((
               1 + (E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$)^2 - (-1 + (
                E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
               K$$ + (2 
                E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$ ((-1 - 
                   Erf[(-(Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]])/2 + (
                   K$$ (1 + Erf[((
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]]))/(2 
                  E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)))/
               K$$)^2) (-(-1 + (
                  E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                 K$$)^2 + (-1 + (
                 E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$ + (2 
                 E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$ ((-1 - 
                    Erf[(-(Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]])/2 + (
                    K$$ (1 + Erf[((
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]]))/(2 
                   E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)))/
                K$$)^2))/(
           E^(2 $CellContext`r$$ $CellContext`T$$) $CellContext`S$$^2 (
            4 (((E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$)^((-2)/
                Pi) + ((
                 E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$)^(2/Pi)) - (2 
             K$$ (((E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$)^(1 - 2/
                Pi) + ((
                 E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$)^(-1 + 2/Pi)) (
              1 + (E^(2 $CellContext`r$$ $CellContext`T$$) \
$CellContext`S$$^2)/
               K$$^2 - (-1 + (
                 E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                K$$ + (2 
                 E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$ ((-1 - 
                    Erf[(-(Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]])/2 + (
                    K$$ (1 + Erf[((
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]]))/(2 
                   E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)))/
                K$$)^2))/(
            E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$) + 
            Sqrt[(4 K$$^2 (((
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$)^(1 - 2/Pi) - ((
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                   K$$)^(-1 + 2/Pi))^2 ((
                   1 + (E^($CellContext`r$$ $CellContext`T$$) \
$CellContext`S$$)/K$$)^2 - (-1 + (
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                   K$$ + (2 
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$ \
((-1 - Erf[(-(Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]])/2 + (
                    K$$ (1 + Erf[((
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]]))/(2 
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)))/
                   K$$)^2) (-(-1 + (
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$)^2 + (-1 + (
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$ + (2 
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$ \
((-1 - Erf[(-(Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]])/2 + (
                    K$$ (1 + Erf[((
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]]))/(2 
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)))/
                    K$$)^2))/(
               E^(2 $CellContext`r$$ $CellContext`T$$) $CellContext`S$$^2) + (
                4 (((E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$)^((-2)/
                    Pi) + ((
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$)^(2/Pi)) - (2 
                 K$$ (((E^($CellContext`r$$ $CellContext`T$$) \
$CellContext`S$$)/K$$)^(1 - 2/
                    Pi) + ((
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$)^(-1 + 2/Pi)) (
                  1 + (E^(
                    2 $CellContext`r$$ $CellContext`T$$) $CellContext`S$$^2)/
                   K$$^2 - (-1 + (
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/
                    K$$ + (2 
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$ \
((-1 - Erf[(-(Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]])/2 + (
                    K$$ (1 + Erf[((
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$)/
                    2 - ($CellContext`r$$ $CellContext`T$$ + 
                    Log[$CellContext`S$$/K$$])/(
                    Sqrt[$CellContext`T$$] $CellContext`\[Sigma]$$))/Sqrt[
                    2]]))/(2 
                    E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)))/
                    K$$)^2))/(
                E^($CellContext`r$$ $CellContext`T$$) \
$CellContext`S$$))^2]))])/2, 
       Attributes[$CellContext`P0$12862] = {Temporary}, $CellContext`P0$12862 = 
       If[Log[(E^($CellContext`r$$ $CellContext`T$$) $CellContext`S$$)/K$$] >= 
         0, K$$ Exp[(-$CellContext`r$$) $CellContext`T$$] (1/2 - 
          Exp[$CellContext`y$12862] $CellContext`Polya[-
            Sqrt[2 $CellContext`y$12862]]), K$$ 
         Exp[(-$CellContext`r$$) $CellContext`T$$] ($CellContext`Polya[
            Sqrt[(-2) $CellContext`y$12862]] - Exp[$CellContext`y$12862]/2)]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.719353385088131*^9, 3.719354713428421*^9, 3.719355047612715*^9, 
   3.719355195530828*^9, {3.719597099580229*^9, 3.719597126314396*^9}, 
   3.719599145015633*^9, 3.719599381125041*^9, 3.719599444260023*^9, 
   3.719599543341682*^9, 
   3.719599620177083*^9},ExpressionUUID->"0b0a4122-8e4b-490d-b3ff-\
bc4afad54ea5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Dupire\[CloseCurlyQuote]s Local Volatility\:ff08Maybe a ",
 Cell[BoxData[
  FormBox[
   FractionBox["0", "0"], TraditionalForm]], "Section",
  FormatType->"TraditionalForm",ExpressionUUID->
  "6adc2949-f803-4052-881b-c3db2c320a5a"],
 " form\:ff09"
}], "Section",
 CellChangeTimes->{{3.7192483391359453`*^9, 3.7192483559768696`*^9}, {
  3.719351503336677*^9, 
  3.719351534864781*^9}},ExpressionUUID->"b6a27b39-5257-42e3-92f2-\
97689bff62e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CallImpliedVariance", "[", 
   RowBox[{
   "CallPrice_", ",", "S_", ",", "logForward_", ",", "a_", ",", "nOrder_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "std", ",", "IVSeries", ",", "inversedIVSeries", ",", "impliedVar"}], 
     "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"IVSeries", "=", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"BSCall", "[", 
         RowBox[{"S", ",", "logForward", ",", "Z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "a", ",", "nOrder"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inversedIVSeries", " ", "=", " ", 
      RowBox[{"InverseSeries", "[", "IVSeries", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"std", " ", "=", " ", 
      RowBox[{
       RowBox[{"Normal", "[", "inversedIVSeries", "]"}], "/.", 
       RowBox[{"Z", "\[Rule]", "CallPrice"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"impliedVar", " ", "=", " ", 
      SuperscriptBox["std", "2"]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.719248432169223*^9, 3.719248478123147*^9}, {
  3.7192496577258015`*^9, 3.719249658443633*^9}, {3.719249968170514*^9, 
  3.7192499684174323`*^9}, {3.7192501978239083`*^9, 
  3.7192502561072645`*^9}},ExpressionUUID->"cd9bf93f-daa9-4022-9be4-\
39a7bfbd146c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "100"}], ",", 
     RowBox[{"K", "=", "100"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"r", "=", "0.05"}], ",", 
     RowBox[{"\[Sigma]", "=", "0.3"}], ",", "C", ",", "F", ",", 
     RowBox[{"nOrder", "=", "2"}], ",", "stdUpperBound", ",", "impliedVar"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C", " ", "=", " ", 
     RowBox[{"BSCallHandy", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"F", " ", "=", " ", 
     RowBox[{"S", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"r", " ", "T"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"stdUpperBound", "=", 
     RowBox[{"StdUpperBound", "[", 
      RowBox[{"C", ",", "F", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"impliedVar", " ", "=", " ", 
     RowBox[{
      RowBox[{"CallImpliedVariance", "[", 
       RowBox[{
       "C", ",", "S", ",", "lo", ",", "stdUpperBound", ",", "nOrder"}], "]"}],
       "//", "Simplify"}]}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.719248499454589*^9, 3.7192485530562305`*^9}, {
  3.719249015230398*^9, 3.719249020486475*^9}, {3.719249063085435*^9, 
  3.719249259897599*^9}, {3.719249301712181*^9, 3.719249377967264*^9}, {
  3.719249424721794*^9, 3.719249451922922*^9}, {3.7192495160207105`*^9, 
  3.7192495516627064`*^9}, {3.7192495832005596`*^9, 3.7192496456135883`*^9}, {
  3.719249796352871*^9, 3.7192498271957216`*^9}, {3.719249872243065*^9, 
  3.719249901858179*^9}, {3.7192499801649723`*^9, 3.7192500203856287`*^9}, {
  3.7192502757954473`*^9, 3.719250308644702*^9}, {3.7192503661713057`*^9, 
  3.719250366466834*^9}, {3.71925051307533*^9, 
  3.71925054828277*^9}},ExpressionUUID->"db1af434-d166-4ba9-8def-\
4f953255b473"],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"(", 
   RowBox[{"0.30000045309830903`", "\[VeryThinSpace]", "-", 
    FractionBox[
     RowBox[{"0.11536535721855902`", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"11.111077548349442`", " ", 
        SuperscriptBox["lo", "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1.`"}], "+", 
        RowBox[{"0.7153749042802836`", " ", 
         SuperscriptBox["\[ExponentialE]", "lo"]}], "+", 
        RowBox[{"Erf", "[", 
         RowBox[{"0.10606617737242555`", "\[VeryThinSpace]", "-", 
          RowBox[{"2.3570190440840144`", " ", "lo"}]}], "]"}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", "lo"], " ", 
         RowBox[{"Erf", "[", 
          RowBox[{"0.10606617737242555`", "\[VeryThinSpace]", "+", 
           RowBox[{"2.3570190440840144`", " ", "lo"}]}], "]"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"lo", " ", 
         RowBox[{"(", 
          RowBox[{"0.5`", "\[VeryThinSpace]", "+", 
           RowBox[{"5.555538774174721`", " ", "lo"}]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{"0.04550924737901334`", "\[VeryThinSpace]", "-", 
         RowBox[{"1.0113135535904714`", " ", "lo"}]}], ")"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"5.555538774174721`", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"0.04500013592959535`", "\[VeryThinSpace]", "+", 
            RowBox[{"1.`", " ", "lo"}]}], ")"}], "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{"0.04500013592959536`", "\[VeryThinSpace]", "+", 
         RowBox[{"1.`", " ", "lo"}]}], ")"}]}]}]], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"0.2464649137545074`", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"22.222155096698884`", " ", 
         SuperscriptBox["lo", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"5.555538774174721`", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"0.04500013592959535`", "\[VeryThinSpace]", "+", 
               RowBox[{"1.`", " ", "lo"}]}], ")"}], "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{"0.0000911258257747862`", "\[VeryThinSpace]", "+", 
            RowBox[{"0.1820255559520635`", " ", "lo"}], "-", 
            RowBox[{"0.045000135929595377`", " ", 
             SuperscriptBox["lo", "2"]}], "-", 
            RowBox[{"1.`", " ", 
             SuperscriptBox["lo", "3"]}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"lo", " ", 
            RowBox[{"(", 
             RowBox[{"0.5`", "\[VeryThinSpace]", "+", 
              RowBox[{"5.555538774174721`", " ", "lo"}]}], ")"}]}]], " ", 
          RowBox[{"(", 
           RowBox[{"0.00009215678268816516`", "\[VeryThinSpace]", "-", 
            RowBox[{"0.1840849118341625`", " ", "lo"}], "-", 
            RowBox[{"0.04550924737901335`", " ", 
             SuperscriptBox["lo", "2"]}], "+", 
            RowBox[{"1.0113135535904714`", " ", 
             SuperscriptBox["lo", "3"]}]}], ")"}]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1.`"}], "+", 
          RowBox[{"0.7153749042802836`", " ", 
           SuperscriptBox["\[ExponentialE]", "lo"]}], "+", 
          RowBox[{"Erf", "[", 
           RowBox[{"0.10606617737242555`", "\[VeryThinSpace]", "-", 
            RowBox[{"2.3570190440840144`", " ", "lo"}]}], "]"}], "+", 
          RowBox[{
           SuperscriptBox["\[ExponentialE]", "lo"], " ", 
           RowBox[{"Erf", "[", 
            RowBox[{"0.10606617737242555`", "\[VeryThinSpace]", "+", 
             RowBox[{"2.3570190440840144`", " ", "lo"}]}], "]"}]}]}], ")"}], 
        "2"]}], ")"}], "/", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"5.555538774174721`", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"0.04500013592959535`", "\[VeryThinSpace]", "+", 
              RowBox[{"1.`", " ", "lo"}]}], ")"}], "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "0.04500013592959536`"}], "-", 
           RowBox[{"1.`", " ", "lo"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"lo", " ", 
           RowBox[{"(", 
            RowBox[{"0.5`", "\[VeryThinSpace]", "+", 
             RowBox[{"5.555538774174721`", " ", "lo"}]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "0.04550924737901334`"}], "+", 
           RowBox[{"1.0113135535904714`", " ", "lo"}]}], ")"}]}]}], ")"}], 
      "3"]}]}], ")"}], "2"]], "Output",
 CellChangeTimes->{
  3.719249482988822*^9, {3.7192495172107625`*^9, 3.7192495244345417`*^9}, {
   3.719249646214452*^9, 3.7192496674067063`*^9}, 3.7192497973305883`*^9, {
   3.7192498736099286`*^9, 3.7192498825058794`*^9}, 3.719250021693673*^9, 
   3.7192503122984743`*^9, 3.719250348648583*^9, {3.7192505286996775`*^9, 
   3.719250548956877*^9}, 3.719328395810012*^9, 3.719330508504327*^9, 
   3.719597127038951*^9, 3.719599145789501*^9, 
   3.719599544184043*^9},ExpressionUUID->"57062233-981c-4bae-8499-\
f2aa551eb25d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"S", "=", "100"}], ",", 
      RowBox[{"K", "=", "100"}], ",", 
      RowBox[{"T", "=", "1"}], ",", 
      RowBox[{"r", "=", "0.05"}], ",", 
      RowBox[{"\[Sigma]", "=", "0.3"}], ",", "C", ",", "F", ",", 
      RowBox[{"nOrder", "=", "10"}], ",", "stdUpperBound", ",", 
      "impliedVar"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"C", " ", "=", " ", 
      RowBox[{"BSCallHandy", "[", 
       RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"F", " ", "=", " ", 
      RowBox[{"S", "*", 
       RowBox[{"Exp", "[", 
        RowBox[{"r", " ", "T"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"stdUpperBound", "=", 
      RowBox[{"StdUpperBound", "[", 
       RowBox[{"C", ",", "F", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"impliedVar", " ", "=", " ", 
      RowBox[{"CallImpliedVariance", "[", 
       RowBox[{"C", ",", "S", ",", 
        RowBox[{"logForward", "[", 
         RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}], ",", 
        "stdUpperBound", ",", "nOrder"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.719250398039011*^9, 3.719250403496023*^9}, 
   3.719250460694623*^9},ExpressionUUID->"cbadec8e-fa64-4ed2-bd59-\
e810ec73958a"],

Cell[BoxData["0.08999999999999983`"], "Output",
 CellChangeTimes->{3.7192505287327657`*^9, 3.7193283960633793`*^9, 
  3.719330508560129*^9, 3.7195971271026697`*^9, 3.719599145952859*^9, 
  3.719599544264789*^9},ExpressionUUID->"4bee6e78-7445-4a31-b697-\
0d9e98ef22b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"W", "[", 
    RowBox[{
    "T_", ",", "y_", ",", "r_", ",", "K_", ",", "C_", ",", "a_", ",", 
     "nOrder_"}], "]"}], ":=", 
   RowBox[{"CallImpliedVariance", "[", 
    RowBox[{"C", ",", 
     RowBox[{"K", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "y"}], "-", 
        RowBox[{"r", " ", "T"}]}], "]"}]}], ",", 
     RowBox[{"-", "y"}], ",", "a", ",", "nOrder"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "100"}], ",", 
     RowBox[{"K", "=", "100"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"r", "=", "0.05"}], ",", 
     RowBox[{"\[Sigma]", "=", "0.3"}], ",", "C", ",", "F", ",", 
     RowBox[{"nOrder", "=", "10"}], ",", "y", ",", "stdUpperBound", ",", 
     "impliedVar"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F", "=", 
     RowBox[{"S", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"r", " ", "T"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"y", "=", 
     RowBox[{"-", 
      RowBox[{"logForward", "[", 
       RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"C", "=", 
     RowBox[{"BSCallHandy", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"stdUpperBound", "=", 
     RowBox[{"StdUpperBound", "[", 
      RowBox[{"C", ",", "F", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"W", "[", 
     RowBox[{
     "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "stdUpperBound", ",", 
      "nOrder"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.7192511868988805`*^9, 3.7192515936413045`*^9}, {
  3.7192521022203526`*^9, 
  3.7192521280289145`*^9}},ExpressionUUID->"72fdd2f5-1ada-4866-9509-\
c651d0cbd65a"],

Cell[BoxData["0.08999999999999983`"], "Output",
 CellChangeTimes->{3.7192515024294167`*^9, 3.719251594017827*^9, 
  3.7192521335112157`*^9, 3.719328396112692*^9, 3.719330508612197*^9, 
  3.719597127270453*^9, 3.719599146070423*^9, 
  3.71959954434875*^9},ExpressionUUID->"04ca1ce8-89ed-4e95-b7b9-1825a2f35539"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<NumericalCalculus`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7193427984822283`*^9, 
  3.719342798484507*^9}},ExpressionUUID->"925d8a18-8c53-4c0a-b3a8-\
f2c627ac0468"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"DTW", "[", 
    RowBox[{
    "T_", ",", "y_", ",", "r_", ",", "K_", ",", "C_", ",", "a_", ",", 
     "nOrder_", ",", "delta_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"W", "[", 
      RowBox[{
       RowBox[{"T", "+", "delta"}], ",", "y", ",", "r", ",", "K", ",", "C", 
       ",", "a", ",", "nOrder"}], "]"}], "-", 
     RowBox[{"W", "[", 
      RowBox[{
       RowBox[{"T", "-", "delta"}], ",", "y", ",", "r", ",", "K", ",", "C", 
       ",", "a", ",", "nOrder"}], "]"}]}], 
    RowBox[{"2", " ", "delta"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DTWNew", "[", 
    RowBox[{
    "T_", ",", "y_", ",", "r_", ",", "K_", ",", "C_", ",", "a_", ",", 
     "nOrder_", ",", "delta_"}], "]"}], ":=", 
   RowBox[{"ND", "[", 
    RowBox[{
     RowBox[{"W", "[", 
      RowBox[{
      "T", ",", "yy", ",", "r", ",", "K", ",", "C", ",", "a", ",", "nOrder"}],
       "]"}], ",", "yy", ",", "y"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"DyW", "[", 
    RowBox[{
    "T_", ",", "y_", ",", "r_", ",", "K_", ",", "C_", ",", "a_", ",", 
     "nOrder_", ",", "delta_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"W", "[", 
      RowBox[{"T", ",", 
       RowBox[{"y", "+", "delta"}], ",", "r", ",", "K", ",", "C", ",", "a", 
       ",", "nOrder"}], "]"}], "-", 
     RowBox[{"W", "[", 
      RowBox[{"T", ",", 
       RowBox[{"y", "-", "delta"}], ",", "r", ",", "K", ",", "C", ",", "a", 
       ",", "nOrder"}], "]"}]}], 
    RowBox[{"2", " ", "delta"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dy2W", "[", 
    RowBox[{
    "T_", ",", "y_", ",", "r_", ",", "K_", ",", "C_", ",", "a_", ",", 
     "nOrder_", ",", "delta_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"W", "[", 
      RowBox[{"T", ",", 
       RowBox[{"y", "+", "delta"}], ",", "r", ",", "K", ",", "C", ",", "a", 
       ",", "nOrder"}], "]"}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"W", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "a", ",", "nOrder"}],
        "]"}]}], "+", 
     RowBox[{"W", "[", 
      RowBox[{"T", ",", 
       RowBox[{"y", "-", "delta"}], ",", "r", ",", "K", ",", "C", ",", "a", 
       ",", "nOrder"}], "]"}]}], 
    SuperscriptBox["delta", "2"]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7192505767893324`*^9, 3.7192506963671103`*^9}, {
  3.7192507623040094`*^9, 3.719250834553409*^9}, {3.7192513334646277`*^9, 
  3.7192513432122173`*^9}, {3.7192516479431295`*^9, 3.7192518342881117`*^9}, {
  3.719340320439372*^9, 3.719340332418949*^9}, {3.7193405283845387`*^9, 
  3.7193405682956953`*^9}, {3.719341140442566*^9, 3.719341141997492*^9}, {
  3.719342569729814*^9, 3.719342574395439*^9}, {3.719342844401284*^9, 
  3.719342859154685*^9}},ExpressionUUID->"b73833b8-eb97-47df-8ab7-\
f20110ccc931"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7192518561629763`*^9, 
  3.71925186062078*^9}},ExpressionUUID->"81fd429b-ac59-4ed7-a632-\
1d35d683d30d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "100"}], ",", 
     RowBox[{"K", "=", "100"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"r", "=", "0.05"}], ",", 
     RowBox[{"\[Sigma]", "=", "0.3"}], ",", "C", ",", "F", ",", 
     RowBox[{"nOrder", "=", "10"}], ",", "y", ",", "stdUpperBound", ",", 
     RowBox[{"delta", "=", "0.0000001"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F", "=", 
     RowBox[{"S", "*", 
      RowBox[{"Exp", "[", 
       RowBox[{"r", " ", "T"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"y", "=", 
     RowBox[{"-", 
      RowBox[{"logForward", "[", 
       RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"C", "=", 
     RowBox[{"BSCallHandy", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"stdUpperBound", "=", 
     RowBox[{"StdUpperBound", "[", 
      RowBox[{"C", ",", "F", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"DTW", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "stdUpperBound", ",",
         "nOrder", ",", "delta"}], "]"}], ",", 
      RowBox[{"DTWNew", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "stdUpperBound", ",",
         "nOrder", ",", "delta"}], "]"}], ",", 
      RowBox[{"DyW", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "stdUpperBound", ",",
         "nOrder", ",", "delta"}], "]"}], ",", 
      RowBox[{"Dy2W", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "stdUpperBound", ",",
         "nOrder", ",", "delta"}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7192518769694843`*^9, 3.719251976739968*^9}, 
   3.719252145015609*^9, {3.71933999756957*^9, 3.719339997979474*^9}, {
   3.719343105781694*^9, 
   3.719343142624395*^9}},ExpressionUUID->"cdb79355-4509-4149-a182-\
5929fc50663c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.011251992185212778`", ",", "1.699985032290238`*^60", ",", 
   "0.9871337039446537`", ",", "2.306488333658763`"}], "}"}]], "Output",
 CellChangeTimes->{{3.719251914729149*^9, 3.719251945103089*^9}, 
   3.719251977224117*^9, 3.719252151134758*^9, 3.719328396244032*^9, 
   3.719330508717431*^9, 3.719340000533102*^9, 3.719340344471113*^9, 
   3.71934243117719*^9, 3.719342597459944*^9, 3.71934282395466*^9, 
   3.7193430224392443`*^9, {3.7193431075248213`*^9, 3.719343117322195*^9}, 
   3.719343162523795*^9, 3.719597148636704*^9, 3.7195991689982777`*^9, 
   3.719599564841387*^9},ExpressionUUID->"43ccce82-1e6e-416b-9d8d-\
74b402ae1efe"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"LocalVolatility", "[", 
   RowBox[{
   "T_", ",", "y_", ",", "r_", ",", "K_", ",", "C_", ",", "a_", ",", 
    "nOrder_", ",", "delta_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dTW", ",", "dyW", ",", "dy2W", ",", "w", ",", "localVol"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"w", " ", "=", " ", 
      RowBox[{"W", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "a", ",", "nOrder"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dTW", " ", "=", " ", 
      RowBox[{"DTW", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "a", ",", "nOrder", 
        ",", "delta"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dyW", " ", "=", " ", 
      RowBox[{"DyW", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "a", ",", "nOrder", 
        ",", "delta"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dy2W", " ", "=", " ", 
      RowBox[{"Dy2W", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "a", ",", "nOrder", 
        ",", "delta"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"localVol", " ", "=", 
      FractionBox["dTW", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          FractionBox["y", "w"], "*", "dyW"}], " ", "+", " ", 
         RowBox[{
          FractionBox["1", "4"], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "4"]}], "-", 
            FractionBox["1", "w"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["y", "w"], ")"}], "2"]}], ")"}], "*", 
          SuperscriptBox["dyW", "2"]}], " ", "+", " ", 
         RowBox[{
          FractionBox["1", "2"], "*", "dy2W"}]}], ")"}]]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "y", ",", "w", ",", "dTW", ",", "dyW", ",", "dy2W", ",", "localVol", 
       ",", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          FractionBox["y", "w"], "*", "dyW"}], " ", "+", " ", 
         RowBox[{
          FractionBox["1", "4"], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "4"]}], "-", 
            FractionBox["1", "w"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["y", "w"], ")"}], "2"]}], ")"}], "*", 
          SuperscriptBox["dyW", "2"]}], " ", "+", " ", 
         RowBox[{
          FractionBox["1", "2"], "*", "dy2W"}]}], ")"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7192522706310673`*^9, 3.7192524231418304`*^9}, {
   3.7192524844969797`*^9, 3.7192527539483232`*^9}, {3.719335481848468*^9, 
   3.719335498031047*^9}, {3.719335585499547*^9, 3.719335590184985*^9}, {
   3.719335624959086*^9, 3.719335625238957*^9}, {3.719335713320451*^9, 
   3.719335731011237*^9}, {3.7193358182783737`*^9, 3.71933585610662*^9}, {
   3.719335894029724*^9, 3.7193359207970037`*^9}, 3.719336407001988*^9, {
   3.719336455245257*^9, 3.719336463220067*^9}, {3.7193365181067467`*^9, 
   3.719336564154801*^9}, {3.719336699418212*^9, 3.719336699899899*^9}, 
   3.719339205051572*^9, 3.719339242811612*^9, {3.719339329009087*^9, 
   3.719339329179392*^9}, {3.719340122973546*^9, 
   3.719340123505314*^9}},ExpressionUUID->"b47cebbf-93a2-4323-b97d-\
b650292b0892"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LocalVolHandy", "[", 
    RowBox[{
    "S_", ",", "K_", ",", "T_", ",", "r_", ",", "C_", ",", "a_", ",", 
     "nOrder_", ",", "delta_"}], "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"y", "=", 
       RowBox[{"-", 
        RowBox[{"logForward", "[", 
         RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"LocalVolatility", "[", 
      RowBox[{
      "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "a", ",", "nOrder", 
       ",", "delta"}], "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.719252789570694*^9, 
  3.719252896375704*^9}},ExpressionUUID->"7b9c3baa-230b-47ea-a964-\
74a03d0ad2eb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "100"}], ",", 
     RowBox[{"K", "=", "100"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"r", "=", "0.05"}], ",", 
     RowBox[{"\[Sigma]", "=", "0.3"}], ",", 
     RowBox[{"delta", "=", "0.001"}], ",", "C", ",", "F", ",", "a", ",", 
     RowBox[{"nOrder", "=", "30"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C", "=", 
     RowBox[{"BSCallHandy", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"F", "=", 
     RowBox[{"S", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"r", " ", "T"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{"StdUpperBound", "[", 
      RowBox[{"C", ",", "F", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LocalVolHandy", "[", 
       RowBox[{
       "S", ",", "K", ",", "T", ",", "r", ",", "C", ",", "a", ",", "nOrder", 
        ",", "delta"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"LocalVolHandy", "[", 
       RowBox[{
       "S", ",", "K", ",", "T", ",", "r", ",", "C", ",", "a", ",", "nOrder", 
        ",", 
        RowBox[{"-", "delta"}]}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7192529015728445`*^9, 3.7192531354501762`*^9}, {
   3.719335219921317*^9, 3.719335220507613*^9}, 3.719335289196972*^9, {
   3.719335511892524*^9, 3.7193355287510967`*^9}, 3.719335598231029*^9, {
   3.719335642396183*^9, 3.719335659145319*^9}, {3.719335720430523*^9, 
   3.7193357386026087`*^9}, {3.719335784768971*^9, 3.719335802223543*^9}, 
   3.7193358696534357`*^9, {3.719335929525332*^9, 3.7193359425762568`*^9}, {
   3.7193360725821466`*^9, 3.719336084640891*^9}, 3.7193361204987183`*^9, {
   3.719340385925123*^9, 
   3.7193404190478497`*^9}},ExpressionUUID->"a266c2e0-9306-4503-b0a3-\
c722919f5467"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.05`"}], ",", "0.08999999999999983`", ",", 
     "0.011251992307011183`", ",", "0.9871347584894317`", ",", 
     "2.2881111320233183`", ",", 
     RowBox[{"-", "775.345743029026`"}], ",", 
     RowBox[{"-", "0.000014512225556373437`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.05`"}], ",", "0.08999999999999983`", ",", 
     "0.011251992307011183`", ",", "0.9871347584894317`", ",", 
     "2.2881111320233183`", ",", 
     RowBox[{"-", "775.345743029026`"}], ",", 
     RowBox[{"-", "0.000014512225556373437`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7192531362882414`*^9, 3.7193283963414583`*^9, 3.719330508811297*^9, 
   3.719335221804957*^9, 3.71933529179772*^9, {3.719335503105843*^9, 
   3.7193355292336197`*^9}, {3.719335595275282*^9, 3.719335659789978*^9}, {
   3.719335717243331*^9, 3.719335739336515*^9}, {3.719335785223879*^9, 
   3.7193358026713142`*^9}, {3.7193358666990433`*^9, 
   3.7193358700864277`*^9}, {3.7193359262061987`*^9, 3.71933594328957*^9}, {
   3.719336076439612*^9, 3.719336085357767*^9}, 3.71933612153475*^9, 
   3.7193364136246*^9, 3.719336569449519*^9, 3.7193398750717287`*^9, 
   3.719340128663747*^9, 3.719340354135685*^9, {3.719340387646254*^9, 
   3.719340419677979*^9}, 3.719343029919279*^9, 3.7193432640002947`*^9, 
   3.7195971490660267`*^9, 3.719599169450357*^9, 
   3.719599565221663*^9},ExpressionUUID->"637b0f45-940a-4beb-874d-\
dd80c91bd27d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"LocalVolatilityCheck", "[", 
   RowBox[{
   "T_", ",", "y_", ",", "r_", ",", "K_", ",", "C_", ",", "a_", ",", 
    "nOrder_", ",", "delta_"}], "]"}], ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dTW", ",", "dyW", ",", "dy2W", ",", "w", ",", "localVol"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"w", " ", "=", " ", 
      RowBox[{"W", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "a", ",", "nOrder"}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dTW", " ", "=", " ", 
      RowBox[{"DTW", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "a", ",", "nOrder", 
        ",", "delta"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dyW", " ", "=", " ", 
      RowBox[{"DyW", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "a", ",", "nOrder", 
        ",", "delta"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dy2W", " ", "=", " ", 
      RowBox[{"Dy2W", "[", 
       RowBox[{
       "T", ",", "y", ",", "r", ",", "K", ",", "C", ",", "a", ",", "nOrder", 
        ",", "delta"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"localVol", " ", "=", 
      FractionBox["dTW", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          FractionBox["y", "w"], "*", "dyW"}], " ", "+", " ", 
         RowBox[{
          FractionBox["1", "4"], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             FractionBox["1", "4"]}], "-", 
            FractionBox["1", "w"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["y", "w"], ")"}], "2"]}], ")"}], "*", 
          SuperscriptBox["dyW", "2"]}], " ", "+", " ", 
         RowBox[{
          FractionBox["1", "2"], "*", "dy2W"}]}], ")"}]]}], " ", ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "y", ",", "w", ",", "dTW", ",", "dyW", ",", "dy2W", ",", "localVol"}], 
      "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7193394652087307`*^9, 
  3.719339466274221*^9}},ExpressionUUID->"f147adc7-2d56-4005-b3a8-\
b54873bc2eaf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "=", "100"}], ",", 
     RowBox[{"K", "=", "100"}], ",", 
     RowBox[{"T", "=", "1"}], ",", 
     RowBox[{"r", "=", "0.05"}], ",", 
     RowBox[{"\[Sigma]", "=", "0.3"}], ",", 
     RowBox[{"delta", "=", "0.01"}], ",", "C", ",", "F", ",", "a", ",", 
     RowBox[{"nOrder", "=", "30"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"C", "=", 
     RowBox[{"BSCallHandy", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"F", "=", 
     RowBox[{"S", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{"r", " ", "T"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"a", "=", 
     RowBox[{"StdUpperBound", "[", 
      RowBox[{"C", ",", "F", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"LocalVolHandy", "[", 
       RowBox[{
       "S", ",", "K", ",", "T", ",", "r", ",", "C", ",", "a", ",", "nOrder", 
        ",", "delta"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"LocalVolHandy", "[", 
       RowBox[{
       "S", ",", "K", ",", "T", ",", "r", ",", "C", ",", "a", ",", "nOrder", 
        ",", 
        RowBox[{"-", "delta"}]}], "]"}]}], "}"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",ExpressionUUID->"545f3558-8e56-4b6c-b4ed-fb8b2c71f9c0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.05`"}], ",", "0.08999999999999983`", ",", 
     "0.011251994568160784`", ",", "0.9872400388240554`", ",", 
     "2.286243858076187`", ",", 
     RowBox[{"-", "7.6857386171300055`"}], ",", 
     RowBox[{"-", "0.001464009528385768`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.05`"}], ",", "0.08999999999999983`", ",", 
     "0.011251994568160784`", ",", "0.9872400388240554`", ",", 
     "2.286243858076187`", ",", 
     RowBox[{"-", "7.6857386171300055`"}], ",", 
     RowBox[{"-", "0.001464009528385768`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.719339499368786*^9, 3.7195971493943777`*^9, 
  3.719599169811327*^9, 
  3.719599565539029*^9},ExpressionUUID->"875e94aa-9885-44bb-ac66-\
a9609e8135df"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", "x_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], " ", "+", " ", 
    RowBox[{
     FractionBox[
      RowBox[{"Sign", "[", "x", "]"}], "2"], 
     SqrtBox[
      RowBox[{"1", "-", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{"-", 
          FractionBox["2", "Pi"]}], " ", 
         SuperscriptBox["x", "2"]}], "]"}]}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"k_", ",", "\[Sigma]_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Exp", "[", "k", "]"}], " ", 
     RowBox[{"A", "[", 
      RowBox[{
       FractionBox["k", "\[Sigma]"], "+", 
       FractionBox["\[Sigma]", "2"]}], "]"}]}], "-", 
    RowBox[{"A", "[", 
     RowBox[{
      FractionBox["k", "\[Sigma]"], "+", 
      FractionBox["\[Sigma]", "2"]}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.719346315337172*^9, 
  3.7193464941946*^9}},ExpressionUUID->"3077c7de-224c-4f2b-9fb1-dd31b690d097"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1397, 855},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 191, 3, 98, "Title",ExpressionUUID->"6450bd91-c7ec-40b8-9b68-2e11915c5821"],
Cell[CellGroupData[{
Cell[796, 29, 197, 3, 67, "Section",ExpressionUUID->"4c08c370-1ff2-458c-8eca-c16af5f3a48d"],
Cell[CellGroupData[{
Cell[1018, 36, 354, 10, 30, "Input",ExpressionUUID->"94ad5817-e37a-4d4a-a671-7e33014cd65a"],
Cell[1375, 48, 3107, 93, 61, "Output",ExpressionUUID->"f5a9952d-75c9-4841-b049-1c06c7b25d7a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4519, 146, 348, 9, 47, "Input",ExpressionUUID->"af045238-6101-43fa-9a26-a0db1044e097"],
Cell[4870, 157, 2348, 68, 58, "Output",ExpressionUUID->"ad11247a-89f5-4de5-86d1-98a624cc7c20"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7255, 230, 283, 8, 30, "Input",ExpressionUUID->"5a274af3-1b42-47a9-88b3-4dcbefd9e8f9"],
Cell[7541, 240, 992, 25, 50, "Output",ExpressionUUID->"a203dc0b-0f86-4fd7-bf45-184617966625"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8582, 271, 178, 3, 67, "Section",ExpressionUUID->"6afdbf59-4267-4fe6-bb75-cf95e07339ee"],
Cell[8763, 276, 3236, 102, 281, "Input",ExpressionUUID->"205c526e-c48d-4f52-adcc-0afc2ae91cb0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12036, 383, 181, 3, 67, "Section",ExpressionUUID->"e78a82ea-0764-40d3-8aed-1d38b54a42c6"],
Cell[12220, 388, 2647, 68, 262, "Input",ExpressionUUID->"a7c923bf-00cb-4612-89a9-08fed32dd902"],
Cell[CellGroupData[{
Cell[14892, 460, 965, 22, 94, "Input",ExpressionUUID->"244e5e9f-2a67-4c52-ad25-0b772f8812d3"],
Cell[15860, 484, 592, 9, 34, "Output",ExpressionUUID->"cc1f5878-b03f-4962-a0c3-1a0c710f29a5"],
Cell[16455, 495, 593, 9, 34, "Output",ExpressionUUID->"8c3982e7-dbf8-455f-a887-989ed566eccc"],
Cell[17051, 506, 591, 9, 34, "Output",ExpressionUUID->"f6f0635b-d78d-4405-b30e-d7b686632b8a"],
Cell[17645, 517, 591, 9, 34, "Output",ExpressionUUID->"3f0fb25c-7ece-47cb-980a-87eb62470e40"]
}, Open  ]],
Cell[18251, 529, 3122, 77, 383, "Input",ExpressionUUID->"a979571c-e568-4997-95ea-1d358a566165"],
Cell[CellGroupData[{
Cell[21398, 610, 628, 13, 52, "Input",ExpressionUUID->"d1a321ff-51db-41f0-a378-afd12eea3649"],
Cell[22029, 625, 583, 9, 34, "Output",ExpressionUUID->"ae060288-54c1-4fd6-bbe3-d6d3cb74b35f"],
Cell[22615, 636, 583, 9, 34, "Output",ExpressionUUID->"6afb70ca-bb1b-41cf-b050-e63fe55a1eae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23235, 650, 9935, 218, 1228, "Input",ExpressionUUID->"041da8f9-5be5-42a5-a4f5-27d45525e36f"],
Cell[33173, 870, 10553, 216, 360, "Output",ExpressionUUID->"91b18adc-090b-47de-8d70-8eeaf37c017e"],
Cell[43729, 1088, 10099, 211, 360, "Output",ExpressionUUID->"7511fae0-2c39-4e5e-8907-f0638d490e3c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53865, 1304, 1112, 29, 101, "Input",ExpressionUUID->"228c8dda-889a-42ce-bb38-fc3dc9d10ea7"],
Cell[54980, 1335, 530, 9, 52, "Output",ExpressionUUID->"6de4e49e-3267-420e-9077-aa1e335d6aff"]
}, Open  ]],
Cell[55525, 1347, 1222, 34, 81, "Input",ExpressionUUID->"a715d212-f502-4466-9a8b-254939140f89"],
Cell[CellGroupData[{
Cell[56772, 1385, 437, 11, 30, "Input",ExpressionUUID->"4b406a20-e6b0-41e1-9991-0b0384281404"],
Cell[57212, 1398, 548, 11, 37, "Output",ExpressionUUID->"e40c1d93-60a5-4f4e-a2b8-3cf71de36933"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[57809, 1415, 294, 6, 105, "Section",ExpressionUUID->"4f3ff7d2-4832-4e1e-9fb0-7f1f4cb10327"],
Cell[58106, 1423, 2782, 73, 296, "Input",ExpressionUUID->"ec986b81-c0c4-4297-8994-af529782013a"],
Cell[CellGroupData[{
Cell[60913, 1500, 886, 23, 30, "Input",ExpressionUUID->"5482c4e2-61db-4db2-af2d-f2e99ebea7fb"],
Cell[61802, 1525, 413, 6, 34, "Output",ExpressionUUID->"a708b0b8-a1fa-432e-b0c1-9375ad3d5092"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62252, 1536, 5877, 129, 693, "Input",ExpressionUUID->"7f28ed16-d987-4569-8ff4-9913fe2ae203"],
Cell[68132, 1667, 96505, 1715, 360, "Output",ExpressionUUID->"ee22a0f9-715f-4603-a918-dd31bd28ccf1"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[164686, 3388, 217, 5, 67, "Section",ExpressionUUID->"f59f6acb-b86d-4f55-b76b-4fe2874d0efd"],
Cell[164906, 3395, 18112, 497, 1340, "Input",ExpressionUUID->"55aaaebe-cd64-4bac-885c-152247680c6b"],
Cell[CellGroupData[{
Cell[183043, 3896, 813, 18, 73, "Input",ExpressionUUID->"996344b4-99b1-41f7-81aa-8ab8e83351e3"],
Cell[183859, 3916, 753, 12, 34, "Output",ExpressionUUID->"e96550ce-e36b-4586-b583-ce7ca19784c1"],
Cell[184615, 3930, 752, 12, 34, "Output",ExpressionUUID->"77a6f811-e64b-43eb-ba5d-865ae512bd9a"],
Cell[185370, 3944, 750, 12, 34, "Output",ExpressionUUID->"a6277c6c-d28b-4570-b4fb-b62ee3e7df9a"]
}, Open  ]],
Cell[186135, 3959, 152, 3, 30, "Input",ExpressionUUID->"3f80c133-1da7-4d20-9cd9-15d5b78df942"],
Cell[CellGroupData[{
Cell[186312, 3966, 1345, 33, 115, "Input",ExpressionUUID->"dee89846-2267-48a7-911a-fa6c351095b1"],
Cell[187660, 4001, 279, 6, 34, "Output",ExpressionUUID->"1602dc75-9161-4ceb-aa7a-6ef5a22820b8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187976, 4012, 181, 3, 54, "Subsection",ExpressionUUID->"f00c38ea-0781-4021-8621-261950989f65"],
Cell[CellGroupData[{
Cell[188182, 4019, 7324, 161, 872, "Input",ExpressionUUID->"fcf45a7c-c5f1-4f5e-b48a-5afdfdc768ae"],
Cell[195509, 4182, 38145, 737, 418, "Output",ExpressionUUID->"ebb667d2-802b-475c-ae7b-0fec219431b8"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[233703, 4925, 178, 3, 54, "Subsection",ExpressionUUID->"4d3d4d40-d83a-45a1-9fbb-398475356cfc"],
Cell[CellGroupData[{
Cell[233906, 4932, 6781, 153, 849, "Input",ExpressionUUID->"6aad2cf8-4410-4a66-a990-2b569cc6a6ba"],
Cell[240690, 5087, 39068, 759, 377, "Output",ExpressionUUID->"0b0a4122-8e4b-490d-b3ff-bc4afad54ea5"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[279819, 5853, 459, 12, 79, "Section",ExpressionUUID->"b6a27b39-5257-42e3-92f2-97689bff62e4"],
Cell[280281, 5867, 1433, 35, 161, "Input",ExpressionUUID->"cd9bf93f-daa9-4022-9be4-39a7bfbd146c"],
Cell[CellGroupData[{
Cell[281739, 5906, 1922, 41, 136, "Input",ExpressionUUID->"db1af434-d166-4ba9-8def-4f953255b473"],
Cell[283664, 5949, 5390, 125, 187, "Output",ExpressionUUID->"57062233-981c-4bae-8499-f2aa551eb25d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[289091, 6079, 1469, 35, 157, "Input",ExpressionUUID->"cbadec8e-fa64-4ed2-bd59-e810ec73958a"],
Cell[290563, 6116, 268, 4, 34, "Output",ExpressionUUID->"4bee6e78-7445-4a31-b697-0d9e98ef22b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[290868, 6125, 1937, 52, 178, "Input",ExpressionUUID->"72fdd2f5-1ada-4866-9509-c651d0cbd65a"],
Cell[292808, 6179, 310, 4, 34, "Output",ExpressionUUID->"04ca1ce8-89ed-4e95-b7b9-1825a2f35539"]
}, Open  ]],
Cell[293133, 6186, 211, 4, 30, "Input",ExpressionUUID->"925d8a18-8c53-4c0a-b3a8-f2c627ac0468"],
Cell[293347, 6192, 2892, 76, 153, "Input",ExpressionUUID->"b73833b8-eb97-47df-8ab7-f20110ccc931"],
Cell[296242, 6270, 153, 3, 30, "Input",ExpressionUUID->"81fd429b-ac59-4ed7-a632-1d35d683d30d"],
Cell[CellGroupData[{
Cell[296420, 6277, 2139, 53, 178, "Input",ExpressionUUID->"cdb79355-4509-4149-a182-5929fc50663c"],
Cell[298562, 6332, 681, 12, 37, "Output",ExpressionUUID->"43ccce82-1e6e-416b-9d8d-74b402ae1efe"]
}, Open  ]],
Cell[299258, 6347, 3500, 85, 243, "Input",ExpressionUUID->"b47cebbf-93a2-4323-b97d-b650292b0892"],
Cell[302761, 6434, 766, 21, 52, "Input",ExpressionUUID->"7b9c3baa-230b-47ea-a964-74a03d0ad2eb"],
Cell[CellGroupData[{
Cell[303552, 6459, 2006, 46, 157, "Input",ExpressionUUID->"a266c2e0-9306-4503-b0a3-c722919f5467"],
Cell[305561, 6507, 1516, 30, 34, "Output",ExpressionUUID->"637b0f45-940a-4beb-874d-dd80c91bd27d"]
}, Open  ]],
Cell[307092, 6540, 2236, 58, 225, "Input",ExpressionUUID->"f147adc7-2d56-4005-b3a8-b54873bc2eaf"],
Cell[CellGroupData[{
Cell[309353, 6602, 1431, 36, 157, "Input",ExpressionUUID->"545f3558-8e56-4b6c-b4ed-fb8b2c71f9c0"],
Cell[310787, 6640, 826, 20, 34, "Output",ExpressionUUID->"875e94aa-9885-44bb-ac66-a9609e8135df"]
}, Open  ]],
Cell[311628, 6663, 1016, 33, 96, "Input",ExpressionUUID->"3077c7de-224c-4f2b-9fb1-dd31b690d097"]
}, Open  ]]
}, Open  ]]
}
]
*)

