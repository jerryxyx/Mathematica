(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     40712,       1095]
NotebookOptionsPosition[     37524,       1031]
NotebookOutlinePosition[     37882,       1047]
CellTagsIndexPosition[     37839,       1044]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["cSingularities and Laurent Series of Error Function", "Section",
 CellChangeTimes->{{3.718403189124028*^9, 3.7184032298142824`*^9}, 
   3.718476542779768*^9},ExpressionUUID->"f998b030-d8df-4309-a3ec-\
71bd2a82d4a9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Erf", "[", 
    RowBox[{"z", "+", 
     RowBox[{"1", "/", "z"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "1", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7183048328759623`*^9, 
  3.7183048996319036`*^9}},ExpressionUUID->"193b2c5d-5d79-4577-8a0f-\
3573661fa44e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"Erf", "[", "2", "]"}], "+", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "2"]}], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "3"]}], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "4"]}], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "+", 
   FractionBox[
    RowBox[{"6", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "5"]}], 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    RowBox[{"16", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "6"]}], 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "4"], " ", 
       SqrtBox["\[Pi]"]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"20", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "8"]}], 
    RowBox[{"3", " ", 
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    RowBox[{"34", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "9"]}], 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", "4"], " ", 
       SqrtBox["\[Pi]"]}], ")"}]}]], "+", 
   FractionBox[
    RowBox[{"179", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"z", "-", "1"}], ")"}], "10"]}], 
    RowBox[{"15", " ", 
     SuperscriptBox["\[ExponentialE]", "4"], " ", 
     SqrtBox["\[Pi]"]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", 
      RowBox[{"z", "-", "1"}], "]"}], "11"],
    SeriesData[$CellContext`z, 1, {}, 0, 11, 1],
    Editable->False]}],
  SeriesData[$CellContext`z, 1, {
    Erf[2], 0, 2 E^(-4) Pi^Rational[-1, 2], (-2) E^(-4) 
    Pi^Rational[-1, 2], (-2) E^(-4) Pi^Rational[-1, 2], 6 E^(-4) 
    Pi^Rational[-1, 2], Rational[-16, 3] E^(-4) Pi^Rational[-1, 2], 0, 
    Rational[20, 3] E^(-4) Pi^Rational[-1, 2], Rational[-34, 3] E^(-4) 
    Pi^Rational[-1, 2], Rational[179, 15] E^(-4) Pi^Rational[-1, 2]}, 0, 11, 
   1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.718304870150279*^9, 3.718304900149414*^9}, 
   3.71840652683171*^9, 3.7184068225604477`*^9, 3.718410923360364*^9, 
   3.718469628592005*^9, 
   3.718477331598578*^9},ExpressionUUID->"0977f424-7eca-4139-a4ac-\
62b5743d415a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Erf", "[", 
    FractionBox["1", "z"], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.71830485920623*^9, 3.7183048599840145`*^9}, 
   3.7184028244772577`*^9},ExpressionUUID->"df61c590-1082-427b-9bb4-\
2f7e4861d0e4"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"-", "1"}], ")"}], 
   RowBox[{"Floor", "[", 
    FractionBox[
     RowBox[{"\[Pi]", "+", 
      RowBox[{"2", " ", 
       RowBox[{"Arg", "[", "z", "]"}]}]}], 
     RowBox[{"2", " ", "\[Pi]"}]], "]"}]], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    InterpretationBox[
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", 
        SuperscriptBox["z", "2"]]}], "+", 
      InterpretationBox[
       SuperscriptBox[
        RowBox[{"O", "[", "z", "]"}], "11"],
       SeriesData[$CellContext`z, 0, {}, -2, 11, 1],
       Editable->False]}],
     SeriesData[$CellContext`z, 0, {-1}, -2, 11, 1],
     Editable->False]], " ", 
   RowBox[{"(", 
    InterpretationBox[
     RowBox[{
      RowBox[{"-", 
       FractionBox["z", 
        SqrtBox["\[Pi]"]]}], "+", 
      FractionBox[
       SuperscriptBox["z", "3"], 
       RowBox[{"2", " ", 
        SqrtBox["\[Pi]"]}]], "-", 
      FractionBox[
       RowBox[{"3", " ", 
        SuperscriptBox["z", "5"]}], 
       RowBox[{"4", " ", 
        SqrtBox["\[Pi]"]}]], "+", 
      FractionBox[
       RowBox[{"15", " ", 
        SuperscriptBox["z", "7"]}], 
       RowBox[{"8", " ", 
        SqrtBox["\[Pi]"]}]], "-", 
      FractionBox[
       RowBox[{"105", " ", 
        SuperscriptBox["z", "9"]}], 
       RowBox[{"16", " ", 
        SqrtBox["\[Pi]"]}]], "+", 
      InterpretationBox[
       SuperscriptBox[
        RowBox[{"O", "[", "z", "]"}], "11"],
       SeriesData[$CellContext`z, 0, {}, 1, 11, 1],
       Editable->False]}],
     SeriesData[$CellContext`z, 
      0, {-Pi^Rational[-1, 2], 0, Rational[1, 2] Pi^Rational[-1, 2], 0, 
       Rational[-3, 4] Pi^Rational[-1, 2], 0, Rational[15, 8] 
       Pi^Rational[-1, 2], 0, Rational[-105, 16] Pi^Rational[-1, 2]}, 1, 11, 
      1],
     Editable->False], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7183048603549023`*^9, 3.718402843782461*^9, 
  3.718406526974309*^9, 3.7184068226783266`*^9, 3.71841092373804*^9, 
  3.7184696291712847`*^9, 
  3.718477331850768*^9},ExpressionUUID->"658bce55-3ca4-47f2-a6c0-\
d240105520b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"Erf", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "n"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.718404713029087*^9, 
  3.718404751597726*^9}},ExpressionUUID->"48e612bd-86aa-492b-9a8f-\
d14f6b2ea5a9"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["2", "n"], " ", 
  SuperscriptBox["x", 
   RowBox[{"1", "-", "n"}]], " ", 
  RowBox[{"HypergeometricPFQRegularized", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      FractionBox["1", "2"], ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"1", "-", 
       FractionBox["n", "2"]}], ",", 
      FractionBox[
       RowBox[{"3", "-", "n"}], "2"]}], "}"}], ",", 
    RowBox[{"-", 
     SuperscriptBox["x", "2"]}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.71840473472009*^9, 3.7184047519883194`*^9}, 
   3.71840652699846*^9, 3.718406822704379*^9, 3.7184109237570887`*^9, 
   3.718469629221714*^9, 
   3.718477331905397*^9},ExpressionUUID->"4f6ddcbb-ca9f-4222-833a-\
aa5b8fd2dbf7"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Black Scholes Pricing Formula", "Section",
 CellChangeTimes->{{3.718402922661405*^9, 
  3.718402935171898*^9}},ExpressionUUID->"52d481f1-3828-4966-a016-\
9e2f25ce6bfd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"normalCDF", "[", "d_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Erf", "[", 
       FractionBox["d", 
        SqrtBox["2"]], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"normalInverseCDF", "[", 
    RowBox[{"y_", ",", "norder_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"InverseSeries", "[", 
      RowBox[{
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"normalCDF", "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "norder"}], "}"}]}], "]"}], ",", "x"}], 
      "]"}], "]"}], "/.", 
    RowBox[{"x", "\[Rule]", "y"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"logForward", "[", 
    RowBox[{"S_", ",", "K_", ",", "T_", ",", "r_"}], "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Log", "[", 
     FractionBox["S", "K"], "]"}], "+", 
    RowBox[{"r", "*", "T"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Z", "[", 
    RowBox[{"\[Sigma]_", ",", "T_"}], "]"}], ":=", " ", 
   RowBox[{"\[Sigma]", " ", 
    SqrtBox["T"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d1", "[", 
    RowBox[{"lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["lo", "Z"], "+", 
    FractionBox["Z", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d2", "[", 
    RowBox[{"lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["lo", "Z"], "-", 
    FractionBox["Z", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSCall", "[", 
    RowBox[{"S_", ",", "lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{"S", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"normalCDF", "[", 
       RowBox[{"d1", "[", 
        RowBox[{"lo", ",", "Z"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", "lo"}], "]"}], 
       RowBox[{"normalCDF", "[", 
        RowBox[{"d2", "[", 
         RowBox[{"lo", ",", "Z"}], "]"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSCallHandy", "[", 
    RowBox[{"S_", ",", "K_", ",", "T_", ",", "r_", ",", "\[Sigma]_"}], "]"}], 
   ":=", 
   RowBox[{"BSCall", "[", 
    RowBox[{"S", ",", 
     RowBox[{"logForward", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}], ",", 
     RowBox[{"Z", "[", 
      RowBox[{"\[Sigma]", ",", "T"}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSPut", "[", 
    RowBox[{"S_", ",", "lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{"S", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"normalCDF", "[", 
        RowBox[{"-", 
         RowBox[{"d1", "[", 
          RowBox[{"lo", ",", "Z"}], "]"}]}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", "lo"}], "]"}], 
       RowBox[{"normalCDF", "[", 
        RowBox[{"-", 
         RowBox[{"d2", "[", 
          RowBox[{"lo", ",", "Z"}], "]"}]}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSPutHandy", "[", 
    RowBox[{"S_", ",", "K_", ",", "T_", ",", "r_", ",", "\[Sigma]_"}], "]"}], 
   ":=", 
   RowBox[{"BSPut", "[", 
    RowBox[{"S", ",", 
     RowBox[{"logForward", "[", 
      RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}], ",", 
     RowBox[{"Z", "[", 
      RowBox[{"\[Sigma]", ",", "T"}], "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.718407162500527*^9, 3.718407164132204*^9}, {
  3.718407194374468*^9, 3.7184072009009*^9}, {3.71840766393312*^9, 
  3.7184077076621876`*^9}, {3.718561518348612*^9, 
  3.718561687286695*^9}},ExpressionUUID->"faca4ef7-4317-463b-b2f5-\
ba79282d5454"],

Cell[BoxData["0.15096921549127595`"], "Output",
 CellChangeTimes->{{3.718561624033184*^9, 
  3.718561681244238*^9}},ExpressionUUID->"c5acc704-74ec-4447-acab-\
6c71a6481b99"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Expansion of Black Scholes Formula", "Section",
 CellChangeTimes->{{3.7184033560035305`*^9, 
  3.718403374548543*^9}},ExpressionUUID->"8f6270c1-ce86-4c47-ad5d-\
fd9f34ca2a90"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BSCallTaylorExpansion", "[", 
   RowBox[{
   "S_", ",", "K_", ",", "T_", ",", "r_", ",", "\[Sigma]_", ",", "a_", ",", 
    "nOrder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mu", ",", "std", ",", "IVSeries"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"std", " ", "=", " ", 
      RowBox[{"Z", "[", 
       RowBox[{"\[Sigma]", ",", "T"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mu", " ", "=", " ", 
      RowBox[{"logForward", "[", 
       RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IVSeries", "=", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"BSCall", "[", 
         RowBox[{"S", ",", "mu", ",", "Z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "a", ",", "nOrder"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"callPrice", " ", "=", " ", 
      RowBox[{
       RowBox[{"Normal", "[", "IVSeries", "]"}], "/.", 
       RowBox[{"Z", "\[Rule]", "std"}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.718408609499116*^9, 3.718408811095866*^9}, {
  3.718408848550049*^9, 3.718408894418955*^9}, {3.7184096598268847`*^9, 
  3.718409677380666*^9}},ExpressionUUID->"bca0fb50-219a-4f2c-a829-\
33f43b801621"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"BSCallTaylorExpansion", "[", 
  RowBox[{
  "100", ",", "100", ",", "1", ",", "0.05", ",", "0.3", ",", "1", ",", "20"}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BSCallHandy", "[", 
   RowBox[{"100", ",", "100", ",", "1", ",", "0.05", ",", "0.3"}], "]"}], "//",
   "N"}]}], "Input",
 CellChangeTimes->{{3.7184088283552585`*^9, 3.718408843035983*^9}, {
  3.71840889838206*^9, 3.7184088991699815`*^9}, {3.7184089495687685`*^9, 
  3.718408949869565*^9}, {3.7184096841514835`*^9, 
  3.718409684343588*^9}},ExpressionUUID->"42b4d5b0-8ef0-4aca-ba7d-\
b7f319b5cc25"],

Cell[BoxData["14.231170021098274`"], "Output",
 CellChangeTimes->{
  3.7184088434710054`*^9, {3.718408899578873*^9, 3.7184089030574436`*^9}, 
   3.7184089511691775`*^9, 3.7184096849714413`*^9, 3.718410923858363*^9, 
   3.7184696292940903`*^9, 
   3.71847733198853*^9},ExpressionUUID->"4ef39c47-8a52-4bfc-81b2-\
b8aef4084a9c"],

Cell[BoxData["14.23125478598582`"], "Output",
 CellChangeTimes->{
  3.7184088434710054`*^9, {3.718408899578873*^9, 3.7184089030574436`*^9}, 
   3.7184089511691775`*^9, 3.7184096849714413`*^9, 3.718410923858363*^9, 
   3.7184696292940903`*^9, 
   3.7184773319947853`*^9},ExpressionUUID->"e65d51d8-88ac-4e31-bd34-\
7e72d8039e90"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseCallIV", "[", 
   RowBox[{
   "CallPrice_", ",", "S_", ",", "K_", ",", "T_", ",", "r_", ",", "a_", ",", 
    "nOrder_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mu", ",", "std", ",", "IVSeries", ",", "inversedIVSeries", ",", 
      "impliedVol"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mu", " ", "=", " ", 
      RowBox[{"logForward", "[", 
       RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"IVSeries", "=", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"BSCall", "[", 
         RowBox[{"S", ",", "mu", ",", "Z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", "a", ",", "nOrder"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"inversedIVSeries", " ", "=", " ", 
      RowBox[{"InverseSeries", "[", "IVSeries", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"std", " ", "=", " ", 
      RowBox[{
       RowBox[{"Normal", "[", "inversedIVSeries", "]"}], "/.", 
       RowBox[{"Z", "\[Rule]", "CallPrice"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"impliedVol", " ", "=", " ", 
      FractionBox["std", 
       SqrtBox["T"]]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7184091105870247`*^9, 3.718409311343723*^9}, {
  3.718409510545992*^9, 3.7184095777784986`*^9}, {3.718409690872712*^9, 
  3.718409695266431*^9}, {3.7184099744590883`*^9, 3.7184099751357155`*^9}, {
  3.7184103612142906`*^9, 3.7184104326866245`*^9}, {3.718469885840727*^9, 
  3.718469890147352*^9}},ExpressionUUID->"48e259d8-26df-4348-a224-\
28cb02eebc7c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"InverseCallIV", "[", 
  RowBox[{
  "14.2281", ",", "100", ",", "100", ",", "1", ",", "0.05", ",", "1", ",", 
   "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.7184095904827757`*^9, 3.718409633858567*^9}, {
   3.7184097000809965`*^9, 3.7184097003946886`*^9}, {3.7184099786725273`*^9, 
   3.718409987392254*^9}, 
   3.7184104364099417`*^9},ExpressionUUID->"cc3485d8-faa4-42d0-a0c5-\
63dbc3b313ef"],

Cell[BoxData["0.2999935900284324`"], "Output",
 CellChangeTimes->{
  3.7184096344403324`*^9, 3.7184097007525973`*^9, {3.7184099798634553`*^9, 
   3.7184099881599116`*^9}, 3.718410436972763*^9, 3.718410923902484*^9, 
   3.718469629377613*^9, 
   3.718477332041772*^9},ExpressionUUID->"f46c55ae-3350-4afe-98cb-\
c52bbe534b58"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"targetCallPrice", "=", 
        RowBox[{"BSCallHandy", "[", 
         RowBox[{"S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]"}], 
         "]"}]}], ",", 
       RowBox[{"estimatedCallPrice", "=", 
        RowBox[{"BSCallTaylorExpansion", "[", 
         RowBox[{
         "S", ",", "K", ",", "T", ",", "r", ",", "\[Sigma]", ",", "a", ",", 
          "order"}], "]"}]}], ",", "estimatedIV"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"estimatedIV", "=", 
       RowBox[{"InverseCallIV", "[", 
        RowBox[{
        "targetCallPrice", ",", "S", ",", "K", ",", "T", ",", "r", ",", "a", 
         ",", "order"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"targetCallPrice", ",", "estimatedCallPrice"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Sigma]", ",", "estimatedIV"}], "}"}]}], "}"}]}]}], "]"}], 
   ",", "\[IndentingNewLine]", 
   "\"\<underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)\>\"", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "100.", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "150", ",", "1", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<strike, K\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"K", ",", "100", ",", "\"\<\>\""}], "}"}], ",", "0", ",", "150",
      ",", "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<volatility, \[Sigma]\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Sigma]", ",", "0.3", ",", "\"\<\>\""}], "}"}], ",", "0.01", 
     ",", "1", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<risk-free rate, r\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", ",", "0.05", ",", "\"\<\>\""}], "}"}], ",", "0.0", ",", 
     "0.25", ",", "0.01", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<years to maturity, T\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "0.1", ",", "3", 
     ",", "0.25", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<truncated order, order\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"order", ",", "10", ",", "\"\<\>\""}], "}"}], ",", "0", ",", 
     "64", ",", "8", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\"\<\>\"", ",", "\[IndentingNewLine]", 
   "\"\<fixed point, a\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "1", ",", "\"\<\>\""}], "}"}], ",", "0", ",", "5", 
     ",", "0.5", ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", " ", 
     RowBox[{"ImageSize", "\[Rule]", " ", "Tiny"}]}], "}"}], ",", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.7184085421068325`*^9, 3.718408542680831*^9}, 
   3.7184085728521786`*^9, {3.7184089996538534`*^9, 3.718409033145206*^9}, {
   3.718409730168476*^9, 3.7184099645308905`*^9}, {3.7184099964972754`*^9, 
   3.7184101705597315`*^9}, {3.7184102006259146`*^9, 
   3.7184102013979692`*^9}, {3.7184102451104774`*^9, 
   3.7184102623953953`*^9}, {3.718410298574753*^9, 3.718410329419793*^9}, 
   3.7184104694645886`*^9, {3.7184105544690866`*^9, 3.718410826199757*^9}, {
   3.7184111076266127`*^9, 3.7184111357230916`*^9}, {3.718477346162139*^9, 
   3.718477346432434*^9}},ExpressionUUID->"507775c4-ac39-4ab0-826a-\
48aa9eff166e"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`a$$ = 1, K$$ = 100, $CellContext`order$$ = 
    10, $CellContext`r$$ = 0.05, $CellContext`S$$ = 100., $CellContext`T$$ = 
    1, $CellContext`\[Sigma]$$ = 0.3, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold["underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)"], 
      Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`S$$], 100., ""}, 0, 150, 1}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["strike, K"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[K$$], 100, ""}, 0, 150, 0.5}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["volatility, \[Sigma]"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`\[Sigma]$$], 0.3, ""}, 0.01, 1, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["risk-free rate, r"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`r$$], 0.05, ""}, 0., 0.25, 0.01}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["years to maturity, T"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`T$$], 1, ""}, 0.1, 3, 0.25}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["truncated order, order"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`order$$], 10, ""}, 0, 64, 8}, {
      Hold[""], Manipulate`Dump`ThisIsNotAControl}, {
      Hold["fixed point, a"], Manipulate`Dump`ThisIsNotAControl}, {{
       Hold[$CellContext`a$$], 1, ""}, 0, 5, 0.5}}, Typeset`size$$ = {
    282., {3., 9.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`S$13935$$ = 0, K$13936$$ = 
    0, $CellContext`\[Sigma]$13937$$ = 0, $CellContext`r$13938$$ = 
    0, $CellContext`T$13939$$ = 0, $CellContext`order$13940$$ = 
    0, $CellContext`a$13941$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`a$$ = 1, K$$ = 100, $CellContext`order$$ = 
        10, $CellContext`r$$ = 0.05, $CellContext`S$$ = 
        100., $CellContext`T$$ = 1, $CellContext`\[Sigma]$$ = 0.3}, 
      "ControllerVariables" :> {
        Hold[$CellContext`S$$, $CellContext`S$13935$$, 0], 
        Hold[K$$, K$13936$$, 0], 
        Hold[$CellContext`\[Sigma]$$, $CellContext`\[Sigma]$13937$$, 0], 
        Hold[$CellContext`r$$, $CellContext`r$13938$$, 0], 
        Hold[$CellContext`T$$, $CellContext`T$13939$$, 0], 
        Hold[$CellContext`order$$, $CellContext`order$13940$$, 0], 
        Hold[$CellContext`a$$, $CellContext`a$13941$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`targetCallPrice$ = \
$CellContext`BSCallHandy[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$], \
$CellContext`estimatedCallPrice$ = \
$CellContext`BSCallTaylorExpansion[$CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`\[Sigma]$$, \
$CellContext`a$$, $CellContext`order$$], $CellContext`estimatedIV$}, \
$CellContext`estimatedIV$ = \
$CellContext`InverseCallIV[$CellContext`targetCallPrice$, $CellContext`S$$, 
           K$$, $CellContext`T$$, $CellContext`r$$, $CellContext`a$$, \
$CellContext`order$$]; {{$CellContext`targetCallPrice$, \
$CellContext`estimatedCallPrice$}, {$CellContext`\[Sigma]$$, \
$CellContext`estimatedIV$}}], 
      "Specifications" :> {
       "underlying, \!\(\*SubscriptBox[\(S\), \(0\)]\)", {{$CellContext`S$$, 
          100., ""}, 0, 150, 1, Appearance -> "Labeled", ImageSize -> Tiny}, 
        "", 
        "strike, K", {{K$$, 100, ""}, 0, 150, 0.5, Appearance -> "Labeled", 
         ImageSize -> Tiny}, "", 
        "volatility, \[Sigma]", {{$CellContext`\[Sigma]$$, 0.3, ""}, 0.01, 1, 
         0.01, Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "risk-free rate, r", {{$CellContext`r$$, 0.05, ""}, 0., 0.25, 0.01, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "years to maturity, T", {{$CellContext`T$$, 1, ""}, 0.1, 3, 0.25, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "truncated order, order", {{$CellContext`order$$, 10, ""}, 0, 64, 8, 
         Appearance -> "Labeled", ImageSize -> Tiny}, "", 
        "fixed point, a", {{$CellContext`a$$, 1, ""}, 0, 5, 0.5, Appearance -> 
         "Labeled", ImageSize -> Tiny}}, 
      "Options" :> {ControlPlacement -> Left}, "DefaultOptions" :> {}],
     ImageSizeCache->{454., {168., 173.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`BSCallHandy[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]]] := $CellContext`BSCall[$CellContext`S, 
         $CellContext`logForward[$CellContext`S, 
          K, $CellContext`T, $CellContext`r], 
         $CellContext`Z[$CellContext`\[Sigma], $CellContext`T]], \
$CellContext`BSCall[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`S ($CellContext`normalCDF[
           $CellContext`d1[$CellContext`lo, $CellContext`Z]] - 
         Exp[-$CellContext`lo] $CellContext`normalCDF[
           $CellContext`d2[$CellContext`lo, $CellContext`Z]]), $CellContext`Z[
        
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]]] := $CellContext`\[Sigma] 
        Sqrt[$CellContext`T], $CellContext`normalCDF[
         Pattern[$CellContext`d, 
          Blank[]]] := (1/2) (1 + 
         Erf[$CellContext`d/Sqrt[2]]), $CellContext`d1[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z + $CellContext`Z/
         2, $CellContext`d2[
         Pattern[$CellContext`lo, 
          Blank[]], 
         Pattern[$CellContext`Z, 
          Blank[]]] := $CellContext`lo/$CellContext`Z - $CellContext`Z/
        2, $CellContext`logForward[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]]] := 
       Log[$CellContext`S/
          K] + $CellContext`r $CellContext`T, \
$CellContext`BSCallTaylorExpansion[
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`\[Sigma], 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries}, \
$CellContext`std = $CellContext`Z[$CellContext`\[Sigma], $CellContext`T]; \
$CellContext`mu = $CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSCall[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`callPrice = ReplaceAll[
            
            Normal[$CellContext`IVSeries], $CellContext`Z -> \
$CellContext`std]], $CellContext`callPrice = 
       14.231170021098274`, $CellContext`InverseCallIV[
         Pattern[$CellContext`CallPrice, 
          Blank[]], 
         Pattern[$CellContext`S, 
          Blank[]], 
         Pattern[K, 
          Blank[]], 
         Pattern[$CellContext`T, 
          Blank[]], 
         Pattern[$CellContext`r, 
          Blank[]], 
         Pattern[$CellContext`a, 
          Blank[]], 
         Pattern[$CellContext`nOrder, 
          Blank[]]] := 
       Module[{$CellContext`mu, $CellContext`std, $CellContext`IVSeries, \
$CellContext`inversedIVSeries, $CellContext`impliedVol}, $CellContext`mu = \
$CellContext`logForward[$CellContext`S, 
            K, $CellContext`T, $CellContext`r]; $CellContext`IVSeries = Series[
            $CellContext`BSCall[$CellContext`S, $CellContext`mu, \
$CellContext`Z], {$CellContext`Z, $CellContext`a, $CellContext`nOrder}]; \
$CellContext`inversedIVSeries = 
          InverseSeries[$CellContext`IVSeries]; $CellContext`std = 
          ReplaceAll[
            
            Normal[$CellContext`inversedIVSeries], $CellContext`Z -> \
$CellContext`CallPrice]; $CellContext`impliedVol = $CellContext`std/
           Sqrt[$CellContext`T]]}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.7184106907040043`*^9, 3.7184107140424805`*^9}, {
   3.718410778269255*^9, 3.718410826749381*^9}, 3.718410923975453*^9, {
   3.7184111220196753`*^9, 3.7184111360916176`*^9}, 3.71846963011868*^9, {
   3.718477332133121*^9, 
   3.718477347111747*^9}},ExpressionUUID->"9a691535-c7e7-4c43-a343-\
fe044c3e26b1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"Erf", "[", "z", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"z", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7184699683336983`*^9, 
  3.7184699781342278`*^9}},ExpressionUUID->"1a595877-ae01-427d-80b3-\
5c4c7b9dc26c"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", "z"}], 
    SqrtBox["\[Pi]"]], "-", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox["z", "3"]}], 
    RowBox[{"3", " ", 
     SqrtBox["\[Pi]"]}]], "+", 
   FractionBox[
    SuperscriptBox["z", "5"], 
    RowBox[{"5", " ", 
     SqrtBox["\[Pi]"]}]], "-", 
   FractionBox[
    SuperscriptBox["z", "7"], 
    RowBox[{"21", " ", 
     SqrtBox["\[Pi]"]}]], "+", 
   FractionBox[
    SuperscriptBox["z", "9"], 
    RowBox[{"108", " ", 
     SqrtBox["\[Pi]"]}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "z", "]"}], "11"],
    SeriesData[$CellContext`z, 0, {}, 1, 11, 1],
    Editable->False]}],
  SeriesData[$CellContext`z, 0, {
   2 Pi^Rational[-1, 2], 0, Rational[-2, 3] Pi^Rational[-1, 2], 0, 
    Rational[1, 5] Pi^Rational[-1, 2], 0, Rational[-1, 21] Pi^Rational[-1, 2],
     0, Rational[1, 108] Pi^Rational[-1, 2]}, 1, 11, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.718469978484123*^9, 
  3.718477332345435*^9},ExpressionUUID->"bc24e933-bbf0-4bd5-91f7-\
9bee2325c57a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{"Erf", "[", 
     RowBox[{"z", "+", 
      RowBox[{"1", "/", "z"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", "a", ",", "10"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.718469988327826*^9, 3.718469998917041*^9}, {
  3.718470075796797*^9, 3.718470075955998*^9}, {3.718470377397778*^9, 
  3.718470383516446*^9}, {3.718470488005683*^9, 3.718470490977353*^9}, {
  3.7185614921996403`*^9, 
  3.718561494730797*^9}},ExpressionUUID->"a6640f88-09e4-4a12-a206-\
1dd6c6eb91b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"UpperBound", "[", 
    RowBox[{"k_", ",", "c_", ",", "norder_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "=", 
        FractionBox[
         RowBox[{"1", "-", "c"}], 
         RowBox[{"1", "+", 
          RowBox[{"Exp", "[", "k", "]"}]}]]}], ",", "\[Phi]", ",", 
       "\[Theta]"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]", "=", 
       RowBox[{"normalInverseCDF", "[", 
        RowBox[{"a", ",", "norder"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"\[Theta]", "=", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"normalInverseCDF", "[", 
              RowBox[{"x", ",", "norder"}], "]"}], ",", "x"}], "]"}], "/.", 
           RowBox[{"x", "\[Rule]", "\[Phi]"}]}], "\[Phi]"]}], " ", 
        FractionBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", "k", "]"}], "-", "1"}], ")"}], 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"2", " ", "k"}], "]"}], "+", "1"}]]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"normalInverseCDF", "[", 
         RowBox[{"a", "+", 
          RowBox[{"\[Theta]", " ", 
           RowBox[{"Exp", "[", "k", "]"}]}]}], "]"}]}], "-", 
       RowBox[{"normalInverseCDF", "[", 
        RowBox[{"a", "-", "\[Theta]"}], "]"}]}]}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{
  3.718561708878662*^9, {3.71856192540707*^9, 3.718562368617011*^9}, {
   3.7185624910640917`*^9, 3.7185625033075666`*^9}, {3.718562549618836*^9, 
   3.7185625567754927`*^9}},ExpressionUUID->"53a6ac9b-3075-441e-8544-\
7dad63e4ca4f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"UpperBound", "[", 
  RowBox[{"0", ",", "10", ",", "10"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"normalInverseCDF", "[", 
     RowBox[{"x", ",", "10"}], "]"}], ",", "x"}], "]"}], "/.", 
  RowBox[{"x", "\[Rule]", "1"}]}]}], "Input",
 CellChangeTimes->{{3.7185623016537657`*^9, 3.718562308548903*^9}, {
  3.7185623936487617`*^9, 3.718562401194129*^9}, {3.718562455415606*^9, 
  3.718562484620767*^9}},ExpressionUUID->"8aabf73d-58dc-4fbb-8b87-\
8e59e12cac80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  RowBox[{"normalInverseCDF", "[", 
   RowBox[{"-", 
    FractionBox["9", "2"]}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.718562308861628*^9, {3.718562381247631*^9, 3.7185624015766573`*^9}, {
   3.718562456349663*^9, 3.718562508073995*^9}, 
   3.718562563016548*^9},ExpressionUUID->"64c50fba-9e7c-47af-9b9e-\
4698372290fc"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["\[Pi]", 
    RowBox[{"3", "/", "2"}]], 
   RowBox[{"2", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"7", " ", 
    SuperscriptBox["\[Pi]", 
     RowBox[{"5", "/", "2"}]]}], 
   RowBox[{"48", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"127", " ", 
    SuperscriptBox["\[Pi]", 
     RowBox[{"7", "/", "2"}]]}], 
   RowBox[{"2880", " ", 
    SqrtBox["2"]}]], "+", 
  FractionBox[
   RowBox[{"4369", " ", 
    SuperscriptBox["\[Pi]", 
     RowBox[{"9", "/", "2"}]]}], 
   RowBox[{"322560", " ", 
    SqrtBox["2"]}]], "+", 
  SqrtBox[
   RowBox[{"2", " ", "\[Pi]"}]]}]], "Output",
 CellChangeTimes->{
  3.718562308861628*^9, {3.718562381247631*^9, 3.7185624015766573`*^9}, {
   3.718562456349663*^9, 3.718562508073995*^9}, 
   3.7185625630202312`*^9},ExpressionUUID->"13855d17-69b1-419a-b347-\
557fadd918ca"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 781},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 221, 3, 67, "Section",ExpressionUUID->"f998b030-d8df-4309-a3ec-71bd2a82d4a9"],
Cell[CellGroupData[{
Cell[826, 29, 354, 10, 30, "Input",ExpressionUUID->"193b2c5d-5d79-4577-8a0f-3573661fa44e"],
Cell[1183, 41, 2865, 90, 61, "Output",ExpressionUUID->"0977f424-7eca-4139-a4ac-62b5743d415a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4085, 136, 348, 9, 47, "Input",ExpressionUUID->"df61c590-1082-427b-9bb4-2f7e4861d0e4"],
Cell[4436, 147, 2109, 65, 58, "Output",ExpressionUUID->"658bce55-3ca4-47f2-a6c0-d240105520b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6582, 217, 283, 8, 30, "Input",ExpressionUUID->"48e612bd-86aa-492b-9a8f-d14f6b2ea5a9"],
Cell[6868, 227, 748, 22, 50, "Output",ExpressionUUID->"4f6ddcbb-ca9f-4222-833a-aa5b8fd2dbf7"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7665, 255, 178, 3, 67, "Section",ExpressionUUID->"52d481f1-3828-4966-a016-9e2f25ce6bfd"],
Cell[CellGroupData[{
Cell[7868, 262, 3784, 118, 302, "Input",ExpressionUUID->"faca4ef7-4317-463b-b2f5-ba79282d5454"],
Cell[11655, 382, 173, 3, 34, "Output",ExpressionUUID->"c5acc704-74ec-4447-acab-6c71a6481b99"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11877, 391, 181, 3, 67, "Section",ExpressionUUID->"8f6270c1-ce86-4c47-ad5d-fd9f34ca2a90"],
Cell[12061, 396, 1368, 35, 136, "Input",ExpressionUUID->"bca0fb50-219a-4f2c-a829-33f43b801621"],
Cell[CellGroupData[{
Cell[13454, 435, 597, 13, 52, "Input",ExpressionUUID->"42b4d5b0-8ef0-4aca-ba7d-b7f319b5cc25"],
Cell[14054, 450, 325, 6, 34, "Output",ExpressionUUID->"4ef39c47-8a52-4bfc-81b2-b8aef4084a9c"],
Cell[14382, 458, 327, 6, 34, "Output",ExpressionUUID->"e65d51d8-88ac-4e31-bd34-7e72d8039e90"]
}, Open  ]],
Cell[14724, 467, 1702, 41, 196, "Input",ExpressionUUID->"48e259d8-26df-4348-a224-28cb02eebc7c"],
Cell[CellGroupData[{
Cell[16451, 512, 419, 9, 30, "Input",ExpressionUUID->"cc3485d8-faa4-42d0-a0c5-63dbc3b313ef"],
Cell[16873, 523, 324, 6, 34, "Output",ExpressionUUID->"f46c55ae-3350-4afe-98cb-c52bbe534b58"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17234, 534, 4854, 106, 577, "Input",ExpressionUUID->"507775c4-ac39-4ab0-826a-48aa9eff166e"],
Cell[22091, 642, 9738, 205, 360, "Output",ExpressionUUID->"9a691535-c7e7-4c43-a343-fe044c3e26b1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31866, 852, 303, 8, 30, "Input",ExpressionUUID->"1a595877-ae01-427d-80b3-5c4c7b9dc26c"],
Cell[32172, 862, 1106, 35, 57, "Output",ExpressionUUID->"bc24e933-bbf0-4bd5-91f7-9bee2325c57a"]
}, Open  ]],
Cell[33293, 900, 569, 14, 30, "Input",ExpressionUUID->"a6640f88-09e4-4a12-a206-1dd6c6eb91b6"],
Cell[33865, 916, 1800, 50, 144, "Input",ExpressionUUID->"53a6ac9b-3075-441e-8544-7dad63e4ca4f"],
Cell[CellGroupData[{
Cell[35690, 970, 529, 12, 52, "Input",ExpressionUUID->"8aabf73d-58dc-4fbb-8b87-8e59e12cac80"],
Cell[36222, 984, 379, 10, 50, "Output",ExpressionUUID->"64c50fba-9e7c-47af-9b9e-4698372290fc"],
Cell[36604, 996, 892, 31, 91, "Output",ExpressionUUID->"13855d17-69b1-419a-b347-557fadd918ca"]
}, Open  ]]
}, Open  ]]
}
]
*)

