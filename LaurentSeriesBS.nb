(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     37116,        956]
NotebookOptionsPosition[     35129,        913]
NotebookOutlinePosition[     35489,        929]
CellTagsIndexPosition[     35446,        926]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"CoefficientList", "[", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"Erf", "[", 
      FractionBox["z", 
       SqrtBox["2"]], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", "10"}], "}"}]}], "]"}], ",", "z"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7179529238522863`*^9, 3.7179529345885153`*^9}, {
  3.717952967268588*^9, 3.717952968529275*^9}, {3.717953004087558*^9, 
  3.717953011620677*^9}, {3.717953057901239*^9, 3.717953113388537*^9}, {
  3.7179555387138643`*^9, 
  3.717955556733129*^9}},ExpressionUUID->"d032f1f2-44ac-4670-94df-\
98d91d1f2ae5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   SqrtBox[
    FractionBox["2", "\[Pi]"]], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"3", " ", 
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]]}]]}], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"20", " ", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]]}]], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"168", " ", 
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]"}]]}]]}], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"1728", " ", 
     SqrtBox[
      RowBox[{"2", " ", "\[Pi]"}]]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.717952934987547*^9, 3.717952969430917*^9, {3.71795300497511*^9, 
   3.717953012024378*^9}, {3.7179530648731327`*^9, 3.717953114006222*^9}, 
   3.7179555580239143`*^9},ExpressionUUID->"35e704a6-9d78-4e88-8bc8-\
51fd755ac6b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.717953219015567*^9, 3.7179532255688753`*^9}},
 NumberMarks->False,ExpressionUUID->"15f285c0-aa13-4e32-9abe-a43f8538510f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", 
   FractionBox["2", 
    SqrtBox["\[Pi]"]], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["2", 
     RowBox[{"3", " ", 
      SqrtBox["\[Pi]"]}]]}], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"5", " ", 
     SqrtBox["\[Pi]"]}]], ",", "0", ",", 
   RowBox[{"-", 
    FractionBox["1", 
     RowBox[{"21", " ", 
      SqrtBox["\[Pi]"]}]]}], ",", "0", ",", 
   FractionBox["1", 
    RowBox[{"108", " ", 
     SqrtBox["\[Pi]"]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7179530280727377`*^9},ExpressionUUID->"a4159203-6725-4b03-81b1-\
a033fb82f896"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"erf", "[", 
   RowBox[{"x_", ",", "N_"}], "]"}], ":=", 
  RowBox[{
   FractionBox["2", 
    SqrtBox["Pi"]], 
   RowBox[{
    UnderoverscriptBox["\[Sum]", 
     RowBox[{"n", "=", "0"}], "N"], 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"-", "1"}], ")"}], "n"], 
      SuperscriptBox["x", 
       RowBox[{
        RowBox[{"2", "*", "n"}], "+", "1"}]]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "*", "n"}], "+", "1"}], ")"}], "*", 
      RowBox[{"n", "!"}]}]]}]}]}]], "Input",
 CellChangeTimes->{{3.7179529498288794`*^9, 3.7179530002951117`*^9}, {
  3.717953725807423*^9, 
  3.717953903204022*^9}},ExpressionUUID->"c40c75d7-8fe5-4441-8a0e-\
f8267684a06c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"erf", "[", 
         RowBox[{
          RowBox[{"x", "/", 
           SqrtBox["2"]}], ",", "N"}], "]"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "10", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"N", ",", "10", ",", "40", ",", "2"}], "}"}]}], "]"}], "//", 
   "N"}], "//", "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"1", "/", "2"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Erf", "[", 
         RowBox[{"x", "/", 
          SqrtBox["2"]}], "]"}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "10", ",", "1"}], "}"}]}], "]"}], "//", 
   "N"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.717953906585721*^9, 3.717953998166233*^9}, {
  3.717957437715309*^9, 3.717957454358404*^9}, {3.7179574964776297`*^9, 
  3.717957542409273*^9}},ExpressionUUID->"2d50a6ee-59c6-4636-bd8a-\
ed5992d8611d"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.5`", "0.5`", "0.5`", "0.5`", "0.5`", "0.5`", "0.5`", "0.5`", "0.5`", 
      "0.5`", "0.5`", "0.5`", "0.5`", "0.5`", "0.5`", "0.5`"},
     {"0.8413447460687473`", "0.8413447460685433`", "0.841344746068543`", 
      "0.841344746068543`", "0.841344746068543`", "0.841344746068543`", 
      "0.841344746068543`", "0.8413447460685429`", "0.841344746068543`", 
      "0.841344746068543`", "0.841344746068543`", "0.841344746068543`", 
      "0.841344746068543`", "0.841344746068543`", "0.841344746068543`", 
      "0.841344746068543`"},
     {"0.9772514092845513`", "0.9772499023342779`", "0.9772498686286397`", 
      "0.977249868059419`", "0.9772498680519013`", "0.9772498680518216`", 
      "0.9772498680518208`", "0.9772498680518208`", "0.9772498680518208`", 
      "0.9772498680518208`", "0.9772498680518209`", "0.9772498680518208`", 
      "0.9772498680518208`", "0.9772498680518208`", "0.9772498680518208`", 
      "0.9772498680518209`"},
     {"1.0134278232789788`", "1.0003442395508264`", "0.9987964705072601`", 
      "0.9986599761107127`", "0.9986506365978771`", "0.9986501257178512`", 
      "0.998650102849633`", "0.9986501019960972`", "0.9986501019691192`", 
      "0.9986501019683875`", "0.9986501019683705`", "0.99865010196837`", 
      "0.99865010196837`", "0.9986501019683698`", "0.99865010196837`", 
      "0.9986501019683698`"},
     {"10.151762157323375`", "4.3786087957622115`", "1.9367340976832152`", 
      "1.2022495458054028`", "1.034957091741885`", "1.0049260469556853`", 
      "1.0005544034412748`", "1.0000270155711604`", "0.9999733709239285`", 
      "0.9999687045539158`", "0.9999683532867729`", "0.999968330171969`", 
      "0.9999683288306573`", "0.9999683287614949`", "0.9999683287583045`", 
      "0.999968328758172`"},
     {"1268.5339498439769`", "1163.1449173699634`", "799.0365187262042`", 
      "426.8922267977111`", "182.75966577771305`", "64.4585375913221`", 
      "19.46383711944145`", "5.546465354541129`", "1.959803898222461`", 
      "1.1756578005025289`", "1.028138117168143`", "1.0039782038376086`", 
      "1.00049990159718`", "1.0000559984796322`", "1.0000054155838392`", 
      "1.0000002361987903`"},
     {"68554.09576744454`", "132227.62393484337`", "190642.5397861496`", 
      "213277.24902391474`", "190558.4371644985`", "139136.57027049147`", 
      "84587.1533541426`", "43487.01675073475`", "19155.638907358618`", 
      "7311.234951148543`", "2441.7473690911456`", "719.9800602008563`", 
      "189.25409137136214`", "45.103507648550206`", "10.299619856753667`", 
      "2.774286972140707`"},
     {"1.9501652797705345`*^6", "7.050642880084468`*^6", 
      "1.9028744491293605`*^7", "3.980441931370635`*^7", 
      "6.6435545330502786`*^7", "9.054181015843594`*^7", 
      "1.0267072762964667`*^8", "9.83951526942005`*^7", 
      "8.075110308859766`*^7", "5.7392847336098894`*^7", 
      "3.5671889379854165`*^7", "1.9554273761787903`*^7", 
      "9.524725099247297`*^6", "4.1499272738753967`*^6", 
      "1.6269740287359615`*^6", "577015.1240146353`"},
     {"3.4834474089458875`*^7", "2.168596648366333`*^8", 
      "1.006892487514932`*^9", "3.620693252150366`*^9", 
      "1.0381441253351555`*^10", "2.4291223435342434`*^10", 
      "4.726801266583346`*^10", "7.769954279970412`*^10", 
      "1.0933092392041927`*^11", "1.3318238280663638`*^11", 
      "1.4183077738946875`*^11", "1.3317305409249371`*^11", 
      "1.1108221514910391`*^11", "8.286053054504758`*^10", 
      "5.560450444485652`*^10", "3.374843697867183`*^10"},
     {"4.3759924765355164`*^8", "4.396060304615028`*^9", 
      "3.2917435740810715`*^10", "1.9079328277643747`*^11", 
      "8.813608316702958`*^11", "3.321152331559171`*^12", 
      "1.0403699669282898`*^13", "2.7521639627037285`*^13", 
      "6.230213678813485`*^13", "1.2206524677693112`*^14", 
      "2.0902262110242912`*^14", "3.155139726111958`*^14", 
      "4.229963310314783`*^14", "5.0704623722849306`*^14", 
      "5.466914582356034`*^14", "5.330268770419511`*^14"},
     {"4.174263659033615`*^9", "6.4290838761849915`*^10", 
      "7.377666504265123`*^11", "6.550973802088168`*^12", 
      "4.634506886271184`*^13", "2.6737216149812575`*^14", 
      "1.2819621773968575`*^15", "5.189369214652814`*^15", 
      "1.7972072655752064`*^16", "5.3858285136226024`*^16", 
      "1.4103817030843941`*^17", "3.255135125579432`*^17", 
      "6.671509253264247`*^17", "1.2223832993687058`*^18", 
      "2.0142552860131878`*^18", "3.001083153697578`*^18"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.717953954199689*^9, 3.7179539986317263`*^9}, 
   3.717957457531658*^9, {3.717957521709651*^9, 
   3.717957543092284*^9}},ExpressionUUID->"b781f60e-a497-404e-9f6a-\
d9a796fe6790"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0.5`"},
      {"0.8413447460685429`"},
      {"0.9772498680518208`"},
      {"0.9986501019683699`"},
      {"0.9999683287581669`"},
      {"0.9999997133484282`"},
      {"0.9999999990134123`"},
      {"0.9999999999987201`"},
      {"0.9999999999999993`"},
      {"1.`"},
      {"1.`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.717953954199689*^9, 3.7179539986317263`*^9}, 
   3.717957457531658*^9, {3.717957521709651*^9, 
   3.7179575431033773`*^9}},ExpressionUUID->"f20c07f8-dc6d-4481-9100-\
f47e291ee995"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   SuperscriptBox["n", 
    FractionBox["1", "n"]], ",", 
   RowBox[{"n", "->", "\[Infinity]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7179543082015038`*^9, 
  3.717954341613593*^9}},ExpressionUUID->"82e0c0f5-b05c-410a-8a04-\
972426d15617"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.717954342135707*^9},ExpressionUUID->"c6ad02a5-6242-49f2-bda8-\
307d1a3801c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"d1", "[", 
    RowBox[{"lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["lo", "Z"], "+", 
    FractionBox["Z", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d2", "[", 
    RowBox[{"lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{
    FractionBox["lo", "Z"], "-", 
    FractionBox["Z", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cdf", "[", "d_", "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Erf", "[", 
       FractionBox["d", 
        SqrtBox["2"]], "]"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSFormula", "[", 
    RowBox[{"S_", ",", "lo_", ",", "Z_"}], "]"}], ":=", 
   RowBox[{"S", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"cdf", "[", 
       RowBox[{"d1", "[", 
        RowBox[{"lo", ",", "Z"}], "]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"-", "lo"}], "]"}], "*", 
       RowBox[{"cdf", "[", 
        RowBox[{"d2", "[", 
         RowBox[{"lo", ",", "Z"}], "]"}], "]"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"BSFormula", "[", 
       RowBox[{"S", ",", "lo", ",", "Z"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Z", ",", "0", ",", "3"}], "}"}]}], "]"}], ",", "Z"}], "]"}], "//",
   "TraditionalForm"}]}], "Input",
 CellChangeTimes->{{3.717954561686763*^9, 3.717954760052113*^9}, {
  3.717954798465993*^9, 3.717954899881863*^9}, {3.717954992608253*^9, 
  3.7179551199558477`*^9}, {3.717955174494027*^9, 3.717955320355873*^9}, {
  3.71795640619246*^9, 
  3.717956407708955*^9}},ExpressionUUID->"87f2eed3-24e0-44d6-8a38-\
d9db72e95ecb"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"16", " ", 
      SuperscriptBox["lo", "3"]}]], 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", "lo"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "8"}], " ", "S", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        TemplateBox[{FractionBox[
           RowBox[{
             RowBox[{"2", " ", 
               RowBox[{"arg", "(", "Z", ")"}]}], "-", 
             RowBox[{"arg", "(", 
               SuperscriptBox[
                RowBox[{"(", 
                  RowBox[{
                    RowBox[{"2", " ", "lo"}], "-", 
                    SuperscriptBox["Z", "2"]}], ")"}], "2"], ")"}], "+", 
             "\[Pi]"}], 
           RowBox[{"2", " ", "\[Pi]"}]]},
         "Floor"]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["1", 
          SuperscriptBox["lo", "2"]], ")"}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         TemplateBox[{FractionBox[
            RowBox[{"arg", "(", 
              RowBox[{
                SuperscriptBox["Z", "4"], "-", 
                RowBox[{"4", " ", "lo", " ", 
                  SuperscriptBox["Z", "2"]}]}], ")"}], 
            RowBox[{"2", " ", "\[Pi]"}]]},
          "Floor"]}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         SuperscriptBox["lo", "2"], ")"}], 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", 
          TemplateBox[{FractionBox[
             RowBox[{"arg", "(", 
               RowBox[{
                 SuperscriptBox["Z", "4"], "-", 
                 RowBox[{"4", " ", "lo", " ", 
                   SuperscriptBox["Z", "2"]}]}], ")"}], 
             RowBox[{"2", " ", "\[Pi]"}]]},
           "Floor"]}], "+", 
         FractionBox["3", "2"]}]]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["\[ExponentialE]", "lo"], " ", "S", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"-", "1"}], ")"}], 
        TemplateBox[{FractionBox[
           RowBox[{
             RowBox[{"2", " ", 
               RowBox[{"arg", "(", "Z", ")"}]}], "-", 
             RowBox[{"arg", "(", 
               SuperscriptBox[
                RowBox[{"(", 
                  RowBox[{
                    SuperscriptBox["Z", "2"], "+", 
                    RowBox[{"2", " ", "lo"}]}], ")"}], "2"], ")"}], "+", 
             "\[Pi]"}], 
           RowBox[{"2", " ", "\[Pi]"}]]},
         "Floor"]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["1", 
          SuperscriptBox["lo", "2"]], ")"}], 
        RowBox[{
         FractionBox["1", "2"], " ", 
         TemplateBox[{FractionBox[
            RowBox[{"arg", "(", 
              RowBox[{
                SuperscriptBox["Z", "4"], "+", 
                RowBox[{"4", " ", "lo", " ", 
                  SuperscriptBox["Z", "2"]}]}], ")"}], 
            RowBox[{"2", " ", "\[Pi]"}]]},
          "Floor"]}]], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         SuperscriptBox["lo", "2"], ")"}], 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", 
          TemplateBox[{FractionBox[
             RowBox[{"arg", "(", 
               RowBox[{
                 SuperscriptBox["Z", "4"], "+", 
                 RowBox[{"4", " ", "lo", " ", 
                   SuperscriptBox["Z", "2"]}]}], ")"}], 
             RowBox[{"2", " ", "\[Pi]"}]]},
           "Floor"]}], "+", 
         FractionBox["3", "2"]}]]}], "+", 
      RowBox[{
       RowBox[{"exp", "(", 
        InterpretationBox[
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox["lo", "2"], 
            RowBox[{"2", " ", 
             SuperscriptBox["Z", "2"]}]]}], "-", 
          FractionBox[
           RowBox[{"3", " ", "lo"}], "2"], "-", 
          FractionBox[
           SuperscriptBox["Z", "2"], "8"], "+", 
          InterpretationBox[
           RowBox[{"O", "(", 
            SuperscriptBox["Z", "4"], ")"}],
           SeriesData[$CellContext`Z, 0, {}, -2, 4, 1],
           Editable->False]}],
         SeriesData[$CellContext`Z, 0, {
          Rational[-1, 2] $CellContext`lo^2, 0, 
           Rational[-3, 2] $CellContext`lo, 0, 
           Rational[-1, 8]}, -2, 4, 1],
         Editable->False], ")"}], " ", 
       RowBox[{"(", 
        InterpretationBox[
         RowBox[{
          RowBox[{"-", 
           RowBox[{"8", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"2", " ", "lo"}]], " ", 
              SuperscriptBox["lo", "2"], " ", 
              SqrtBox[
               FractionBox["2", "\[Pi]"]], " ", "S"}], ")"}], " ", "Z"}]}], 
          "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"2", " ", "lo"}]], " ", 
           RowBox[{"(", 
            RowBox[{"lo", "+", "2"}], ")"}], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]], " ", "S", " ", 
           SuperscriptBox["Z", "3"]}], "+", 
          InterpretationBox[
           RowBox[{"O", "(", 
            SuperscriptBox["Z", "4"], ")"}],
           SeriesData[$CellContext`Z, 0, {}, 1, 4, 1],
           Editable->False]}],
         SeriesData[$CellContext`Z, 
          0, {(-8) 
           E^(2 $CellContext`lo) $CellContext`lo^2 (2/Pi)^
            Rational[1, 2] $CellContext`S, 0, 4 
           E^(2 $CellContext`lo) (2 + $CellContext`lo) (2/Pi)^
            Rational[1, 2] $CellContext`S}, 1, 4, 1],
         Editable->False], ")"}]}], "+", 
      RowBox[{
       RowBox[{"exp", "(", 
        InterpretationBox[
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox["lo", "2"], 
            RowBox[{"2", " ", 
             SuperscriptBox["Z", "2"]}]]}], "-", 
          FractionBox[
           RowBox[{"5", " ", "lo"}], "2"], "-", 
          FractionBox[
           SuperscriptBox["Z", "2"], "8"], "+", 
          InterpretationBox[
           RowBox[{"O", "(", 
            SuperscriptBox["Z", "4"], ")"}],
           SeriesData[$CellContext`Z, 0, {}, -2, 4, 1],
           Editable->False]}],
         SeriesData[$CellContext`Z, 0, {
          Rational[-1, 2] $CellContext`lo^2, 0, 
           Rational[-5, 2] $CellContext`lo, 0, 
           Rational[-1, 8]}, -2, 4, 1],
         Editable->False], ")"}], " ", 
       RowBox[{"(", 
        InterpretationBox[
         RowBox[{
          RowBox[{"8", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"3", " ", "lo"}]], " ", 
           SuperscriptBox["lo", "2"], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]], " ", "S", " ", "Z"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"3", " ", "lo"}]], " ", 
           RowBox[{"(", 
            RowBox[{"lo", "-", "2"}], ")"}], " ", 
           SqrtBox[
            FractionBox["2", "\[Pi]"]], " ", "S", " ", 
           SuperscriptBox["Z", "3"]}], "+", 
          InterpretationBox[
           RowBox[{"O", "(", 
            SuperscriptBox["Z", "4"], ")"}],
           SeriesData[$CellContext`Z, 0, {}, 1, 4, 1],
           Editable->False]}],
         SeriesData[$CellContext`Z, 0, {
          8 E^(3 $CellContext`lo) $CellContext`lo^2 (2/Pi)^
            Rational[1, 2] $CellContext`S, 0, 4 
           E^(3 $CellContext`lo) (-2 + $CellContext`lo) (2/Pi)^
            Rational[1, 2] $CellContext`S}, 1, 4, 1],
         Editable->False], ")"}]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["\[ExponentialE]", "lo"], " ", 
       SuperscriptBox["lo", "3"], " ", "S"}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["lo", "3"], " ", "S"}]}], ")"}]}], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", "lo"}]], " ", 
     SuperscriptBox["Z", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"S", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{
          TemplateBox[{FractionBox[
             RowBox[{
               RowBox[{"2", " ", 
                 RowBox[{"arg", "(", "Z", ")"}]}], "-", 
               RowBox[{"arg", "(", 
                 SuperscriptBox[
                  RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "lo"}], "-", 
                    SuperscriptBox["Z", "2"]}], ")"}], "2"], ")"}], "+", 
               "\[Pi]"}], 
             RowBox[{"2", " ", "\[Pi]"}]]},
           "Floor"], "+", "1"}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["1", 
           SuperscriptBox["lo", "2"]], ")"}], 
         RowBox[{
          FractionBox["1", "2"], " ", 
          TemplateBox[{FractionBox[
             RowBox[{"arg", "(", 
               RowBox[{
                 SuperscriptBox["Z", "4"], "-", 
                 RowBox[{"4", " ", "lo", " ", 
                   SuperscriptBox["Z", "2"]}]}], ")"}], 
             RowBox[{"2", " ", "\[Pi]"}]]},
           "Floor"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          SuperscriptBox["lo", "2"], ")"}], 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           TemplateBox[{FractionBox[
              RowBox[{"arg", "(", 
                RowBox[{
                  SuperscriptBox["Z", "4"], "-", 
                  RowBox[{"4", " ", "lo", " ", 
                    SuperscriptBox["Z", "2"]}]}], ")"}], 
              RowBox[{"2", " ", "\[Pi]"}]]},
            "Floor"]}], "+", 
          FractionBox["1", "2"]}]]}], "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", "lo"], " ", "S", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         TemplateBox[{FractionBox[
            RowBox[{
              RowBox[{"2", " ", 
                RowBox[{"arg", "(", "Z", ")"}]}], "-", 
              RowBox[{"arg", "(", 
                SuperscriptBox[
                 RowBox[{"(", 
                   RowBox[{
                    SuperscriptBox["Z", "2"], "+", 
                    RowBox[{"2", " ", "lo"}]}], ")"}], "2"], ")"}], "+", 
              "\[Pi]"}], 
            RowBox[{"2", " ", "\[Pi]"}]]},
          "Floor"]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["1", 
           SuperscriptBox["lo", "2"]], ")"}], 
         RowBox[{
          FractionBox["1", "2"], " ", 
          TemplateBox[{FractionBox[
             RowBox[{"arg", "(", 
               RowBox[{
                 SuperscriptBox["Z", "4"], "+", 
                 RowBox[{"4", " ", "lo", " ", 
                   SuperscriptBox["Z", "2"]}]}], ")"}], 
             RowBox[{"2", " ", "\[Pi]"}]]},
           "Floor"]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          SuperscriptBox["lo", "2"], ")"}], 
         RowBox[{
          RowBox[{
           FractionBox["1", "2"], " ", 
           TemplateBox[{FractionBox[
              RowBox[{"arg", "(", 
                RowBox[{
                  SuperscriptBox["Z", "4"], "+", 
                  RowBox[{"4", " ", "lo", " ", 
                    SuperscriptBox["Z", "2"]}]}], ")"}], 
              RowBox[{"2", " ", "\[Pi]"}]]},
            "Floor"]}], "+", 
          FractionBox["1", "2"]}]]}]}], ")"}]}], 
    RowBox[{"16", " ", 
     SuperscriptBox["lo", "3"]}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.717955212011985*^9, 3.7179552259763737`*^9}, 
   3.717955259684965*^9, {3.717955296788056*^9, 3.717955320958212*^9}, 
   3.717956408621297*^9},ExpressionUUID->"2dd8b3ec-a3be-4961-b371-\
0886fc3ac993"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"logATM", "[", 
    RowBox[{"S_", ",", "K_", ",", "T_", ",", "r_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Log", "[", 
     RowBox[{"S", "/", "K"}], "]"}], "+", 
    RowBox[{"r", "*", "T"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"stdBS", "[", 
    RowBox[{"\[Sigma]_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"\[Sigma]", "*", 
    SqrtBox["T"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BSSeries", "[", 
    RowBox[{
    "S_", ",", "K_", ",", "T_", ",", "r_", ",", "\[Sigma]_", ",", "N_"}], 
    "]"}], ":=", " ", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Lo", "=", 
        RowBox[{"logATM", "[", 
         RowBox[{"S", ",", "K", ",", "T", ",", "r"}], "]"}]}], ",", 
       RowBox[{"Z", "=", 
        RowBox[{"stdBS", "[", 
         RowBox[{"\[Sigma]", ",", "T"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox["S", "2"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Exp", "[", 
          RowBox[{"-", "Lo"}], "]"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["S", "2"], 
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", 
          SqrtBox[
           RowBox[{"2", "\[Pi]"}]]], 
         RowBox[{
          UnderoverscriptBox["\[Sum]", 
           RowBox[{"n", "=", "0"}], "N"], 
          RowBox[{
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"-", "1"}], ")"}], "n"], 
            RowBox[{
             SuperscriptBox["2", 
              RowBox[{"n", "-", "1"}]], "*", 
             RowBox[{"n", "!"}], "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", "*", "n"}], "+", "1"}], ")"}]}]], 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"d1", "[", 
               RowBox[{"Lo", ",", "Z"}], "]"}], 
              RowBox[{
               RowBox[{"2", "*", "n"}], "+", "1"}]], "-", 
             RowBox[{
              RowBox[{"Exp", "[", 
               RowBox[{"-", "Lo"}], "]"}], "*", 
              SuperscriptBox[
               RowBox[{"d2", "[", 
                RowBox[{"Lo", ",", "Z"}], "]"}], 
               RowBox[{
                RowBox[{"2", "*", "n"}], "+", "1"}]]}]}], ")"}]}]}]}], 
        ")"}]}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BSSeries", "[", 
  RowBox[{"4000", ",", "4000", ",", "1", ",", "0.01", ",", "0.2", ",", "2"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.717956435021562*^9, 3.717957069457859*^9}, {
  3.717957565474449*^9, 3.717957570081251*^9}, {3.717957710417207*^9, 
  3.717957739943177*^9}},ExpressionUUID->"e50ecb12-a5aa-4220-b153-\
2bb2be2932c1"],

Cell[BoxData["337.33275570498506`"], "Output",
 CellChangeTimes->{{3.717957027697405*^9, 3.717957069872241*^9}, {
  3.7179575671363773`*^9, 3.717957570408992*^9}, {3.717957711250276*^9, 
  3.717957740439026*^9}},ExpressionUUID->"762f730e-e500-42df-8d9f-\
8a00dbf89017"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"BSSeries", "[", 
     RowBox[{
     "4000", ",", "3800", ",", "1", ",", "0.01", ",", "\[Sigma]", ",", "N"}], 
     "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Sigma]", ",", "0.01", ",", "1", ",", "0.05"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"N", ",", "0", ",", "100", ",", "10"}], "}"}]}], "]"}], "//", 
  "MatrixFormc"}]], "Input",
 CellChangeTimes->{{3.717957746653473*^9, 3.7179578861872377`*^9}, {
   3.717958600669292*^9, 3.717958601410048*^9}, 
   3.718043592106735*^9},ExpressionUUID->"016dceba-3091-4e03-9647-\
51fa91713943"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"715.8947730050462`", "4.098728400306395`*^7", "1.7223025279300764`*^8",
       "5.826282920294977`*^6", "8057.3227744592705`", "238.73249181896398`", 
      "237.81064791154733`", "237.81063250348143`", "237.8106325034311`", 
      "237.8106325034311`", "237.8106325034311`"},
     {"308.72296994937943`", "256.41449556222403`", "256.4144955602698`", 
      "256.4144955602698`", "256.4144955602698`", "256.4144955602698`", 
      "256.4144955602698`", "256.4144955602698`", "256.4144955602698`", 
      "256.4144955602698`", "256.4144955602698`"},
     {"342.0861134778677`", "314.86402079201514`", "314.86402079201514`", 
      "314.86402079201514`", "314.86402079201514`", "314.86402079201514`", 
      "314.86402079201514`", "314.86402079201514`", "314.86402079201514`", 
      "314.86402079201514`", "314.86402079201514`"},
     {"402.9826911678656`", "384.26886687652234`", "384.26886687652234`", 
      "384.26886687652234`", "384.26886687652234`", "384.26886687652234`", 
      "384.26886687652234`", "384.26886687652234`", "384.26886687652234`", 
      "384.26886687652234`", "384.26886687652234`"},
     {"471.74596433258046`", "457.13000235468303`", "457.13000235468303`", 
      "457.13000235468303`", "457.13000235468303`", "457.13000235468303`", 
      "457.13000235468303`", "457.13000235468303`", "457.13000235468303`", 
      "457.13000235468303`", "457.13000235468303`"},
     {"543.837454813522`", "531.3775889574068`", "531.3775889574068`", 
      "531.3775889574068`", "531.3775889574068`", "531.3775889574068`", 
      "531.3775889574068`", "531.3775889574068`", "531.3775889574068`", 
      "531.3775889574068`", "531.3775889574068`"},
     {"617.6467348770319`", "606.2097906491387`", "606.2097906491387`", 
      "606.2097906491387`", "606.2097906491387`", "606.2097906491387`", 
      "606.2097906491387`", "606.2097906491387`", "606.2097906491387`", 
      "606.2097906491387`", "606.2097906491387`"},
     {"692.4580588637068`", "681.2366526356273`", "681.2366526356273`", 
      "681.2366526356273`", "681.2366526356273`", "681.2366526356273`", 
      "681.2366526356273`", "681.2366526356273`", "681.2366526356273`", 
      "681.2366526356273`", "681.2366526356273`"},
     {"767.9048253382424`", "756.233914087197`", "756.233914087197`", 
      "756.233914087197`", "756.233914087197`", "756.233914087197`", 
      "756.233914087197`", "756.233914087197`", "756.233914087197`", 
      "756.233914087197`", "756.233914087197`"},
     {"843.7798247937275`", "831.0545366845097`", "831.0545366845097`", 
      "831.0545366845097`", "831.0545366845097`", "831.0545366845097`", 
      "831.0545366845097`", "831.0545366845097`", "831.0545366845097`", 
      "831.0545366845097`", "831.0545366845097`"},
     {"919.9571063534124`", "905.5916275927041`", "905.5916275927041`", 
      "905.5916275927041`", "905.5916275927041`", "905.5916275927041`", 
      "905.5916275927041`", "905.5916275927041`", "905.5916275927041`", 
      "905.5916275927041`", "905.5916275927041`"},
     {"996.3557015965293`", "979.7610606135244`", "979.7610606135244`", 
      "979.7610606135244`", "979.7610606135244`", "979.7610606135244`", 
      "979.7610606135244`", "979.7610606135244`", "979.7610606135244`", 
      "979.7610606135244`", "979.7610606135244`"},
     {"1072.921189125513`", "1053.4926097951266`", "1053.4926097951266`", 
      "1053.4926097951266`", "1053.4926097951266`", "1053.4926097951266`", 
      "1053.4926097951266`", "1053.4926097951266`", "1053.4926097951266`", 
      "1053.4926097951266`", "1053.4926097951266`"},
     {"1149.6156388753934`", "1126.7251180242843`", "1126.7251180242843`", 
      "1126.7251180242843`", "1126.7251180242843`", "1126.7251180242843`", 
      "1126.7251180242843`", "1126.7251180242843`", "1126.7251180242843`", 
      "1126.7251180242843`", "1126.7251180242843`"},
     {"1226.411805306545`", "1199.4037239755921`", "1199.4037239755921`", 
      "1199.4037239755921`", "1199.4037239755921`", "1199.4037239755921`", 
      "1199.4037239755921`", "1199.4037239755921`", "1199.4037239755921`", 
      "1199.4037239755921`", "1199.4037239755921`"},
     {"1303.2896127581898`", "1271.478203590068`", "1271.478203590068`", 
      "1271.478203590068`", "1271.478203590068`", "1271.478203590068`", 
      "1271.478203590068`", "1271.478203590068`", "1271.478203590068`", 
      "1271.478203590068`", "1271.478203590068`"},
     {"1380.2339425228301`", "1342.9019454259148`", "1342.9019454259148`", 
      "1342.9019454259148`", "1342.9019454259148`", "1342.9019454259148`", 
      "1342.9019454259148`", "1342.9019454259148`", "1342.9019454259148`", 
      "1342.9019454259148`", "1342.9019454259148`"},
     {"1457.2331918714542`", "1413.6313015411572`", "1413.6313015411572`", 
      "1413.6313015411572`", "1413.6313015411572`", "1413.6313015411572`", 
      "1413.6313015411572`", "1413.6313015411572`", "1413.6313015411572`", 
      "1413.6313015411572`", "1413.6313015411572`"},
     {"1534.278308125384`", "1483.6251685430448`", "1483.6251685430448`", 
      "1483.6251685430448`", "1483.6251685430448`", "1483.6251685430448`", 
      "1483.6251685430448`", "1483.6251685430448`", "1483.6251685430448`", 
      "1483.6251685430448`", "1483.6251685430448`"},
     {"1611.362124580665`", "1552.8447137123496`", "1552.8447137123496`", 
      "1552.8447137123496`", "1552.8447137123496`", "1552.8447137123496`", 
      "1552.8447137123496`", "1552.8447137123496`", "1552.8447137123496`", 
      "1552.8447137123496`", "1552.8447137123496`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.71795785313739*^9, 3.717957888912138*^9}, 
   3.717958602000867*^9},ExpressionUUID->"851e118a-b0ba-4760-abd1-\
7492a1c78831"]
}, Open  ]]
},
WindowSize->{1321, 755},
WindowMargins->{{20, Automatic}, {Automatic, 44}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 617, 16, 50, "Input",ExpressionUUID->"d032f1f2-44ac-4670-94df-98d91d1f2ae5"],
Cell[1200, 40, 866, 27, 60, "Output",ExpressionUUID->"35e704a6-9d78-4e88-8bc8-51fd755ac6b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2103, 72, 170, 2, 30, "Input",ExpressionUUID->"15f285c0-aa13-4e32-9abe-a43f8538510f"],
Cell[2276, 76, 608, 21, 54, "Output",ExpressionUUID->"a4159203-6725-4b03-81b1-a033fb82f896"]
}, Open  ]],
Cell[2899, 100, 766, 26, 56, "Input",ExpressionUUID->"c40c75d7-8fe5-4441-8a0e-f8267684a06c"],
Cell[CellGroupData[{
Cell[3690, 130, 1169, 35, 67, "Input",ExpressionUUID->"2d50a6ee-59c6-4636-bd8a-ed5992d8611d"],
Cell[4862, 167, 5205, 89, 224, "Output",ExpressionUUID->"b781f60e-a497-404e-9f6a-d9a796fe6790"],
Cell[10070, 258, 1098, 32, 212, "Output",ExpressionUUID->"f20c07f8-dc6d-4481-9100-f47e291ee995"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11205, 295, 292, 8, 43, InheritFromParent,ExpressionUUID->"82e0c0f5-b05c-410a-8a04-972426d15617"],
Cell[11500, 305, 130, 3, 34, "Output",ExpressionUUID->"c6ad02a5-6242-49f2-bda8-307d1a3801c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11667, 313, 1829, 57, 180, "Input",ExpressionUUID->"87f2eed3-24e0-44d6-8a38-d9db72e95ecb"],
Cell[13499, 372, 11645, 323, 261, "Output",ExpressionUUID->"2dd8b3ec-a3be-4961-b371-0886fc3ac993"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25181, 700, 2792, 83, 154, "Input",ExpressionUUID->"e50ecb12-a5aa-4220-b153-2bb2be2932c1"],
Cell[27976, 785, 269, 4, 34, "Output",ExpressionUUID->"762f730e-e500-42df-8d9f-8a00dbf89017"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28282, 794, 619, 16, 30, "Input",ExpressionUUID->"016dceba-3091-4e03-9647-51fa91713943"],
Cell[28904, 812, 6209, 98, 426, "Output",ExpressionUUID->"851e118a-b0ba-4760-abd1-7492a1c78831"]
}, Open  ]]
}
]
*)

